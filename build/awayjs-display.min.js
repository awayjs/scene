require=function t(e,i,r){function s(a,o){if(!i[a]){if(!e[a]){var l=typeof require=="function"&&require;if(!o&&l)return l(a,!0);if(n)return n(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var p=i[a]={exports:{}};e[a][0].call(p.exports,function(t){var i=e[a][1][t];return s(i?i:t)},p,p.exports,t,e,i,r)}return i[a].exports}var n=typeof require=="function"&&require;for(var a=0;a<r.length;a++)s(r[a]);return s}({1:[function(t,e,i){"use strict";var r=t("./lib/adapters");i.adapters=r;var s=t("./lib/animators");i.animators=s;var n=t("./lib/base");i.base=n;var a=t("./lib/bounds");i.bounds=a;var o=t("./lib/controllers");i.controllers=o;var l=t("./lib/display");i.display=l;var h=t("./lib/draw");i.draw=h;var p=t("./lib/errors");i.errors=p;var u=t("./lib/events");i.events=u;var c=t("./lib/factories");i.factories=c;var f=t("./lib/graphics");i.graphics=f;var d=t("./lib/managers");i.managers=d;var _=t("./lib/materials");i.materials=_;var y=t("./lib/partition");i.partition=y;var v=t("./lib/pick");i.pick=v;var m=t("./lib/prefabs");i.prefabs=m;var b=t("./lib/text");i.text=b;var g=t("./lib/textures");i.textures=g;var w=t("./lib/utils");i.utils=w;var P=t("./lib/View");i.View=P.View;y.PartitionBase.registerAbstraction(y.CameraNode,l.Camera);y.PartitionBase.registerAbstraction(y.DirectionalLightNode,l.DirectionalLight);y.PartitionBase.registerAbstraction(y.EntityNode,l.Sprite);y.PartitionBase.registerAbstraction(y.EntityNode,l.Shape);y.PartitionBase.registerAbstraction(y.EntityNode,l.MovieClip);y.PartitionBase.registerAbstraction(y.EntityNode,l.Billboard);y.PartitionBase.registerAbstraction(y.EntityNode,l.LineSegment);y.PartitionBase.registerAbstraction(y.EntityNode,l.TextField);y.PartitionBase.registerAbstraction(y.EntityNode,l.TextFieldMultiRender);y.PartitionBase.registerAbstraction(y.LightProbeNode,l.LightProbe);y.PartitionBase.registerAbstraction(y.PointLightNode,l.PointLight);y.PartitionBase.registerAbstraction(y.SkyboxNode,l.Skybox)},{"./lib/View":"awayjs-display/lib/View","./lib/adapters":"awayjs-display/lib/adapters","./lib/animators":"awayjs-display/lib/animators","./lib/base":"awayjs-display/lib/base","./lib/bounds":"awayjs-display/lib/bounds","./lib/controllers":"awayjs-display/lib/controllers","./lib/display":"awayjs-display/lib/display","./lib/draw":"awayjs-display/lib/draw","./lib/errors":"awayjs-display/lib/errors","./lib/events":"awayjs-display/lib/events","./lib/factories":"awayjs-display/lib/factories","./lib/graphics":"awayjs-display/lib/graphics","./lib/managers":"awayjs-display/lib/managers","./lib/materials":"awayjs-display/lib/materials","./lib/partition":"awayjs-display/lib/partition","./lib/pick":"awayjs-display/lib/pick","./lib/prefabs":"awayjs-display/lib/prefabs","./lib/text":"awayjs-display/lib/text","./lib/textures":"awayjs-display/lib/textures","./lib/utils":"awayjs-display/lib/utils"}],"awayjs-display/lib/IRenderer":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/ITraverser":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/View":[function(t,e,i){"use strict";var r=t("awayjs-core/lib/utils/getTimer");var s=t("./base/TouchPoint");var n=t("./display/Scene");var a=t("./pick/RaycastPicker");var o=t("./display/Camera");var l=t("./events/CameraEvent");var h=t("./events/DisplayObjectEvent");var p=t("./events/RendererEvent");var u=t("./managers/MouseManager");var c=function(){function t(t,e,i){var r=this;if(e===void 0){e=null}if(i===void 0){i=null}this._width=0;this._height=0;this._time=0;this._deltaTime=0;this._backgroundColor=0;this._backgroundAlpha=1;this._viewportDirty=true;this._scissorDirty=true;this._mousePicker=new a.RaycastPicker;this._pTouchPoints=new Array;this._onPartitionChangedDelegate=function(t){return r._onPartitionChanged(t)};this._onProjectionChangedDelegate=function(t){return r._onProjectionChanged(t)};this._onViewportUpdatedDelegate=function(t){return r._onViewportUpdated(t)};this._onScissorUpdatedDelegate=function(t){return r._onScissorUpdated(t)};this.scene=e||new n.Scene;this.camera=i||new o.Camera;this.renderer=t;if(document){document.body.style.margin="0px";this._htmlElement=document.createElement("div");this._htmlElement.style.position="absolute";document.body.appendChild(this._htmlElement)}this._mouseManager=u.MouseManager.getInstance();this._mouseManager.registerView(this)}Object.defineProperty(t.prototype,"mouseX",{get:function(){return this._pMouseX},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"mouseY",{get:function(){return this._pMouseY},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"touchPoints",{get:function(){return this._pTouchPoints},enumerable:true,configurable:true});t.prototype.getLocalMouseX=function(t){return t.inverseSceneTransform.transformVector(this.unproject(this._pMouseX,this._pMouseY,1e3)).x};t.prototype.getLocalMouseY=function(t){return t.inverseSceneTransform.transformVector(this.unproject(this._pMouseX,this._pMouseY,1e3)).y};t.prototype.getLocalTouchPoints=function(t){var e;var i=new Array;var r=this._pTouchPoints.length;for(var n=0;n<r;n++){e=t.inverseSceneTransform.transformVector(this.unproject(this._pTouchPoints[n].x,this._pTouchPoints[n].y,1e3));i.push(new s.TouchPoint(e.x,e.y,this._pTouchPoints[n].id))}return i};Object.defineProperty(t.prototype,"htmlElement",{get:function(){return this._htmlElement},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"renderer",{get:function(){return this._pRenderer},set:function(t){if(this._pRenderer==t)return;if(this._pRenderer){this._pRenderer.dispose();this._pRenderer.removeEventListener(p.RendererEvent.VIEWPORT_UPDATED,this._onViewportUpdatedDelegate);this._pRenderer.removeEventListener(p.RendererEvent.SCISSOR_UPDATED,this._onScissorUpdatedDelegate)}this._pRenderer=t;this._pRenderer.addEventListener(p.RendererEvent.VIEWPORT_UPDATED,this._onViewportUpdatedDelegate);this._pRenderer.addEventListener(p.RendererEvent.SCISSOR_UPDATED,this._onScissorUpdatedDelegate);this._pRenderer._iBackgroundR=(this._backgroundColor>>16&255)/255;this._pRenderer._iBackgroundG=(this._backgroundColor>>8&255)/255;this._pRenderer._iBackgroundB=(this._backgroundColor&255)/255;this._pRenderer._iBackgroundAlpha=this._backgroundAlpha;this._pRenderer.width=this._width;this._pRenderer.height=this._height;this._pRenderer.shareContext=this._shareContext},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"shareContext",{get:function(){return this._shareContext},set:function(t){if(this._shareContext==t)return;this._shareContext=t;if(this._pRenderer)this._pRenderer.shareContext=this._shareContext},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){if(this._backgroundColor==t)return;this._backgroundColor=t;this._pRenderer._iBackgroundR=(t>>16&255)/255;this._pRenderer._iBackgroundG=(t>>8&255)/255;this._pRenderer._iBackgroundB=(t&255)/255},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"backgroundAlpha",{get:function(){return this._backgroundAlpha},set:function(t){if(t>1)t=1;else if(t<0)t=0;if(this._backgroundAlpha==t)return;this._pRenderer._iBackgroundAlpha=this._backgroundAlpha=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"camera",{get:function(){return this._pCamera},set:function(t){if(this._pCamera==t)return;if(this._pCamera)this._pCamera.removeEventListener(l.CameraEvent.PROJECTION_CHANGED,this._onProjectionChangedDelegate);this._pCamera=t;if(this._pScene)this._pScene.partition._iRegisterEntity(this._pCamera);this._pCamera.addEventListener(l.CameraEvent.PROJECTION_CHANGED,this._onProjectionChangedDelegate);this._scissorDirty=true;this._viewportDirty=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"scene",{get:function(){return this._pScene},set:function(t){if(this._pScene==t)return;if(this._pScene)this._pScene.removeEventListener(h.DisplayObjectEvent.PARTITION_CHANGED,this._onPartitionChangedDelegate);this._pScene=t;this._pScene.addEventListener(h.DisplayObjectEvent.PARTITION_CHANGED,this._onPartitionChangedDelegate);if(this._pCamera)this._pScene.partition._iRegisterEntity(this._pCamera)},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"deltaTime",{get:function(){return this._deltaTime},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(t){if(this._width==t)return;this._width=t;this._aspectRatio=this._width/this._height;this._pCamera.projection._iAspectRatio=this._aspectRatio;this._pRenderer.width=t;if(this._htmlElement){this._htmlElement.style.width=t+"px"}},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(t){if(this._height==t)return;this._height=t;this._aspectRatio=this._width/this._height;this._pCamera.projection._iAspectRatio=this._aspectRatio;this._pRenderer.height=t;if(this._htmlElement){this._htmlElement.style.height=t+"px"}},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"mousePicker",{get:function(){return this._mousePicker},set:function(t){if(this._mousePicker==t)return;if(t==null)this._mousePicker=new a.RaycastPicker;else this._mousePicker=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"x",{get:function(){return this._pRenderer.x},set:function(t){if(this._pRenderer.x==t)return;this._pRenderer.x==t;if(this._htmlElement){this._htmlElement.style.left=t+"px"}},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"y",{get:function(){return this._pRenderer.y},set:function(t){if(this._pRenderer.y==t)return;this._pRenderer.y==t;if(this._htmlElement){this._htmlElement.style.top=t+"px"}},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"visible",{get:function(){return this._htmlElement&&this._htmlElement.style.visibility=="visible"},set:function(t){if(this._htmlElement){this._htmlElement.style.visibility=t?"visible":"hidden"}},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"renderedFacesCount",{get:function(){return 0},enumerable:true,configurable:true});t.prototype.render=function(){this.pUpdateTime();this._pCamera.projection._iAspectRatio=this._aspectRatio;if(this._scissorDirty){this._scissorDirty=false;this._pCamera.projection._iUpdateScissorRect(this._pRenderer.scissorRect.x,this._pRenderer.scissorRect.y,this._pRenderer.scissorRect.width,this._pRenderer.scissorRect.height)}if(this._viewportDirty){this._viewportDirty=false;this._pCamera.projection._iUpdateViewport(this._pRenderer.viewPort.x,this._pRenderer.viewPort.y,this._pRenderer.viewPort.width,this._pRenderer.viewPort.height)}if(!this._shareContext){if(this.forceMouseMove&&this._htmlElement==this._mouseManager._iActiveDiv&&!this._mouseManager._iUpdateDirty)this._mouseManager._iCollision=this.mousePicker.getViewCollision(this._pMouseX,this._pMouseY,this);this._mouseManager.fireMouseEvents(this.forceMouseMove)}this._pRenderer.render(this._pCamera,this._pScene)};t.prototype.pUpdateTime=function(){var t=r.getTimer();if(this._time==0)this._time=t;this._deltaTime=t-this._time;this._time=t};t.prototype.dispose=function(){this._pRenderer.dispose();this._mouseManager.unregisterView(this);this._mouseManager=null;this._pRenderer=null};t.prototype._onPartitionChanged=function(t){if(this._pCamera)this._pScene.partition._iRegisterEntity(this._pCamera)};t.prototype._onProjectionChanged=function(t){this._scissorDirty=true;this._viewportDirty=true};t.prototype._onViewportUpdated=function(t){this._viewportDirty=true};t.prototype._onScissorUpdated=function(t){this._scissorDirty=true};t.prototype.project=function(t){var e=this._pCamera.project(t);e.x=e.x*this._pRenderer.viewPort.width/2+this._width*this._pCamera.projection.originX;e.y=e.y*this._pRenderer.viewPort.height/2+this._height*this._pCamera.projection.originY;return e};t.prototype.unproject=function(t,e,i){return this._pCamera.unproject(2*(t-this._width*this._pCamera.projection.originX)/this._pRenderer.viewPort.width,2*(e-this._height*this._pCamera.projection.originY)/this._pRenderer.viewPort.height,i)};t.prototype.getRay=function(t,e,i){return this._pCamera.getRay((t*2-this._width)/this._width,(e*2-this._height)/this._height,i)};t.prototype.updateCollider=function(){if(!this._shareContext){if(this._htmlElement==this._mouseManager._iActiveDiv)this._mouseManager._iCollision=this.mousePicker.getViewCollision(this._pMouseX,this._pMouseY,this)}else{var t=this.mousePicker.getViewCollision(this._pMouseX,this._pMouseY,this);if(this.layeredView||this._mouseManager._iCollision==null||t.rayEntryDistance<this._mouseManager._iCollision.rayEntryDistance)this._mouseManager._iCollision=t}};return t}();i.View=c},{"./base/TouchPoint":"awayjs-display/lib/base/TouchPoint","./display/Camera":"awayjs-display/lib/display/Camera","./display/Scene":"awayjs-display/lib/display/Scene","./events/CameraEvent":"awayjs-display/lib/events/CameraEvent","./events/DisplayObjectEvent":"awayjs-display/lib/events/DisplayObjectEvent","./events/RendererEvent":"awayjs-display/lib/events/RendererEvent","./managers/MouseManager":"awayjs-display/lib/managers/MouseManager","./pick/RaycastPicker":"awayjs-display/lib/pick/RaycastPicker","awayjs-core/lib/utils/getTimer":undefined}],"awayjs-display/lib/adapters/IDisplayObjectAdapter":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/adapters/IMovieClipAdapter":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/adapters":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/animators/IAnimationSet":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/animators/IAnimator":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/animators/data/ParticleData":[function(t,e,i){"use strict";var r=function(){function t(){}return t}();i.ParticleData=r;Object.defineProperty(i,"__esModule",{value:true});i.default=r},{}],"awayjs-display/lib/animators/nodes/AnimationNodeBase":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/library/AssetBase");var n=function(t){r(e,t);function e(){t.call(this)}Object.defineProperty(e.prototype,"stateClass",{get:function(){return this._pStateClass},enumerable:true,configurable:true});e.prototype.dispose=function(){};Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.assetType="[asset AnimationNodeBase]";return e}(s.AssetBase);i.AnimationNodeBase=n},{"awayjs-core/lib/library/AssetBase":undefined}],"awayjs-display/lib/animators":[function(t,e,i){"use strict";var r=t("./animators/data/ParticleData");i.ParticleData=r.ParticleData;var s=t("./animators/nodes/AnimationNodeBase");i.AnimationNodeBase=s.AnimationNodeBase},{"./animators/data/ParticleData":"awayjs-display/lib/animators/data/ParticleData","./animators/nodes/AnimationNodeBase":"awayjs-display/lib/animators/nodes/AnimationNodeBase"}],"awayjs-display/lib/base/AlignmentMode":[function(t,e,i){"use strict";var r=function(){function t(){}t.REGISTRATION_POINT="registrationPoint";t.PIVOT_POINT="pivot";return t}();i.AlignmentMode=r},{}],"awayjs-display/lib/base/HierarchicalProperties":[function(t,e,i){"use strict";var r=function(){function t(){}t.MOUSE_ENABLED=1;t.VISIBLE=2;t.MASK_ID=4;t.MASKS=8;t.COLOR_TRANSFORM=16;t.SCENE_TRANSFORM=32;t.ALL=63;return t}();i.HierarchicalProperties=r},{}],"awayjs-display/lib/base/IBitmapDrawable":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/base/IRenderable":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/base/ISurface":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/base/OrientationMode":[function(t,e,i){"use strict";var r=function(){function t(){}t.DEFAULT="default";t.CAMERA_PLANE="cameraPlane";t.CAMERA_POSITION="cameraPosition";return t}();i.OrientationMode=r},{}],"awayjs-display/lib/base/Style":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/events/EventDispatcher");var n=t("../events/StyleEvent");var a=function(t){r(e,t);function e(){t.call(this);this._samplers=new Object;this._images=new Object;this._color=16777215}Object.defineProperty(e.prototype,"sampler",{get:function(){return this._sampler},set:function(t){if(this._sampler==t)return;this._sampler=t;this._invalidateProperties()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"image",{get:function(){return this._image},set:function(t){if(this._image==t)return;this._image=t;this._invalidateProperties()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"uvMatrix",{get:function(){return this._uvMatrix},set:function(t){if(this._uvMatrix==t)return;this._uvMatrix=t;this._invalidateProperties()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){if(this._color==t)return;this._color=t;this._invalidateProperties()},enumerable:true,configurable:true});e.prototype.getImageAt=function(t,e){if(e===void 0){e=0}return(this._images[t.id]?this._images[t.id][e]:null)||this._image};e.prototype.getSamplerAt=function(t,e){if(e===void 0){e=0}return(this._samplers[t.id]?this._samplers[t.id][e]:null)||this._sampler};e.prototype.addImageAt=function(t,e,i){if(i===void 0){i=0}if(!this._images[e.id])this._images[e.id]=new Array;this._images[e.id][i]=t};e.prototype.addSamplerAt=function(t,e,i){if(i===void 0){i=0}if(!this._samplers[e.id])this._samplers[e.id]=new Array;this._samplers[e.id][i]=t;this._invalidateProperties()};e.prototype.removeImageAt=function(t,e){if(e===void 0){e=0}if(!this._images[t.id])return;this._images[t.id][e]=null;this._invalidateProperties()};e.prototype.removeSamplerAt=function(t,e){if(e===void 0){e=0}if(!this._samplers[t.id])return;this._samplers[t.id][e]=null;this._invalidateProperties()};e.prototype._invalidateProperties=function(){this.dispatchEvent(new n.StyleEvent(n.StyleEvent.INVALIDATE_PROPERTIES,this))};return e}(s.EventDispatcher);i.Style=a},{"../events/StyleEvent":"awayjs-display/lib/events/StyleEvent","awayjs-core/lib/events/EventDispatcher":undefined}],"awayjs-display/lib/base/Timeline":[function(t,e,i){"use strict";var r=t("../base/HierarchicalProperties");var s=t("awayjs-core/lib/geom/ColorTransform");var n=t("../managers/FrameScriptManager");var a=function(){function t(){this._functions=[];this._update_indices=[];this.numKeyFrames=0;this.keyframe_indices=[];this._potentialPrototypes=[];this._labels={};this._framescripts={};this._framescripts_translated={};this._functions[1]=this.update_mtx_all;this._functions[2]=this.update_colortransform;this._functions[3]=this.update_masks;this._functions[4]=this.update_name;this._functions[5]=this.update_button_name;this._functions[6]=this.update_visibility;this._functions[7]=this.update_blendmode;this._functions[8]=this.update_rendermode;this._functions[11]=this.update_mtx_scale_rot;this._functions[12]=this.update_mtx_pos;this._functions[200]=this.enable_maskmode;this._functions[201]=this.remove_masks}t.prototype.init=function(){if(this.frame_command_indices==null||this.frame_recipe==null||this.keyframe_durations==null)return;this.keyframe_firstframes=[];this.keyframe_constructframes=[];var t=0;var e=0;var i=0;var r=0;var s=0;for(e=0;e<this.numKeyFrames;e++){var n=this.keyframe_durations[e];if(this.frame_recipe[e]&1)s=r;this.keyframe_firstframes[r]=t;this.keyframe_constructframes[r++]=s;for(i=0;i<n;i++)this.keyframe_indices[t++]=e}};t.prototype.get_framescript=function(t){if(this._framescripts[t]==null)return"";if(typeof this._framescripts[t]=="string")return this._framescripts[t];else{throw new Error("Framescript is already translated to Function!!!")}};t.prototype.add_framescript=function(t,e){if(n.FrameScriptManager.frameScriptDebug){var i=t.split(/[\r\n]+/g)[0].split("//")[1];if(n.FrameScriptManager.frameScriptDebug[i]){this._framescripts[e]=n.FrameScriptManager.frameScriptDebug[i];this._framescripts_translated[e]=true;return}else{throw new Error("Framescript could not be found on FrameScriptManager.frameScriptDebug.\n the Object set as FrameScriptmanager.frameScriptDebug should contain a function with the name '"+i+"' !!!")}}this._framescripts[e]=t};t.prototype.regexIndexOf=function(t,e,i){var r=t.substring(i||0).search(e);return r>=0?r+(i||0):r};t.prototype.add_script_for_postcontruct=function(t,e,i){if(i===void 0){i=false}if(this._framescripts[e]!=null){if(this._framescripts_translated[e]==null){this._framescripts[e]=t.adapter.evalScript(this._framescripts[e]);this._framescripts_translated[e]=true}if(i)n.FrameScriptManager.add_script_to_queue(t,this._framescripts[e]);else n.FrameScriptManager.add_script_to_queue_pass2(t,this._framescripts[e])}};Object.defineProperty(t.prototype,"numFrames",{get:function(){return this.keyframe_indices.length},enumerable:true,configurable:true});t.prototype.getPotentialChildPrototype=function(t){return this._potentialPrototypes[t]};t.prototype.getKeyframeIndexForFrameIndex=function(t){return this.keyframe_indices[t]};t.prototype.getPotentialChildInstance=function(t){var e=this._potentialPrototypes[t].clone();e.name="";return e};t.prototype.registerPotentialChild=function(t){var e=this._potentialPrototypes.length;this._potentialPrototypes[e]=t};t.prototype.jumpToLabel=function(t,e){var i=this._labels[e];if(i>=0)t.currentFrameIndex=this.keyframe_firstframes[i]};t.prototype.gotoFrame=function(t,e,i){if(i===void 0){i=false}var r=t.constructedKeyFrameIndex;var s=this.keyframe_indices[e];if(r==s)return;if(r+1==s){this.constructNextFrame(t,!i,true);return}var n=this.keyframe_constructframes[s];var a=s>r;var o=n>r;var l=a&&!o?r+1:n;var h;var p;if(o)for(h=t.numChildren-1;h>=0;h--)if(t._children[h]._depthID<0)t.removeChildAt(h);if(!a)t.resetSessionIDs();var u=t.getSessionIDDepths();this.pass1(l,s,u);var c;for(h=t.numChildren-1;h>=0;h--){c=t._children[h];if(c._depthID<0){if(u[c._depthID]!=c._sessionID){t.removeChildAt(h)}else if(!a){if(c.adapter){if(!c.adapter.isBlockedByScript()){c.transform.clearMatrix3D();c.transform.clearColorTransform();c.masks=null;c.maskMode=false}if(!c.adapter.isVisibilityByScript()){c.visible=true}}}}}for(var f in u){c=t.getPotentialChildInstance(this.add_child_stream[u[f]*2]);if(c._sessionID==-1)t._addTimelineChildAt(c,Number(f),u[f])}if(!i&&this.keyframe_firstframes[s]==e)this.add_script_for_postcontruct(t,s,true);this.pass2(t);t.constructedKeyFrameIndex=s};t.prototype.pass1=function(t,e,i){var r;var s;this._update_indices.length=0;var n=0;var a;var o;for(s=t;s<=e;s++){var l=this.frame_command_indices[s];var h=this.frame_recipe[s];if(h&2){a=this.command_index_stream[l];o=a+this.command_length_stream[l++];for(r=a;r<o;r++)delete i[this.remove_child_stream[r]-16383]}if(h&4){a=this.command_index_stream[l];o=a+this.command_length_stream[l++];for(r=o-1;r>=a;r--)i[this.add_child_stream[r*2+1]-16383]=r}if(h&8)this._update_indices[n++]=l}};t.prototype.pass2=function(t){var e;var i=this._update_indices.length;for(e=0;e<i;e++)this.update_childs(t,this._update_indices[e])};t.prototype.constructNextFrame=function(t,e,i){if(e===void 0){e=true}if(i===void 0){i=false}var r=t.currentFrameIndex;var s=this.keyframe_indices[r];if(e&&this.keyframe_firstframes[s]==r)this.add_script_for_postcontruct(t,s,i);if(t.constructedKeyFrameIndex!=s){t.constructedKeyFrameIndex=s;var n=this.frame_command_indices[s];var a=this.frame_recipe[s];if(a&1){for(var o=t.numChildren-1;o>=0;o--)if(t._children[o]._depthID<0)t.removeChildAt(o)}else if(a&2){this.remove_childs_continous(t,n++)}if(a&4)this.add_childs_continous(t,n++);if(a&8)this.update_childs(t,n++)}};t.prototype.remove_childs_continous=function(t,e){var i=this.command_index_stream[e];var r=i+this.command_length_stream[e];for(var s=i;s<r;s++)t.removeChildAt(t.getDepthIndexInternal(this.remove_child_stream[s]-16383))};t.prototype.add_childs_continous=function(t,e){var i;var r=this.command_index_stream[e];var s=r+this.command_length_stream[e];for(var n=s-1;n>=r;n--){i=n*2;t._addTimelineChildAt(t.getPotentialChildInstance(this.add_child_stream[i]),this.add_child_stream[i+1]-16383,n)}};t.prototype.update_childs=function(t,e){var i;var r;var s;var n=this.command_index_stream[e];var a=n+this.command_length_stream[e];var o;for(var l=n;l<a;l++){o=t.getChildAtSessionID(this.update_child_stream[l]);if(o){this._blocked=Boolean(o.adapter&&o.adapter.isBlockedByScript());r=this.update_child_props_indices_stream[l];s=r+this.update_child_props_length_stream[l];for(i=r;i<s;i++)this._functions[this.property_type_stream[i]].call(this,o,t,this.property_index_stream[i])}}};t.prototype.update_mtx_all=function(t,e,i){if(this._blocked)return;i*=6;var r=t.transform.matrix3D;r.rawData[0]=this.properties_stream_f32_mtx_all[i++];r.rawData[1]=this.properties_stream_f32_mtx_all[i++];r.rawData[4]=this.properties_stream_f32_mtx_all[i++];r.rawData[5]=this.properties_stream_f32_mtx_all[i++];r.rawData[12]=this.properties_stream_f32_mtx_all[i++];r.rawData[13]=this.properties_stream_f32_mtx_all[i];t.transform.invalidateComponents()};t.prototype.update_colortransform=function(t,e,i){if(this._blocked)return;i*=8;var r=t.transform.colorTransform||(t.transform.colorTransform=new s.ColorTransform);r.rawData[0]=this.properties_stream_f32_ct[i++];r.rawData[1]=this.properties_stream_f32_ct[i++];r.rawData[2]=this.properties_stream_f32_ct[i++];r.rawData[3]=this.properties_stream_f32_ct[i++];r.rawData[4]=this.properties_stream_f32_ct[i++];r.rawData[5]=this.properties_stream_f32_ct[i++];r.rawData[6]=this.properties_stream_f32_ct[i++];r.rawData[7]=this.properties_stream_f32_ct[i];t.transform.invalidateColorTransform()};t.prototype.update_masks=function(t,e,i){var r;var s=new Array;var n=this.properties_stream_int[i++];for(var a=0;a<n;a++)if(r=e.getChildAtSessionID(this.properties_stream_int[i++]))s.push(r);t.masks=s};t.prototype.update_name=function(t,e,i){t.name=this.properties_stream_strings[i];e.adapter.registerScriptObject(t)};t.prototype.update_button_name=function(t,e,i){t.name=this.properties_stream_strings[i];t.addButtonListeners();e.adapter.registerScriptObject(t)};t.prototype.update_visibility=function(t,e,i){if(!t.adapter||!t.adapter.isVisibilityByScript())t.visible=Boolean(i)};t.prototype.update_mtx_scale_rot=function(t,e,i){if(this._blocked)return;i*=4;var s=t.transform.matrix3D;s.rawData[0]=this.properties_stream_f32_mtx_scale_rot[i++];s.rawData[1]=this.properties_stream_f32_mtx_scale_rot[i++];s.rawData[4]=this.properties_stream_f32_mtx_scale_rot[i++];s.rawData[5]=this.properties_stream_f32_mtx_scale_rot[i];t.transform.invalidateComponents();t.pInvalidateHierarchicalProperties(r.HierarchicalProperties.SCENE_TRANSFORM)};t.prototype.update_mtx_pos=function(t,e,i){if(this._blocked)return;i*=2;var r=t.transform.matrix3D;r.rawData[12]=this.properties_stream_f32_mtx_pos[i++];r.rawData[13]=this.properties_stream_f32_mtx_pos[i];t.transform.invalidatePosition()};t.prototype.enable_maskmode=function(t,e,i){t.maskMode=true};t.prototype.remove_masks=function(t,e,i){t.masks=null};t.prototype.update_blendmode=function(t,e,i){console.log("update blendmode "+i)};t.prototype.update_rendermode=function(t,e,i){console.log("update rendermode "+i)};return t}();i.Timeline=a},{"../base/HierarchicalProperties":"awayjs-display/lib/base/HierarchicalProperties","../managers/FrameScriptManager":"awayjs-display/lib/managers/FrameScriptManager","awayjs-core/lib/geom/ColorTransform":undefined}],"awayjs-display/lib/base/TouchPoint":[function(t,e,i){"use strict";var r=function(){function t(t,e,i){this.x=t;this.y=e;this.id=i}return t}();i.TouchPoint=r},{}],"awayjs-display/lib/base/Transform":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/events/EventDispatcher");var n=t("awayjs-core/lib/geom/Matrix3D");var a=t("awayjs-core/lib/geom/Matrix3DUtils");var o=t("awayjs-core/lib/geom/Vector3D");var l=t("../events/TransformEvent");var h=function(t){r(e,t);function e(){t.call(this);this._matrix3D=new n.Matrix3D;this._rotation=new o.Vector3D;this._skew=new o.Vector3D;this._scale=new o.Vector3D(1,1,1);this._components=new Array(4);this._components[1]=this._rotation;this._components[2]=this._skew;this._components[3]=this._scale}Object.defineProperty(e.prototype,"backVector",{get:function(){var t=a.Matrix3DUtils.getForward(this._matrix3D);t.negate();return t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"colorTransform",{get:function(){return this._colorTransform},set:function(t){if(this._colorTransform==t)return;this._colorTransform=t;this.invalidateColorTransform()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"concatenatedColorTransform",{get:function(){return this._concatenatedColorTransform},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"concatenatedMatrix",{get:function(){return this._concatenatedMatrix},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"downVector",{get:function(){var t=a.Matrix3DUtils.getUp(this._matrix3D);t.negate();return t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"forwardVector",{get:function(){return a.Matrix3DUtils.getForward(this._matrix3D)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"leftVector",{get:function(){var t=a.Matrix3DUtils.getRight(this._matrix3D);t.negate();return t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"matrix3D",{get:function(){if(this._matrix3DDirty)this._updateMatrix3D();return this._matrix3D},set:function(t){for(var e=0;e<15;e++)this._matrix3D.rawData[e]=t.rawData[e];this.invalidateComponents()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"pixelBounds",{get:function(){return this._pixelBounds},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"position",{get:function(){return this._matrix3D.position},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"rightVector",{get:function(){return a.Matrix3DUtils.getRight(this.matrix3D)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"rotation",{get:function(){if(this._componentsDirty)this._updateComponents();return this._rotation},enumerable:true,configurable:true});e.prototype.rotateTo=function(t,e,i){if(this._componentsDirty)this._updateComponents();this._rotation.x=t;this._rotation.y=e;this._rotation.z=i;this.invalidateMatrix3D()};Object.defineProperty(e.prototype,"scale",{get:function(){if(this._componentsDirty)this._updateComponents();return this._scale},enumerable:true,configurable:true});e.prototype.scaleTo=function(t,e,i){if(this._componentsDirty)this._updateComponents();this._scale.x=t;this._scale.y=e;this._scale.z=i;this.invalidateMatrix3D()};Object.defineProperty(e.prototype,"skew",{get:function(){if(this._componentsDirty)this._updateComponents();return this._skew},enumerable:true,configurable:true});e.prototype.skewTo=function(t,e,i){if(this._componentsDirty)this._updateComponents();this._skew.x=t;this._skew.y=e;this._skew.z=i;this.invalidateMatrix3D()};Object.defineProperty(e.prototype,"upVector",{get:function(){return a.Matrix3DUtils.getUp(this.matrix3D)},enumerable:true,configurable:true});e.prototype.dispose=function(){};e.prototype.getRelativeMatrix3D=function(t){return new n.Matrix3D};e.prototype.moveForward=function(t){this.translateLocal(o.Vector3D.Z_AXIS,t)};e.prototype.moveBackward=function(t){this.translateLocal(o.Vector3D.Z_AXIS,-t)};e.prototype.moveLeft=function(t){this.translateLocal(o.Vector3D.X_AXIS,-t)};e.prototype.moveRight=function(t){
this.translateLocal(o.Vector3D.X_AXIS,t)};e.prototype.moveUp=function(t){this.translateLocal(o.Vector3D.Y_AXIS,t)};e.prototype.moveDown=function(t){this.translateLocal(o.Vector3D.Y_AXIS,-t)};e.prototype.moveTo=function(t,e,i){this._matrix3D.rawData[12]=t;this._matrix3D.rawData[13]=e;this._matrix3D.rawData[14]=i;this.invalidatePosition()};e.prototype.pitch=function(t){this.rotate(o.Vector3D.X_AXIS,t)};e.prototype.roll=function(t){this.rotate(o.Vector3D.Z_AXIS,t)};e.prototype.yaw=function(t){this.rotate(o.Vector3D.Y_AXIS,t)};e.prototype.rotate=function(t,e){this.matrix3D.prependRotation(e,t);this.invalidateComponents()};e.prototype.translate=function(t,e){var i=t.x,r=t.y,s=t.z;var n=e/Math.sqrt(i*i+r*r+s*s);this.matrix3D.appendTranslation(i*n,r*n,s*n);this.invalidatePosition()};e.prototype.translateLocal=function(t,e){var i=t.x,r=t.y,s=t.z;var n=e/Math.sqrt(i*i+r*r+s*s);this.matrix3D.prependTranslation(i*n,r*n,s*n);this.invalidatePosition()};e.prototype.clearMatrix3D=function(){this._matrix3D.identity();this.invalidateComponents()};e.prototype.clearColorTransform=function(){if(!this._colorTransform)return;this._colorTransform.clear();this.invalidateColorTransform()};e.prototype.invalidateMatrix3D=function(){this._matrix3DDirty=true;this.dispatchEvent(new l.TransformEvent(l.TransformEvent.INVALIDATE_MATRIX3D,this))};e.prototype.invalidateComponents=function(){this.invalidatePosition();this._componentsDirty=true};e.prototype.invalidatePosition=function(){this._matrix3D.invalidatePosition();this.dispatchEvent(new l.TransformEvent(l.TransformEvent.INVALIDATE_MATRIX3D,this))};e.prototype.invalidateColorTransform=function(){this.dispatchEvent(new l.TransformEvent(l.TransformEvent.INVALIDATE_COLOR_TRANSFORM,this))};e.prototype._updateMatrix3D=function(){this._matrix3D.recompose(this._components);this._matrix3DDirty=false};e.prototype._updateComponents=function(){var t=this._matrix3D.decompose();var e;e=t[1];this._rotation.x=e.x;this._rotation.y=e.y;this._rotation.z=e.z;e=t[2];this._skew.x=e.x;this._skew.y=e.y;this._skew.z=e.z;e=t[3];this._scale.x=e.x;this._scale.y=e.y;this._scale.z=e.z;this._componentsDirty=false};return e}(s.EventDispatcher);i.Transform=h},{"../events/TransformEvent":"awayjs-display/lib/events/TransformEvent","awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-display/lib/base":[function(t,e,i){"use strict";var r=t("./base/AlignmentMode");i.AlignmentMode=r.AlignmentMode;var s=t("./base/HierarchicalProperties");i.HierarchicalProperties=s.HierarchicalProperties;var n=t("./base/OrientationMode");i.OrientationMode=n.OrientationMode;var a=t("./base/Style");i.Style=a.Style;var o=t("./base/Timeline");i.Timeline=o.Timeline;var l=t("./base/TouchPoint");i.TouchPoint=l.TouchPoint;var h=t("./base/Transform");i.Transform=h.Transform},{"./base/AlignmentMode":"awayjs-display/lib/base/AlignmentMode","./base/HierarchicalProperties":"awayjs-display/lib/base/HierarchicalProperties","./base/OrientationMode":"awayjs-display/lib/base/OrientationMode","./base/Style":"awayjs-display/lib/base/Style","./base/Timeline":"awayjs-display/lib/base/Timeline","./base/TouchPoint":"awayjs-display/lib/base/TouchPoint","./base/Transform":"awayjs-display/lib/base/Transform"}],"awayjs-display/lib/bounds/AxisAlignedBoundingBox":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/geom/PlaneClassification");var n=t("../graphics/ElementsType");var a=t("../bounds/BoundingVolumeBase");var o=t("../prefabs/PrimitiveCubePrefab");var l=function(t){r(e,t);function e(e){t.call(this,e);this._x=0;this._y=0;this._z=0;this._width=0;this._height=0;this._depth=0;this._centerX=0;this._centerY=0;this._centerZ=0;this._halfExtentsX=0;this._halfExtentsY=0;this._halfExtentsZ=0}e.prototype.nullify=function(){this._x=this._y=this._z=0;this._width=this._height=this._depth=0;this._centerX=this._centerY=this._centerZ=0;this._halfExtentsX=this._halfExtentsY=this._halfExtentsZ=0};e.prototype.isInFrustum=function(t,e){if(this._pInvalidated)this._pUpdate();for(var i=0;i<e;++i){var r=t[i];var s=r.a;var n=r.b;var a=r.c;var o=s<0?-this._halfExtentsX:this._halfExtentsX;var l=n<0?-this._halfExtentsY:this._halfExtentsY;var h=a<0?-this._halfExtentsZ:this._halfExtentsZ;var p=s*(this._centerX+o)+n*(this._centerY+l)+a*(this._centerZ+h)-r.d;if(p<0)return false}return true};e.prototype.rayIntersection=function(t,e,i){if(this._pInvalidated)this._pUpdate();return this._box.rayIntersection(t,e,i)};e.prototype.classifyToPlane=function(t){var e=t.a;var i=t.b;var r=t.c;var n=e*this._centerX+i*this._centerY+r*this._centerZ-t.d;if(e<0)e=-e;if(i<0)i=-i;if(r<0)r=-r;var a=e*this._halfExtentsX+i*this._halfExtentsY+r*this._halfExtentsZ;return n>a?s.PlaneClassification.FRONT:n<-a?s.PlaneClassification.BACK:s.PlaneClassification.INTERSECT};e.prototype._pUpdate=function(){t.prototype._pUpdate.call(this);this._box=this._pEntity.getBox();var e=this._pEntity.sceneTransform;var i=this._box.width/2;var r=this._box.height/2;var s=this._box.depth/2;var n=this._box.x+i;var a=this._box.y+r;var o=this._box.z+s;var l=e.rawData;var h=l[0],p=l[4],u=l[8],c=l[12];var f=l[1],d=l[5],_=l[9],y=l[13];var v=l[2],m=l[6],b=l[10],g=l[14];this._centerX=n*h+a*p+o*u+c;this._centerY=n*f+a*d+o*_+y;this._centerZ=n*v+a*m+o*b+g;this._halfExtentsX=Math.abs(i*h+r*p+s*u);this._halfExtentsY=Math.abs(i*f+r*d+s*_);this._halfExtentsZ=Math.abs(i*v+r*m+s*b);if(this._prefab){this._prefab.width=this._box.width;this._prefab.height=this._box.height;this._prefab.depth=this._box.depth;this._pBoundsPrimitive.transform.matrix3D=e}this._width=this._halfExtentsX*2;this._height=this._halfExtentsY*2;this._depth=this._halfExtentsZ*2;this._x=this._centerX-this._halfExtentsX;this._y=this._centerY-this._halfExtentsY;this._z=this._centerZ-this._halfExtentsZ};e.prototype._pCreateBoundsPrimitive=function(){this._prefab=new o.PrimitiveCubePrefab(null,n.ElementsType.LINE);return this._prefab.getNewObject()};return e}(a.BoundingVolumeBase);i.AxisAlignedBoundingBox=l},{"../bounds/BoundingVolumeBase":"awayjs-display/lib/bounds/BoundingVolumeBase","../graphics/ElementsType":"awayjs-display/lib/graphics/ElementsType","../prefabs/PrimitiveCubePrefab":"awayjs-display/lib/prefabs/PrimitiveCubePrefab","awayjs-core/lib/geom/PlaneClassification":undefined}],"awayjs-display/lib/bounds/BoundingSphere":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/geom/PlaneClassification");var n=t("../graphics/ElementsType");var a=t("../bounds/BoundingVolumeBase");var o=t("../prefabs/PrimitiveSpherePrefab");var l=function(t){r(e,t);function e(e){t.call(this,e);this._radius=0;this._centerX=0;this._centerY=0;this._centerZ=0}e.prototype.nullify=function(){this._centerX=this._centerY=this._centerZ=0;this._radius=0};e.prototype.isInFrustum=function(t,e){if(this._pInvalidated)this._pUpdate();for(var i=0;i<e;++i){var r=t[i];var s=r.a<0?-this._radius:this._radius;var n=r.b<0?-this._radius:this._radius;var a=r.c<0?-this._radius:this._radius;var o=r.a*(this._centerX+s)+r.b*(this._centerY+n)+r.c*(this._centerZ+a)-r.d;if(o<0){return false}}return true};e.prototype.rayIntersection=function(t,e,i){if(this._pInvalidated)this._pUpdate();return this._sphere.rayIntersection(t,e,i)};e.prototype.classifyToPlane=function(t){var e=t.a;var i=t.b;var r=t.c;var n=e*this._centerX+i*this._centerY+r*this._centerZ-t.d;if(e<0)e=-e;if(i<0)i=-i;if(r<0)r=-r;var a=(e+i+r)*this._radius;return n>a?s.PlaneClassification.FRONT:n<-a?s.PlaneClassification.BACK:s.PlaneClassification.INTERSECT};e.prototype._pUpdate=function(){t.prototype._pUpdate.call(this);this._sphere=this._pEntity.getSphere();var e=this._pEntity.sceneTransform;var i=this._sphere.x;var r=this._sphere.y;var s=this._sphere.z;var n=this._sphere.radius;var a=e.rawData;var o=a[0],l=a[4],h=a[8],p=a[12];var u=a[1],c=a[5],f=a[9],d=a[13];var _=a[2],y=a[6],v=a[10],m=a[14];this._centerX=i*o+r*l+s*h+p;this._centerY=i*u+r*c+s*f+d;this._centerZ=i*_+r*y+s*v+m;var b=o+l+h;var g=u+c+f;var w=_+y+v;this._radius=n*Math.sqrt((b*b+g*g+w*w)/3);if(this._prefab){this._prefab.radius=n;this._pBoundsPrimitive.x=i;this._pBoundsPrimitive.y=r;this._pBoundsPrimitive.z=s;this._pBoundsPrimitive.transform.matrix3D=e}};e.prototype._pCreateBoundsPrimitive=function(){this._prefab=new o.PrimitiveSpherePrefab(null,n.ElementsType.LINE);return this._prefab.getNewObject()};return e}(a.BoundingVolumeBase);i.BoundingSphere=l},{"../bounds/BoundingVolumeBase":"awayjs-display/lib/bounds/BoundingVolumeBase","../graphics/ElementsType":"awayjs-display/lib/graphics/ElementsType","../prefabs/PrimitiveSpherePrefab":"awayjs-display/lib/prefabs/PrimitiveSpherePrefab","awayjs-core/lib/geom/PlaneClassification":undefined}],"awayjs-display/lib/bounds/BoundingVolumeBase":[function(t,e,i){"use strict";var r=t("awayjs-core/lib/errors/AbstractMethodError");var s=function(){function t(t){this._pInvalidated=true;this._pEntity=t}t.prototype.dispose=function(){this._pEntity=null;this._pBoundsPrimitive=null};Object.defineProperty(t.prototype,"boundsPrimitive",{get:function(){if(this._pBoundsPrimitive==null){this._pBoundsPrimitive=this._pCreateBoundsPrimitive();this._pInvalidated=true}if(this._pInvalidated)this._pUpdate();return this._pBoundsPrimitive},enumerable:true,configurable:true});t.prototype.nullify=function(){throw new r.AbstractMethodError};t.prototype.isInFrustum=function(t,e){throw new r.AbstractMethodError};t.prototype.clone=function(){throw new r.AbstractMethodError};t.prototype.rayIntersection=function(t,e,i){return-1};t.prototype.classifyToPlane=function(t){throw new r.AbstractMethodError};t.prototype._pUpdate=function(){this._pInvalidated=false};t.prototype.invalidate=function(){this._pInvalidated=true};t.prototype._pCreateBoundsPrimitive=function(){throw new r.AbstractMethodError};return t}();i.BoundingVolumeBase=s},{"awayjs-core/lib/errors/AbstractMethodError":undefined}],"awayjs-display/lib/bounds/BoundsType":[function(t,e,i){"use strict";var r=function(){function t(){}t.SPHERE="sphere";t.AXIS_ALIGNED_BOX="axisAlignedBox";t.NULL="null";return t}();i.BoundsType=r},{}],"awayjs-display/lib/bounds/NullBounds":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/geom/PlaneClassification");var n=t("../bounds/BoundingVolumeBase");var a=function(t){r(e,t);function e(e){if(e===void 0){e=true}t.call(this,null);this._alwaysIn=e}e.prototype.clone=function(){return new e(this._alwaysIn)};e.prototype.isInFrustum=function(t,e){return this._alwaysIn};e.prototype.classifyToPlane=function(t){return s.PlaneClassification.INTERSECT};return e}(n.BoundingVolumeBase);i.NullBounds=a},{"../bounds/BoundingVolumeBase":"awayjs-display/lib/bounds/BoundingVolumeBase","awayjs-core/lib/geom/PlaneClassification":undefined}],"awayjs-display/lib/bounds":[function(t,e,i){"use strict";var r=t("./bounds/AxisAlignedBoundingBox");i.AxisAlignedBoundingBox=r.AxisAlignedBoundingBox;var s=t("./bounds/BoundingSphere");i.BoundingSphere=s.BoundingSphere;var n=t("./bounds/BoundingVolumeBase");i.BoundingVolumeBase=n.BoundingVolumeBase;var a=t("./bounds/BoundsType");i.BoundsType=a.BoundsType;var o=t("./bounds/NullBounds");i.NullBounds=o.NullBounds},{"./bounds/AxisAlignedBoundingBox":"awayjs-display/lib/bounds/AxisAlignedBoundingBox","./bounds/BoundingSphere":"awayjs-display/lib/bounds/BoundingSphere","./bounds/BoundingVolumeBase":"awayjs-display/lib/bounds/BoundingVolumeBase","./bounds/BoundsType":"awayjs-display/lib/bounds/BoundsType","./bounds/NullBounds":"awayjs-display/lib/bounds/NullBounds"}],"awayjs-display/lib/controllers/ControllerBase":[function(t,e,i){"use strict";var r=t("awayjs-core/lib/errors/AbstractMethodError");var s=function(){function t(t){if(t===void 0){t=null}this._pAutoUpdate=true;this.targetObject=t}t.prototype.pNotifyUpdate=function(){if(this._pTargetObject)this._pTargetObject.invalidatePartitionBounds()};Object.defineProperty(t.prototype,"targetObject",{get:function(){return this._pTargetObject},set:function(t){if(this._pTargetObject==t)return;if(this._pTargetObject&&this._pAutoUpdate)this._pTargetObject._iController=null;this._pTargetObject=t;if(this._pTargetObject&&this._pAutoUpdate)this._pTargetObject._iController=this;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._pAutoUpdate},set:function(t){if(this._pAutoUpdate==t)return;this._pAutoUpdate=t;if(this._pTargetObject){if(this._pAutoUpdate)this._pTargetObject._iController=this;else this._pTargetObject._iController=null}},enumerable:true,configurable:true});t.prototype.update=function(t){if(t===void 0){t=true}throw new r.AbstractMethodError};t.prototype.updateController=function(){if(this._pControllerDirty&&this._pAutoUpdate){this._pControllerDirty=false;this.pNotifyUpdate()}};return t}();i.ControllerBase=s},{"awayjs-core/lib/errors/AbstractMethodError":undefined}],"awayjs-display/lib/controllers/FirstPersonController":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/geom/MathConsts");var n=t("../controllers/ControllerBase");var a=function(t){r(e,t);function e(e,i,r,s,n,a,o){if(e===void 0){e=null}if(i===void 0){i=0}if(r===void 0){r=90}if(s===void 0){s=-90}if(n===void 0){n=90}if(a===void 0){a=8}if(o===void 0){o=false}t.call(this,e);this._iCurrentPanAngle=0;this._iCurrentTiltAngle=90;this._panAngle=0;this._tiltAngle=90;this._minTiltAngle=-90;this._maxTiltAngle=90;this._steps=8;this._walkIncrement=0;this._strafeIncrement=0;this._wrapPanAngle=false;this.fly=false;this.panAngle=i;this.tiltAngle=r;this.minTiltAngle=s;this.maxTiltAngle=n;this.steps=a;this.wrapPanAngle=o;this._iCurrentPanAngle=this._panAngle;this._iCurrentTiltAngle=this._tiltAngle}Object.defineProperty(e.prototype,"steps",{get:function(){return this._steps},set:function(t){t=t<1?1:t;if(this._steps==t)return;this._steps=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"panAngle",{get:function(){return this._panAngle},set:function(t){if(this._panAngle==t)return;this._panAngle=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"tiltAngle",{get:function(){return this._tiltAngle},set:function(t){t=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,t));if(this._tiltAngle==t)return;this._tiltAngle=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"minTiltAngle",{get:function(){return this._minTiltAngle},set:function(t){if(this._minTiltAngle==t)return;this._minTiltAngle=t;this.tiltAngle=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,this._tiltAngle))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"maxTiltAngle",{get:function(){return this._maxTiltAngle},set:function(t){if(this._maxTiltAngle==t)return;this._maxTiltAngle=t;this.tiltAngle=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,this._tiltAngle))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"wrapPanAngle",{get:function(){return this._wrapPanAngle},set:function(t){if(this._wrapPanAngle==t)return;this._wrapPanAngle=t;this.pNotifyUpdate()},enumerable:true,configurable:true});e.prototype.update=function(t){if(t===void 0){t=true}if(this._tiltAngle!=this._iCurrentTiltAngle||this._panAngle!=this._iCurrentPanAngle){this._pControllerDirty=true;if(this._wrapPanAngle){if(this._panAngle<0){this._iCurrentPanAngle+=this._panAngle%360+360-this._panAngle;this._panAngle=this._panAngle%360+360}else{this._iCurrentPanAngle+=this._panAngle%360-this._panAngle;this._panAngle=this._panAngle%360}while(this._panAngle-this._iCurrentPanAngle<-180)this._iCurrentPanAngle-=360;while(this._panAngle-this._iCurrentPanAngle>180)this._iCurrentPanAngle+=360}if(t){this._iCurrentTiltAngle+=(this._tiltAngle-this._iCurrentTiltAngle)/(this.steps+1);this._iCurrentPanAngle+=(this._panAngle-this._iCurrentPanAngle)/(this.steps+1)}else{this._iCurrentTiltAngle=this._tiltAngle;this._iCurrentPanAngle=this._panAngle}if(Math.abs(this.tiltAngle-this._iCurrentTiltAngle)<.01&&Math.abs(this._panAngle-this._iCurrentPanAngle)<.01){this._iCurrentTiltAngle=this._tiltAngle;this._iCurrentPanAngle=this._panAngle}}this.targetObject.rotationX=this._iCurrentTiltAngle;this.targetObject.rotationY=this._iCurrentPanAngle;if(this._walkIncrement){if(this.fly){this.targetObject.transform.moveForward(this._walkIncrement)}else{this.targetObject.x+=this._walkIncrement*Math.sin(this._panAngle*s.MathConsts.DEGREES_TO_RADIANS);this.targetObject.z+=this._walkIncrement*Math.cos(this._panAngle*s.MathConsts.DEGREES_TO_RADIANS)}this._walkIncrement=0}if(this._strafeIncrement){this.targetObject.transform.moveRight(this._strafeIncrement);this._strafeIncrement=0}};e.prototype.incrementWalk=function(t){if(t==0)return;this._walkIncrement+=t;this.pNotifyUpdate()};e.prototype.incrementStrafe=function(t){if(t==0)return;this._strafeIncrement+=t;this.pNotifyUpdate()};return e}(n.ControllerBase);i.FirstPersonController=a},{"../controllers/ControllerBase":"awayjs-display/lib/controllers/ControllerBase","awayjs-core/lib/geom/MathConsts":undefined}],"awayjs-display/lib/controllers/FollowController":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../controllers/HoverController");var n=function(t){r(e,t);function e(e,i,r,s){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=45}if(s===void 0){s=700}t.call(this,e,i,0,r,s)}e.prototype.update=function(e){if(e===void 0){e=true}if(!this.lookAtObject)return;this.panAngle=this._pLookAtObject.rotationY-180;t.prototype.update.call(this)};return e}(s.HoverController);i.FollowController=n},{"../controllers/HoverController":"awayjs-display/lib/controllers/HoverController"}],"awayjs-display/lib/controllers/HoverController":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/geom/MathConsts");var n=t("awayjs-core/lib/geom/Vector3D");var a=t("../controllers/LookAtController");var o=function(t){r(e,t);function e(e,i,r,s,a,o,l,h,p,u,c,f){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=0}if(s===void 0){s=90}if(a===void 0){a=1e3}if(o===void 0){o=-90}if(l===void 0){l=90}if(h===void 0){h=null}if(p===void 0){p=null}if(u===void 0){u=8}if(c===void 0){c=2}if(f===void 0){f=false}t.call(this,e,i);this._iCurrentPanAngle=0;this._iCurrentTiltAngle=90;this._panAngle=0;this._tiltAngle=90;this._distance=1e3;this._minPanAngle=-Infinity;this._maxPanAngle=Infinity;this._minTiltAngle=-90;this._maxTiltAngle=90;this._steps=8;this._yFactor=2;this._wrapPanAngle=false;this._upAxis=new n.Vector3D;this.distance=a;this.panAngle=r;this.tiltAngle=s;this.minPanAngle=h!=null?h:-Infinity;this.maxPanAngle=p!=null?p:Infinity;this.minTiltAngle=o;this.maxTiltAngle=l;this.steps=u;this.yFactor=c;this.wrapPanAngle=f;this._iCurrentPanAngle=this._panAngle;this._iCurrentTiltAngle=this._tiltAngle}Object.defineProperty(e.prototype,"steps",{get:function(){return this._steps},set:function(t){t=t<1?1:t;if(this._steps==t)return;this._steps=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"panAngle",{get:function(){return this._panAngle},set:function(t){t=Math.max(this._minPanAngle,Math.min(this._maxPanAngle,t));if(this._panAngle==t)return;this._panAngle=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"tiltAngle",{get:function(){return this._tiltAngle},set:function(t){t=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,t));if(this._tiltAngle==t)return;this._tiltAngle=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},set:function(t){if(this._distance==t)return;this._distance=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"minPanAngle",{get:function(){return this._minPanAngle},set:function(t){if(this._minPanAngle==t)return;this._minPanAngle=t;this.panAngle=Math.max(this._minPanAngle,Math.min(this._maxPanAngle,this._panAngle))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"maxPanAngle",{get:function(){return this._maxPanAngle},set:function(t){if(this._maxPanAngle==t)return;this._maxPanAngle=t;this.panAngle=Math.max(this._minPanAngle,Math.min(this._maxPanAngle,this._panAngle))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"minTiltAngle",{get:function(){return this._minTiltAngle},set:function(t){if(this._minTiltAngle==t)return;this._minTiltAngle=t;this.tiltAngle=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,this._tiltAngle))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"maxTiltAngle",{get:function(){return this._maxTiltAngle},set:function(t){if(this._maxTiltAngle==t)return;this._maxTiltAngle=t;this.tiltAngle=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,this._tiltAngle))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"yFactor",{get:function(){return this._yFactor},set:function(t){if(this._yFactor==t)return;this._yFactor=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"wrapPanAngle",{get:function(){return this._wrapPanAngle},set:function(t){if(this._wrapPanAngle==t)return;this._wrapPanAngle=t;this.pNotifyUpdate()},enumerable:true,configurable:true});e.prototype.update=function(t){if(t===void 0){t=true}if(this._tiltAngle!=this._iCurrentTiltAngle||this._panAngle!=this._iCurrentPanAngle){this._pControllerDirty=true;if(this._wrapPanAngle){if(this._panAngle<0){this._iCurrentPanAngle+=this._panAngle%360+360-this._panAngle;this._panAngle=this._panAngle%360+360}else{this._iCurrentPanAngle+=this._panAngle%360-this._panAngle;this._panAngle=this._panAngle%360}while(this._panAngle-this._iCurrentPanAngle<-180)this._iCurrentPanAngle-=360;while(this._panAngle-this._iCurrentPanAngle>180)this._iCurrentPanAngle+=360}if(t){this._iCurrentTiltAngle+=(this._tiltAngle-this._iCurrentTiltAngle)/(this.steps+1);this._iCurrentPanAngle+=(this._panAngle-this._iCurrentPanAngle)/(this.steps+1)}else{this._iCurrentPanAngle=this._panAngle;this._iCurrentTiltAngle=this._tiltAngle}if(Math.abs(this.tiltAngle-this._iCurrentTiltAngle)<.01&&Math.abs(this._panAngle-this._iCurrentPanAngle)<.01){this._iCurrentTiltAngle=this._tiltAngle;this._iCurrentPanAngle=this._panAngle}}var e=this.lookAtObject?this.lookAtObject.transform.position:this.lookAtPosition?this.lookAtPosition:this._pOrigin;this.targetObject.x=e.x+this.distance*Math.sin(this._iCurrentPanAngle*s.MathConsts.DEGREES_TO_RADIANS)*Math.cos(this._iCurrentTiltAngle*s.MathConsts.DEGREES_TO_RADIANS);this.targetObject.y=e.y+this.distance*Math.sin(this._iCurrentTiltAngle*s.MathConsts.DEGREES_TO_RADIANS)*this.yFactor;this.targetObject.z=e.z+this.distance*Math.cos(this._iCurrentPanAngle*s.MathConsts.DEGREES_TO_RADIANS)*Math.cos(this._iCurrentTiltAngle*s.MathConsts.DEGREES_TO_RADIANS);this._upAxis.x=-Math.sin(this._iCurrentPanAngle*s.MathConsts.DEGREES_TO_RADIANS)*Math.sin(this._iCurrentTiltAngle*s.MathConsts.DEGREES_TO_RADIANS);this._upAxis.y=Math.cos(this._iCurrentTiltAngle*s.MathConsts.DEGREES_TO_RADIANS);this._upAxis.z=-Math.cos(this._iCurrentPanAngle*s.MathConsts.DEGREES_TO_RADIANS)*Math.sin(this._iCurrentTiltAngle*s.MathConsts.DEGREES_TO_RADIANS);if(this._pTargetObject){if(this._pLookAtPosition)this._pTargetObject.lookAt(this._pLookAtPosition,this._upAxis);else if(this._pLookAtObject)this._pTargetObject.lookAt(this._pLookAtObject.scene?this._pLookAtObject.scenePosition:this._pLookAtObject.transform.position,this._upAxis)}};return e}(a.LookAtController);i.HoverController=o},{"../controllers/LookAtController":"awayjs-display/lib/controllers/LookAtController","awayjs-core/lib/geom/MathConsts":undefined,"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-display/lib/controllers/LookAtController":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/geom/Vector3D");var n=t("../controllers/ControllerBase");var a=t("../events/DisplayObjectEvent");var o=function(t){r(e,t);function e(e,i){var r=this;if(e===void 0){e=null}if(i===void 0){i=null}t.call(this,e);this._pOrigin=new s.Vector3D(0,0,0);this._onLookAtObjectChangedDelegate=function(t){return r.onLookAtObjectChanged(t)};if(i)this.lookAtObject=i;else this.lookAtPosition=new s.Vector3D}Object.defineProperty(e.prototype,"lookAtPosition",{get:function(){return this._pLookAtPosition},set:function(t){if(this._pLookAtObject){this._pLookAtObject.removeEventListener(a.DisplayObjectEvent.SCENETRANSFORM_CHANGED,this._onLookAtObjectChangedDelegate);this._pLookAtObject=null}this._pLookAtPosition=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lookAtObject",{get:function(){return this._pLookAtObject},set:function(t){if(this._pLookAtPosition)this._pLookAtPosition=null;if(this._pLookAtObject==t)return;if(this._pLookAtObject)this._pLookAtObject.removeEventListener(a.DisplayObjectEvent.SCENETRANSFORM_CHANGED,this._onLookAtObjectChangedDelegate);this._pLookAtObject=t;if(this._pLookAtObject)this._pLookAtObject.addEventListener(a.DisplayObjectEvent.SCENETRANSFORM_CHANGED,this._onLookAtObjectChangedDelegate);this.pNotifyUpdate()},enumerable:true,configurable:true});e.prototype.update=function(t){if(t===void 0){t=true}if(this._pTargetObject){if(this._pLookAtPosition)this._pTargetObject.lookAt(this._pLookAtPosition);else if(this._pLookAtObject)this._pTargetObject.lookAt(this._pLookAtObject.scene?this._pLookAtObject.scenePosition:this._pLookAtObject.transform.position)}};e.prototype.onLookAtObjectChanged=function(t){this.pNotifyUpdate()};return e}(n.ControllerBase);i.LookAtController=o},{"../controllers/ControllerBase":"awayjs-display/lib/controllers/ControllerBase","../events/DisplayObjectEvent":"awayjs-display/lib/events/DisplayObjectEvent","awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-display/lib/controllers/SpringController":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/geom/Vector3D");var n=t("../controllers/LookAtController");var a=function(t){r(e,t);function e(e,i,r,n,a){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=1}if(n===void 0){n=40}if(a===void 0){a=4}t.call(this,e,i);this.positionOffset=new s.Vector3D(0,500,-1e3);this.stiffness=r;this.damping=a;this.mass=n;this._velocity=new s.Vector3D;this._dv=new s.Vector3D;this._stretch=new s.Vector3D;this._force=new s.Vector3D;this._acceleration=new s.Vector3D;this._desiredPosition=new s.Vector3D}e.prototype.update=function(e){if(e===void 0){e=true}var i;if(!this._pLookAtObject||!this._pTargetObject)return;this._pControllerDirty=true;i=this._pLookAtObject.transform.matrix3D.deltaTransformVector(this.positionOffset);this._desiredPosition.x=this._pLookAtObject.x+i.x;this._desiredPosition.y=this._pLookAtObject.y+i.y;this._desiredPosition.z=this._pLookAtObject.z+i.z;this._stretch=this._pTargetObject.transform.position.add(this._desiredPosition);this._stretch.scaleBy(-this.stiffness);this._dv.copyFrom(this._velocity);this._dv.scaleBy(this.damping);this._force.x=this._stretch.x-this._dv.x;this._force.y=this._stretch.y-this._dv.y;this._force.z=this._stretch.z-this._dv.z;this._acceleration.copyFrom(this._force);this._acceleration.scaleBy(1/this.mass);this._velocity.incrementBy(this._acceleration);var r=this._pTargetObject.transform.position.add(this._velocity);this._pTargetObject.transform.moveTo(r.x,r.y,r.z);t.prototype.update.call(this)};return e}(n.LookAtController);i.SpringController=a},{"../controllers/LookAtController":"awayjs-display/lib/controllers/LookAtController","awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-display/lib/controllers":[function(t,e,i){"use strict";var r=t("./controllers/ControllerBase");i.ControllerBase=r.ControllerBase;var s=t("./controllers/FirstPersonController");i.FirstPersonController=s.FirstPersonController;var n=t("./controllers/FollowController");i.FollowController=n.FollowController;var a=t("./controllers/HoverController");i.HoverController=a.HoverController;var o=t("./controllers/LookAtController");i.LookAtController=o.LookAtController;var l=t("./controllers/SpringController");i.SpringController=l.SpringController},{"./controllers/ControllerBase":"awayjs-display/lib/controllers/ControllerBase","./controllers/FirstPersonController":"awayjs-display/lib/controllers/FirstPersonController","./controllers/FollowController":"awayjs-display/lib/controllers/FollowController","./controllers/HoverController":"awayjs-display/lib/controllers/HoverController","./controllers/LookAtController":"awayjs-display/lib/controllers/LookAtController","./controllers/SpringController":"awayjs-display/lib/controllers/SpringController"}],"awayjs-display/lib/display/Billboard":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/geom/Rectangle");var n=t("../display/DisplayObject");var a=t("../bounds/BoundsType");var o=t("../events/RenderableEvent");var l=t("../events/SurfaceEvent");var h=t("../managers/DefaultMaterialManager");var p=t("../events/StyleEvent");var u=function(t){r(e,t);function e(e,i,r){var s=this;if(i===void 0){i="auto"}if(r===void 0){r=false}t.call(this);this._pIsEntity=true;this.onInvalidateTextureDelegate=function(t){return s.onInvalidateTexture(t)};this._onInvalidatePropertiesDelegate=function(t){return s._onInvalidateProperties(t)};this.material=e;this._updateDimensions();this._boundsType=a.BoundsType.AXIS_ALIGNED_BOX}Object.defineProperty(e.prototype,"animator",{get:function(){return this._animator},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"billboardRect",{get:function(){return this._billboardRect},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"billboardHeight",{get:function(){return this._billboardHeight},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"billboardWidth",{get:function(){return this._billboardWidth},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"material",{get:function(){return this._material},set:function(t){if(t==this._material)return;if(this._material){this._material.iRemoveOwner(this);this._material.removeEventListener(l.SurfaceEvent.INVALIDATE_TEXTURE,this.onInvalidateTextureDelegate)}this._material=t;if(this._material){this._material.iAddOwner(this);this._material.addEventListener(l.SurfaceEvent.INVALIDATE_TEXTURE,this.onInvalidateTextureDelegate);
}},enumerable:true,configurable:true});e.prototype._pUpdateBoxBounds=function(){t.prototype._pUpdateBoxBounds.call(this);this._pBoxBounds.width=this._billboardRect.width;this._pBoxBounds.height=this._billboardRect.height};e.prototype.clone=function(){var t=new e(this.material);return t};Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){if(this._style==t)return;if(this._style)this._style.removeEventListener(p.StyleEvent.INVALIDATE_PROPERTIES,this._onInvalidatePropertiesDelegate);this._style=t;if(this._style)this._style.addEventListener(p.StyleEvent.INVALIDATE_PROPERTIES,this._onInvalidatePropertiesDelegate);this._onInvalidateProperties()},enumerable:true,configurable:true});e.prototype._iTestCollision=function(t,e){return e.testBillboardCollision(this,this.material,t)};e.prototype.onInvalidateTexture=function(t){this._updateDimensions()};e.prototype._acceptTraverser=function(t){t.applyRenderable(this)};e.prototype._updateDimensions=function(){var t=this.material.getTextureAt(0);var e=t?(this._style?this._style.getImageAt(t):null)||(this.material.style?this.material.style.getImageAt(t):null)||t.getImageAt(0):null;if(e){var i=(this._style?this._style.getSamplerAt(t):null)||(this.material.style?this.material.style.getSamplerAt(t):null)||t.getSamplerAt(0)||h.DefaultMaterialManager.getDefaultSampler();if(i.imageRect){this._billboardWidth=i.imageRect.width*e.width;this._billboardHeight=i.imageRect.height*e.height}else{this._billboardWidth=e.rect.width;this._billboardHeight=e.rect.height}this._billboardRect=i.frameRect||new s.Rectangle(0,0,this._billboardWidth,this._billboardHeight)}else{this._billboardWidth=1;this._billboardHeight=1;this._billboardRect=new s.Rectangle(0,0,1,1)}this._pInvalidateBounds();this.invalidateElements()};e.prototype.invalidateElements=function(){this.dispatchEvent(new o.RenderableEvent(o.RenderableEvent.INVALIDATE_ELEMENTS,this))};e.prototype.invalidateSurface=function(){this.dispatchEvent(new o.RenderableEvent(o.RenderableEvent.INVALIDATE_SURFACE,this))};e.prototype._onInvalidateProperties=function(t){if(t===void 0){t=null}this.invalidateSurface();this._updateDimensions()};e.assetType="[asset Billboard]";return e}(n.DisplayObject);i.Billboard=u},{"../bounds/BoundsType":"awayjs-display/lib/bounds/BoundsType","../display/DisplayObject":"awayjs-display/lib/display/DisplayObject","../events/RenderableEvent":"awayjs-display/lib/events/RenderableEvent","../events/StyleEvent":"awayjs-display/lib/events/StyleEvent","../events/SurfaceEvent":"awayjs-display/lib/events/SurfaceEvent","../managers/DefaultMaterialManager":"awayjs-display/lib/managers/DefaultMaterialManager","awayjs-core/lib/geom/Rectangle":undefined}],"awayjs-display/lib/display/Camera":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/geom/Matrix3D");var n=t("awayjs-core/lib/geom/Plane3D");var a=t("awayjs-core/lib/events/ProjectionEvent");var o=t("awayjs-core/lib/projections/PerspectiveProjection");var l=t("../base/HierarchicalProperties");var h=t("../bounds/BoundsType");var p=t("../display/DisplayObjectContainer");var u=t("../events/CameraEvent");var c=function(t){r(e,t);function e(e){var i=this;if(e===void 0){e=null}t.call(this);this._viewProjection=new s.Matrix3D;this._viewProjectionDirty=true;this._frustumPlanesDirty=true;this._pIsEntity=true;this._onProjectionMatrixChangedDelegate=function(t){return i.onProjectionMatrixChanged(t)};this._projection=e||new o.PerspectiveProjection;this._projection.addEventListener(a.ProjectionEvent.MATRIX_CHANGED,this._onProjectionMatrixChangedDelegate);this._frustumPlanes=[];for(var r=0;r<6;++r)this._frustumPlanes[r]=new n.Plane3D;this.z=-1e3;this._boundsType=h.BoundsType.NULL}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.onProjectionMatrixChanged=function(t){this._viewProjectionDirty=true;this._frustumPlanesDirty=true;this.dispatchEvent(t)};Object.defineProperty(e.prototype,"frustumPlanes",{get:function(){if(this._frustumPlanesDirty)this.updateFrustum();return this._frustumPlanes},enumerable:true,configurable:true});e.prototype.updateFrustum=function(){var t,e,i;var r,s,n,a;var o,l,h,p;var u,c,f,d;var _,y,v,m;var b;var g=this.viewProjection.rawData;var w;r=g[0];s=g[4];n=g[8];a=g[12];o=g[1];l=g[5];h=g[9];p=g[13];u=g[2];c=g[6];f=g[10];d=g[14];_=g[3];y=g[7];v=g[11];m=g[15];b=this._frustumPlanes[0];t=_+r;e=y+s;i=v+n;w=1/Math.sqrt(t*t+e*e+i*i);b.a=t*w;b.b=e*w;b.c=i*w;b.d=-(m+a)*w;b=this._frustumPlanes[1];t=_-r;e=y-s;i=v-n;w=1/Math.sqrt(t*t+e*e+i*i);b.a=t*w;b.b=e*w;b.c=i*w;b.d=(a-m)*w;b=this._frustumPlanes[2];t=_+o;e=y+l;i=v+h;w=1/Math.sqrt(t*t+e*e+i*i);b.a=t*w;b.b=e*w;b.c=i*w;b.d=-(m+p)*w;b=this._frustumPlanes[3];t=_-o;e=y-l;i=v-h;w=1/Math.sqrt(t*t+e*e+i*i);b.a=t*w;b.b=e*w;b.c=i*w;b.d=(p-m)*w;b=this._frustumPlanes[4];t=u;e=c;i=f;w=1/Math.sqrt(t*t+e*e+i*i);b.a=t*w;b.b=e*w;b.c=i*w;b.d=-d*w;b=this._frustumPlanes[5];t=_-u;e=y-c;i=v-f;w=1/Math.sqrt(t*t+e*e+i*i);b.a=t*w;b.b=e*w;b.c=i*w;b.d=(d-m)*w;this._frustumPlanesDirty=false};e.prototype.pInvalidateHierarchicalProperties=function(e){if(t.prototype.pInvalidateHierarchicalProperties.call(this,e))return true;if(this._hierarchicalPropsDirty&l.HierarchicalProperties.SCENE_TRANSFORM){this._viewProjectionDirty=true;this._frustumPlanesDirty=true}return false};Object.defineProperty(e.prototype,"projection",{get:function(){return this._projection},set:function(t){if(this._projection==t)return;if(!t)throw new Error("Projection cannot be null!");this._projection.removeEventListener(a.ProjectionEvent.MATRIX_CHANGED,this._onProjectionMatrixChangedDelegate);this._projection=t;this._projection.addEventListener(a.ProjectionEvent.MATRIX_CHANGED,this._onProjectionMatrixChangedDelegate);this.dispatchEvent(new u.CameraEvent(u.CameraEvent.PROJECTION_CHANGED,this))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"viewProjection",{get:function(){if(this._viewProjectionDirty){this._viewProjection.copyFrom(this.inverseSceneTransform);this._viewProjection.append(this._projection.matrix);this._viewProjectionDirty=false}return this._viewProjection},enumerable:true,configurable:true});e.prototype.getRay=function(t,e,i){return this.sceneTransform.deltaTransformVector(this._projection.unproject(t,e,i))};e.prototype.project=function(t){return this._projection.project(this.inverseSceneTransform.transformVector(t))};e.prototype.unproject=function(t,e,i){return this.sceneTransform.transformVector(this._projection.unproject(t,e,i))};e.prototype._applyRenderer=function(t){if(this._iSourcePrefab)this._iSourcePrefab._iValidate()};e.assetType="[asset Camera]";return e}(p.DisplayObjectContainer);i.Camera=c},{"../base/HierarchicalProperties":"awayjs-display/lib/base/HierarchicalProperties","../bounds/BoundsType":"awayjs-display/lib/bounds/BoundsType","../display/DisplayObjectContainer":"awayjs-display/lib/display/DisplayObjectContainer","../events/CameraEvent":"awayjs-display/lib/events/CameraEvent","awayjs-core/lib/events/ProjectionEvent":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Plane3D":undefined,"awayjs-core/lib/projections/PerspectiveProjection":undefined}],"awayjs-display/lib/display/DirectionalLight":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/geom/Matrix3DUtils");var n=t("awayjs-core/lib/geom/Matrix3D");var a=t("awayjs-core/lib/geom/Vector3D");var o=t("../display/LightBase");var l=t("../base/HierarchicalProperties");var h=t("../bounds/BoundsType");var p=t("../materials/shadowmappers/DirectionalShadowMapper");var u=function(t){r(e,t);function e(e,i,r){if(e===void 0){e=0}if(i===void 0){i=-1}if(r===void 0){r=1}t.call(this);this._pAabbPoints=new Array(24);this._pIsEntity=true;this.direction=new a.Vector3D(e,i,r);this._sceneDirection=new a.Vector3D;this._boundsType=h.BoundsType.NULL}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"sceneDirection",{get:function(){if(this._hierarchicalPropsDirty&l.HierarchicalProperties.SCENE_TRANSFORM)this.pUpdateSceneTransform();return this._sceneDirection},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"direction",{get:function(){return this._direction},set:function(t){this._direction=t;if(!this._tmpLookAt)this._tmpLookAt=new a.Vector3D;this._tmpLookAt.x=this.x+this._direction.x;this._tmpLookAt.y=this.y+this._direction.y;this._tmpLookAt.z=this.z+this._direction.z;this.lookAt(this._tmpLookAt)},enumerable:true,configurable:true});e.prototype.pUpdateSceneTransform=function(){t.prototype.pUpdateSceneTransform.call(this);this.sceneTransform.copyColumnTo(2,this._sceneDirection);this._sceneDirection.normalize()};e.prototype.pCreateShadowMapper=function(){return new p.DirectionalShadowMapper};e.prototype.iGetObjectProjectionMatrix=function(t,e,i){if(i===void 0){i=null}var r=s.Matrix3DUtils.RAW_DATA_CONTAINER;var a=new n.Matrix3D;a.copyFrom(t.getRenderSceneTransform(e));a.append(this.inverseSceneTransform);if(!this._projAABBPoints)this._projAABBPoints=[];a.transformVectors(this._pAabbPoints,this._projAABBPoints);var o=Infinity,l=-Infinity;var h=Infinity,p=-Infinity;var u=Infinity,c=-Infinity;var f;for(var d=0;d<24;){f=this._projAABBPoints[d++];if(f<o)o=f;if(f>l)l=f;f=this._projAABBPoints[d++];if(f<h)h=f;if(f>p)p=f;f=this._projAABBPoints[d++];if(f<u)u=f;if(f>c)c=f}var _=1/(l-o);var y=1/(p-h);var v=1/(c-u);r[0]=2*_;r[5]=2*y;r[10]=v;r[12]=-(l+o)*_;r[13]=-(p+h)*y;r[14]=-u*v;r[1]=r[2]=r[3]=r[4]=r[6]=r[7]=r[8]=r[9]=r[11]=0;r[15]=1;if(!i)i=new n.Matrix3D;i.copyRawDataFrom(r);i.prepend(a);return i};e.prototype._pUpdateBoxBounds=function(){t.prototype._pUpdateBoxBounds.call(this);var e=this._pBoxBounds.x;var i=this._pBoxBounds.y-this._pBoxBounds.height;var r=this._pBoxBounds.z;var s=this._pBoxBounds.x+this._pBoxBounds.width;var n=this._pBoxBounds.y;var a=this._pBoxBounds.z+this._pBoxBounds.depth;this._pAabbPoints[0]=e;this._pAabbPoints[1]=i;this._pAabbPoints[2]=r;this._pAabbPoints[3]=s;this._pAabbPoints[4]=i;this._pAabbPoints[5]=r;this._pAabbPoints[6]=e;this._pAabbPoints[7]=n;this._pAabbPoints[8]=r;this._pAabbPoints[9]=s;this._pAabbPoints[10]=n;this._pAabbPoints[11]=r;this._pAabbPoints[12]=e;this._pAabbPoints[13]=i;this._pAabbPoints[14]=a;this._pAabbPoints[15]=s;this._pAabbPoints[16]=i;this._pAabbPoints[17]=a;this._pAabbPoints[18]=e;this._pAabbPoints[19]=n;this._pAabbPoints[20]=a;this._pAabbPoints[21]=s;this._pAabbPoints[22]=n;this._pAabbPoints[23]=a};e.assetType="[light DirectionalLight]";return e}(o.LightBase);i.DirectionalLight=u},{"../base/HierarchicalProperties":"awayjs-display/lib/base/HierarchicalProperties","../bounds/BoundsType":"awayjs-display/lib/bounds/BoundsType","../display/LightBase":"awayjs-display/lib/display/LightBase","../materials/shadowmappers/DirectionalShadowMapper":"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper","awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-display/lib/display/DisplayObjectContainer":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/errors/ArgumentError");var n=t("awayjs-core/lib/errors/RangeError");var a=t("../display/DisplayObject");var o=t("../base/HierarchicalProperties");var l=function(t){r(e,t);function e(){t.call(this);this._mouseChildren=true;this._depth_childs={};this._nextHighestDepth=0;this._children=new Array}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mouseChildren",{get:function(){if(this._hierarchicalPropsDirty&o.HierarchicalProperties.MOUSE_ENABLED)this._updateMouseEnabled();return this._mouseChildren},set:function(t){if(this._mouseChildren==t)return;this._mouseChildren=t;this.pInvalidateHierarchicalProperties(o.HierarchicalProperties.MOUSE_ENABLED)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numChildren",{get:function(){return this._children.length},enumerable:true,configurable:true});e.prototype.addChild=function(t){return this.addChildAt(t,this._children.length)};e.prototype.addChildAtDepth=function(t,e,i){if(i===void 0){i=true}if(t==null)throw new s.ArgumentError("Parameter child cannot be null.");if(t._pParent)t._pParent.removeChildAtInternal(t._pParent.getChildIndex(t));var r=this.getDepthIndexInternal(e);if(r!=-1){if(i){this.removeChildAt(r)}else{this.addChildAtDepth(this._children[r],e+1,false)}}if(this._nextHighestDepth<e+1)this._nextHighestDepth=e+1;this._depth_childs[e]=t;this._children.push(t);t._depthID=e;t.iSetParent(this);this._invalidateChildren();return t};e.prototype.addChildAt=function(t,e){return this.addChildAtDepth(t,e<this._children.length?this._children[e]._depthID:this.getNextHighestDepth(),false)};e.prototype.addChildren=function(){var t=[];for(var e=0;e<arguments.length;e++){t[e-0]=arguments[e]}var i=t.length;for(var r=0;r<i;r++)this.addChild(t[r])};e.prototype.clone=function(){var t=new e;this.copyTo(t);return t};e.prototype.copyTo=function(e){t.prototype.copyTo.call(this,e);e.mouseChildren=this._mouseChildren;var i=this._children.length;for(var r=0;r<i;++r)e.addChild(this._children[r].clone())};e.prototype.contains=function(t){return this._children.indexOf(t)>=0};e.prototype.disposeValues=function(){for(var e=this._children.length-1;e>=0;e--)this.removeChild(this._children[e]);t.prototype.disposeValues.call(this)};e.prototype.getChildAtDepth=function(t){return this._depth_childs[t]};e.prototype.getChildAt=function(t){var e=this._children[t];if(e==null)throw new n.RangeError("Index does not exist in the child list of the caller");return e};e.prototype.getChildByName=function(t){var e=this._children.length;for(var i=0;i<e;++i)if(this._children[i].name==t)return this._children[i];return null};e.prototype.getChildIndex=function(t){var e=this._children.indexOf(t);if(e==-1)throw new s.ArgumentError("Child parameter is not a child of the caller");return e};e.prototype.getNextHighestDepth=function(){if(this._nextHighestDepthDirty)this._updateNextHighestDepth();return this._nextHighestDepth};e.prototype.getObjectsUnderPoint=function(t){return new Array};e.prototype.removeChild=function(t){if(t==null)throw new s.ArgumentError("Parameter child cannot be null");this.removeChildAt(this.getChildIndex(t));return t};e.prototype.removeChildAtDepth=function(t){return this.removeChildAt(this.getDepthIndexInternal(t))};e.prototype.removeChildAt=function(t){var e=this.removeChildAtInternal(t);e.iSetParent(null);this._invalidateChildren();return e};e.prototype.removeChildren=function(t,e){if(t===void 0){t=0}if(e===void 0){e=2147483647}if(t<0)throw new n.RangeError("beginIndex is out of range of the child list");if(e>this._children.length)throw new n.RangeError("endIndex is out of range of the child list");for(var i=t;i<e;i++)this.removeChild(this._children[i])};e.prototype.setChildIndex=function(t,e){};e.prototype.swapChildren=function(t,e){this.swapChildrenAt(this.getChildIndex(t),this.getChildIndex(e))};e.prototype.swapChildrenAt=function(t,e){var i=this._children[e]._depthID;var r=this._children[t];this.addChildAtDepth(this._children[e],this._children[t]._depthID);this.addChildAtDepth(r,i)};e.prototype._pUpdateBoxBounds=function(){t.prototype._pUpdateBoxBounds.call(this);var e;var i=this._children.length;if(i>0){var r;var s;var n,a,o;var l,h,p;for(var u=0;u<i;++u){e=this._children[u].getBox(this);if(u==0){l=e.width+(n=e.x);h=e.height+(a=e.y);p=e.depth+(o=e.z)}else{s=e.width+(r=e.x);if(r<n)n=r;if(s>l)l=s;s=e.height+(r=e.y);if(r<a)a=r;if(s>h)h=s;s=e.depth+(r=e.z);if(r<o)o=r;if(s>p)p=s}}this._pBoxBounds.width=l-(this._pBoxBounds.x=n);this._pBoxBounds.height=h-(this._pBoxBounds.y=a);this._pBoxBounds.depth=p-(this._pBoxBounds.z=o)}else{this._pBoxBounds.setBoundIdentity()}};e.prototype.pInvalidateHierarchicalProperties=function(e){if(t.prototype.pInvalidateHierarchicalProperties.call(this,e))return true;var i=this._children.length;for(var r=0;r<i;++r)this._children[r].pInvalidateHierarchicalProperties(e);return false};e.prototype._iSetScene=function(e,i){t.prototype._iSetScene.call(this,e,i);var r=this._children.length;for(var s=0;s<r;++s)this._children[s]._iSetScene(e,i)};e.prototype.removeChildAtInternal=function(t){var e=this._children.splice(t,1)[0];if(this._nextHighestDepth==e._depthID+1)this._nextHighestDepthDirty=true;delete this._depth_childs[e._depthID];e._depthID=-16384;return e};e.prototype.getDepthIndexInternal=function(t){if(!this._depth_childs[t])return-1;return this._children.indexOf(this._depth_childs[t])};e.prototype._updateNextHighestDepth=function(){this._nextHighestDepthDirty=false;this._nextHighestDepth=0;var t=this._children.length;for(var e=0;e<t;e++)if(this._nextHighestDepth<this._children[e]._depthID)this._nextHighestDepth=this._children[e]._depthID;this._nextHighestDepth+=1};e.prototype._hitTestPointInternal=function(t,e,i,r){var s=this._children.length;for(var n=0;n<s;n++)if(this._children[n].hitTestPoint(t,e,i,r))return true;return false};e.prototype._updateMaskMode=function(){if(this.maskMode)this.mouseChildren=false;t.prototype._updateMaskMode.call(this)};e.prototype._invalidateChildren=function(){if(this._pIsContainer!=Boolean(this._children.length)){if(this._pImplicitPartition)this._pImplicitPartition._iUnregisterEntity(this);this._pIsContainer=Boolean(this._children.length);if(this._pImplicitPartition)this._pImplicitPartition._iRegisterEntity(this)}this._pInvalidateBounds()};e.assetType="[asset DisplayObjectContainer]";return e}(a.DisplayObject);i.DisplayObjectContainer=l},{"../base/HierarchicalProperties":"awayjs-display/lib/base/HierarchicalProperties","../display/DisplayObject":"awayjs-display/lib/display/DisplayObject","awayjs-core/lib/errors/ArgumentError":undefined,"awayjs-core/lib/errors/RangeError":undefined}],"awayjs-display/lib/display/DisplayObject":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/geom/Box");var n=t("awayjs-core/lib/geom/ColorTransform");var a=t("awayjs-core/lib/geom/Sphere");var o=t("awayjs-core/lib/geom/MathConsts");var l=t("awayjs-core/lib/geom/Matrix3D");var h=t("awayjs-core/lib/geom/Matrix3DUtils");var p=t("awayjs-core/lib/geom/Point");var u=t("awayjs-core/lib/geom/Vector3D");var c=t("awayjs-core/lib/library/AssetBase");var f=t("../base/HierarchicalProperties");var d=t("../bounds/BoundsType");var _=t("../base/AlignmentMode");var y=t("../base/OrientationMode");var v=t("../base/Transform");var m=t("../pick/PickingCollision");var b=t("../events/DisplayObjectEvent");var g=t("../events/TransformEvent");var w=function(t){r(e,t);function e(){var e=this;t.call(this);this._queuedEvents=new Array;this._boxBoundsInvalid=true;this._sphereBoundsInvalid=true;this._pSceneTransform=new l.Matrix3D;this._pIsEntity=false;this._pIsContainer=false;this._sessionID=-1;this._depthID=-16384;this._inverseSceneTransform=new l.Matrix3D;this._scenePosition=new u.Vector3D;this._explicitVisibility=true;this._explicitMaskId=-1;this._pImplicitVisibility=true;this._pImplicitMaskId=-1;this._pImplicitMaskIds=new Array;this._explicitMouseEnabled=true;this._pImplicitMouseEnabled=true;this._orientationMatrix=new l.Matrix3D;this._inheritColorTransform=false;this._maskMode=false;this._tempVector3D=new u.Vector3D;this.alignmentMode=_.AlignmentMode.REGISTRATION_POINT;this.castsShadows=true;this.orientationMode=y.OrientationMode.DEFAULT;this.zOffset=0;this._transform=new v.Transform;this._transform.addEventListener(g.TransformEvent.INVALIDATE_MATRIX3D,function(t){return e._onInvalidateMatrix3D(t)});this._transform.addEventListener(g.TransformEvent.INVALIDATE_COLOR_TRANSFORM,function(t){return e._onInvalidateColorTransform(t)});this._boundsType=d.BoundsType.AXIS_ALIGNED_BOX}Object.defineProperty(e.prototype,"adapter",{get:function(){return this._adapter},set:function(t){this._adapter=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"inheritColorTransform",{get:function(){return this._inheritColorTransform},set:function(t){if(this._inheritColorTransform==t)return;this._inheritColorTransform=t;this.pInvalidateHierarchicalProperties(f.HierarchicalProperties.COLOR_TRANSFORM)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alpha",{get:function(){return this._transform.colorTransform?this._transform.colorTransform.alphaMultiplier:1},set:function(t){if(!this._transform.colorTransform)this._transform.colorTransform=new n.ColorTransform;this._transform.colorTransform.alphaMultiplier=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"boundsType",{get:function(){return this._boundsType},set:function(t){if(this._boundsType==t)return;this._boundsType=t;this.invalidate();this._pInvalidateBounds()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"depth",{get:function(){return this.getBox().depth*this.scaleZ},set:function(t){if(this._depth==t)return;this._depth=t;this._setScaleZ(t/this.getBox().depth)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"eulers",{get:function(){if(!this._eulers)this._eulers=new u.Vector3D;this._eulers.x=this.rotationX;this._eulers.y=this.rotationY;this._eulers.z=this.rotationZ;return this._eulers},set:function(t){this.rotationX=t.x;this.rotationY=t.y;this.rotationZ=t.z},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this.getBox().height*this.scaleY},set:function(t){if(this._height==t)return;this._height=t;this._setScaleY(t/this.getBox().height)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"index",{get:function(){if(this._pParent)return this._pParent.getChildIndex(this);return 0},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"inverseSceneTransform",{get:function(){if(this._inverseSceneTransformDirty){this._inverseSceneTransform.copyFrom(this.sceneTransform);this._inverseSceneTransform.invert();this._inverseSceneTransformDirty=false}return this._inverseSceneTransform},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"isEntity",{get:function(){return this._pIsEntity},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"isContainer",{get:function(){return this._pIsContainer},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"loaderInfo",{get:function(){return this._loaderInfo},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"maskMode",{get:function(){return this._maskMode},set:function(t){if(this._maskMode==t)return;this._maskMode=t;this._explicitMaskId=t?this.id:-1;this._updateMaskMode()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mouseEnabled",{get:function(){return this._explicitMouseEnabled},set:function(t){if(this._explicitMouseEnabled==t)return;this._explicitMouseEnabled=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mouseX",{get:function(){return this._mouseX},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mouseY",{get:function(){return this._mouseY},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"name",{get:function(){return this._pName},set:function(t){this._pName=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"parent",{get:function(){return this._pParent},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"partition",{get:function(){return this._explicitPartition},set:function(t){if(this._explicitPartition==t)return;this._explicitPartition=t;this._iSetScene(this._pScene,this._pParent?this._pParent._iAssignedPartition:null);this.dispatchEvent(new b.DisplayObjectEvent(b.DisplayObjectEvent.PARTITION_CHANGED,this))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"pivot",{get:function(){return this._pivot},set:function(t){if(this._pivot&&this._pivot.x==t.x&&this._pivot.y==t.y&&this._pivot.z==t.z)return;if(!t){this._pivot=null;this._pivotScale=null}else{if(!this._pivot)this._pivot=new u.Vector3D;this._pivot.x=t.x;this._pivot.y=t.y;this._pivot.z=t.z}this.pInvalidateHierarchicalProperties(f.HierarchicalProperties.SCENE_TRANSFORM)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"rotationX",{get:function(){return this._transform.rotation.x*o.MathConsts.RADIANS_TO_DEGREES},set:function(t){if(this.rotationX==t)return;this._transform.rotation.x=t*o.MathConsts.DEGREES_TO_RADIANS;this._transform.invalidateMatrix3D()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"rotationY",{get:function(){return this._transform.rotation.y*o.MathConsts.RADIANS_TO_DEGREES},set:function(t){if(this.rotationY==t)return;this._transform.rotation.y=t*o.MathConsts.DEGREES_TO_RADIANS;this._transform.invalidateMatrix3D()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"rotationZ",{get:function(){return this._transform.rotation.z*o.MathConsts.RADIANS_TO_DEGREES},set:function(t){if(this.rotationZ==t)return;this._transform.rotation.z=t*o.MathConsts.DEGREES_TO_RADIANS;this._transform.invalidateMatrix3D()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scaleX",{get:function(){return this._transform.scale.x},set:function(t){this._width=null;this._setScaleX(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scaleY",{get:function(){return this._transform.scale.y},set:function(t){this._height=null;this._setScaleY(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scaleZ",{get:function(){return this._transform.scale.z},set:function(t){this._depth=null;this._setScaleZ(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"skewX",{get:function(){return this._transform.skew.x},set:function(t){if(this.skewX==t)return;this._transform.skew.x=t;this._transform.invalidateMatrix3D()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"skewY",{get:function(){return this._transform.skew.y},set:function(t){if(this.skewY==t)return;this._transform.skew.y=t;this._transform.invalidateMatrix3D()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"skewZ",{get:function(){return this._transform.skew.z},set:function(t){if(this.skewZ==t)return;this._transform.skew.z=t;this._transform.invalidateMatrix3D()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scene",{get:function(){return this._pScene},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scenePosition",{get:function(){if(this._scenePositionDirty){if(this._pivot&&this.alignmentMode==_.AlignmentMode.PIVOT_POINT){this._scenePosition=this.sceneTransform.transformVector(this._pivotScale)}else{this.sceneTransform.copyColumnTo(3,this._scenePosition)}this._scenePositionDirty=false}return this._scenePosition},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"sceneTransform",{get:function(){if(this._hierarchicalPropsDirty&f.HierarchicalProperties.SCENE_TRANSFORM)this.pUpdateSceneTransform();return this._pSceneTransform},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"shaderPickingDetails",{get:function(){return this._shaderPickingDetails},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"debugVisible",{get:function(){return this._debugVisible},set:function(t){if(t==this._debugVisible)return;this._debugVisible=t;this.invalidate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"transform",{get:function(){return this._transform},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"visible",{get:function(){return this._explicitVisibility},set:function(t){if(this._explicitVisibility==t)return;this._explicitVisibility=t;this.pInvalidateHierarchicalProperties(f.HierarchicalProperties.VISIBLE)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"masks",{get:function(){return this._explicitMasks},set:function(t){if(this._explicitMasks==t)return;this._explicitMasks=t;if(t!=null&&t.length){var e=t.length;for(var i=0;i<e;i++)t[i].maskMode=true}this.pInvalidateHierarchicalProperties(f.HierarchicalProperties.MASKS)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"width",{get:function(){return this.getBox().width*this.scaleX},set:function(t){if(this._width==t)return;this._width=t;this._setScaleX(t/this.getBox().width)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"x",{get:function(){return this._transform.position.x},set:function(t){if(this._transform.position.x==t)return;this._transform.matrix3D.rawData[12]=t;this._transform.invalidatePosition()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"y",{get:function(){return this._transform.position.y},set:function(t){if(this._transform.position.y==t)return;this._transform.matrix3D.rawData[13]=t;this._transform.invalidatePosition()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"z",{get:function(){return this._transform.position.z},set:function(t){if(this._transform.position.z==t)return;this._transform.matrix3D.rawData[14]=t;this._transform.invalidatePosition()},enumerable:true,configurable:true});e.prototype.addEventListener=function(e,i){t.prototype.addEventListener.call(this,e,i);switch(e){case b.DisplayObjectEvent.SCENE_CHANGED:this._listenToSceneChanged=true;break;case b.DisplayObjectEvent.SCENETRANSFORM_CHANGED:this._listenToSceneTransformChanged=true;break}};e.prototype.clone=function(){var t=new e;this.copyTo(t);return t};e.prototype.copyTo=function(t){t.partition=this._explicitPartition;t.boundsType=this._boundsType;t.pivot=this._pivot;t.name=this._pName;t.mouseEnabled=this._explicitMouseEnabled;t.extra=this.extra;t.maskMode=this._maskMode;t.castsShadows=this.castsShadows;if(this._explicitMasks)t.masks=this._explicitMasks;if(this._adapter)t.adapter=this._adapter.clone(t);t._transform.matrix3D=this._transform.matrix3D;if(this._transform.colorTransform)t.transform.colorTransform=this._transform.colorTransform.clone()};e.prototype.dispose=function(){this.disposeValues()};e.prototype.disposeValues=function(){if(this._pParent)this._pParent.removeChild(this);this._explicitMasks=null};e.prototype.getBounds=function(t){return this._bounds};e.prototype.getRect=function(t){if(t===void 0){t=null}return this._bounds};e.prototype.getBox=function(t){if(t===void 0){t=null}if(this._iSourcePrefab)this._iSourcePrefab._iValidate();if(this._boxBoundsInvalid){this._pUpdateBoxBounds();if(this._width!=null)this._setScaleX(this._width/this._pBoxBounds.width);if(this._height!=null)this._setScaleY(this._height/this._pBoxBounds.height);if(this._depth!=null)this._setScaleZ(this._depth/this._pBoxBounds.depth)}if(t==null||t==this)return this._pBoxBounds;if(t==this._pParent)return this._transform.matrix3D.transformBox(this._pBoxBounds);else return t.inverseSceneTransform.transformBox(this.sceneTransform.transformBox(this._pBoxBounds))};e.prototype.getSphere=function(t){if(t===void 0){t=null}if(this._iSourcePrefab)this._iSourcePrefab._iValidate();if(this._sphereBoundsInvalid)this._pUpdateSphereBounds();return this._pSphereBounds;
};e.prototype.globalToLocal=function(t,e){if(e===void 0){e=null}this._tempVector3D.setTo(t.x,t.y,0);var i=this.inverseSceneTransform.transformVector(this._tempVector3D,this._tempVector3D);if(!e)e=new p.Point;e.x=i.x;e.y=i.y;return e};e.prototype.globalToLocal3D=function(t){return this.inverseSceneTransform.transformVector(t)};e.prototype.hitTestObject=function(t){var e=t.getBox();if(!e)return false;var i=new p.Point(e.x,e.y);var r=new p.Point(e.x,e.y-e.height);var s=new p.Point(e.x+e.width,e.y);var n=new p.Point(e.x+e.width,e.y-e.height);i=this.globalToLocal(t.localToGlobal(i));r=this.globalToLocal(t.localToGlobal(r));s=this.globalToLocal(t.localToGlobal(s));n=this.globalToLocal(t.localToGlobal(n));var a=this.getBox();if(!a)return false;if(i.x<=a.left&&i.x<=a.left&&i.y<=a.top&&i.y>=a.bottom)return true;if(r.x<=a.left&&r.x<=a.left&&r.y<=a.top&&r.y>=a.bottom)return true;if(s.x<=a.left&&s.x<=a.left&&s.y<=a.top&&s.y>=a.bottom)return true;if(n.x<=a.left&&n.x<=a.left&&n.y<=a.top&&n.y>=a.bottom)return true;var o=s.y-i.y;var l=-(s.x-i.x);var h=n.y-s.y;var u=-(n.x-s.x);var c=r.y-n.y;var f=-(r.x-n.x);var d=i.y-r.y;var _=-(i.x-r.x);var y=a.left-i.x;var v=a.top-i.y;var m=a.left-s.x;var b=a.top-s.y;var g=a.left-n.x;var w=a.top-n.y;var P=a.left-r.x;var x=a.top-r.y;var j=o*y+l*v;var E=h*m+u*b;var T=c*g+f*w;var A=d*P+_*x;if(j<0&&E<0&&T<0&&A<0)return true;y=a.right-i.x;v=a.top-i.y;m=a.right-s.x;b=a.top-s.y;g=a.right-n.x;w=a.top-n.y;P=a.right-r.x;x=a.top-r.y;j=o*y+l*v;E=h*m+u*b;T=c*g+f*w;A=d*P+_*x;if(j<0&&E<0&&T<0&&A<0)return true;y=a.left-i.x;v=a.bottom-i.y;m=a.left-s.x;b=a.bottom-s.y;g=a.left-n.x;w=a.bottom-n.y;P=a.left-r.x;x=a.bottom-r.y;j=o*y+l*v;E=h*m+u*b;T=c*g+f*w;A=d*P+_*x;if(j<0&&E<0&&T<0&&A<0)return true;y=a.right-i.x;v=a.bottom-i.y;m=a.right-s.x;b=a.bottom-s.y;g=a.right-n.x;w=a.bottom-n.y;P=a.right-r.x;x=a.bottom-r.y;j=o*y+l*v;E=h*m+u*b;T=c*g+f*w;A=d*P+_*x;if(j<0&&E<0&&T<0&&A<0)return true;return false};e.prototype.hitTestPoint=function(t,e,i,r){if(i===void 0){i=false}if(r===void 0){r=false}if(!this._pImplicitVisibility)return;if(this._pImplicitMaskId!=-1&&!r)return;if(this._explicitMasks){var s=this._explicitMasks.length;var n=false;for(var a=0;a<s;a++){if(this._explicitMasks[a].hitTestPoint(t,e,i,true)){n=true;break}}if(!n)return false}return this._hitTestPointInternal(t,e,i,r)};e.prototype.lookAt=function(t,e){if(e===void 0){e=null}var i;var r;var s;var n;if(e==null)e=u.Vector3D.Y_AXIS;else e.normalize();r=t.subtract(this._transform.position);r.normalize();s=e.crossProduct(r);s.normalize();if(s.length<.05){s.x=e.y;s.y=e.x;s.z=0;s.normalize()}i=r.crossProduct(s);n=h.Matrix3DUtils.RAW_DATA_CONTAINER;n[0]=s.x;n[1]=s.y;n[2]=s.z;n[3]=0;n[4]=i.x;n[5]=i.y;n[6]=i.z;n[7]=0;n[8]=r.x;n[9]=r.y;n[10]=r.z;n[11]=0;var a=new l.Matrix3D;a.copyRawDataFrom(n);var p=a.decompose()[1];this.rotationX=p.x*o.MathConsts.RADIANS_TO_DEGREES;this.rotationY=p.y*o.MathConsts.RADIANS_TO_DEGREES;this.rotationZ=p.z*o.MathConsts.RADIANS_TO_DEGREES};e.prototype.localToGlobal=function(t,e){if(e===void 0){e=null}this._tempVector3D.setTo(t.x,t.y,0);var i=this.sceneTransform.transformVector(this._tempVector3D,this._tempVector3D);if(!e)e=new p.Point;e.x=i.x;e.y=i.y;return e};e.prototype.localToGlobal3D=function(t){return this.sceneTransform.transformVector(t)};e.prototype.movePivot=function(t,e,i){if(t==0&&e==0&&i==0)return;this._pivot.x+=t;this._pivot.y+=e;this._pivot.z+=i;this.pInvalidateHierarchicalProperties(f.HierarchicalProperties.SCENE_TRANSFORM)};e.prototype.reset=function(){this.visible=true;if(this._transform.matrix3D)this._transform.clearMatrix3D();if(this._transform.colorTransform)this._transform.clearColorTransform();this.masks=null;this.maskMode=false};e.prototype.getRenderSceneTransform=function(t){if(this.orientationMode==y.OrientationMode.CAMERA_PLANE){var e=t.decompose();var i=e[3];e[0].copyFrom(this.scenePosition);i.x=this.scaleX;i.y=this.scaleY;i.z=this.scaleZ;this._orientationMatrix.recompose(e);if(this._pivot&&this.alignmentMode==_.AlignmentMode.PIVOT_POINT)this._orientationMatrix.prependTranslation(-this._pivot.x/this.scaleX,-this._pivot.y/this.scaleY,-this._pivot.z/this.scaleZ);return this._orientationMatrix}return this.sceneTransform};e.prototype.removeEventListener=function(e,i){t.prototype.removeEventListener.call(this,e,i);if(this.hasEventListener(e))return;switch(e){case b.DisplayObjectEvent.SCENE_CHANGED:this._listenToSceneChanged=false;break;case b.DisplayObjectEvent.SCENETRANSFORM_CHANGED:this._listenToSceneTransformChanged=true;break}};Object.defineProperty(e.prototype,"_iAssignedPartition",{get:function(){return this._pImplicitPartition},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_iPickingCollision",{get:function(){if(!this._pickingCollision)this._pickingCollision=new m.PickingCollision(this);return this._pickingCollision},enumerable:true,configurable:true});e.prototype.iSetParent=function(t){this._pParent=t;if(t)this._iSetScene(t._pScene,t._iAssignedPartition);else this._iSetScene(null,null);this.pInvalidateHierarchicalProperties(f.HierarchicalProperties.ALL)};e.prototype.pInvalidateHierarchicalProperties=function(t){var e=(this._hierarchicalPropsDirty^t)&t;if(!e)return true;this._hierarchicalPropsDirty|=t;if(e&f.HierarchicalProperties.SCENE_TRANSFORM){this._inverseSceneTransformDirty=true;this._scenePositionDirty=true;if(this.isEntity)this.invalidatePartitionBounds();if(this._pParent)this._pParent._pInvalidateBounds();if(this._listenToSceneTransformChanged)this.queueDispatch(this._sceneTransformChanged||(this._sceneTransformChanged=new b.DisplayObjectEvent(b.DisplayObjectEvent.SCENETRANSFORM_CHANGED,this)))}return false};e.prototype._iSetScene=function(t,e){var i=this._pScene!=t;if(this._pScene&&this._pImplicitPartition){this._pScene._iUnregisterPartition(this._pImplicitPartition);this._pImplicitPartition._iUnregisterEntity(this);this.clear()}this._pImplicitPartition=this._explicitPartition||e;if(i)this._pScene=t;if(this._pScene&&this._pImplicitPartition){this._pScene._iRegisterPartition(this._pImplicitPartition);this._pImplicitPartition._iRegisterEntity(this)}if(i&&this._listenToSceneChanged)this.queueDispatch(this._sceneChanged||(this._sceneChanged=new b.DisplayObjectEvent(b.DisplayObjectEvent.SCENE_CHANGED,this)))};e.prototype.pUpdateSceneTransform=function(){if(this._iController)this._iController.updateController();this._pSceneTransform.copyFrom(this._transform.matrix3D);if(this._pivot){if(!this._pivotScale)this._pivotScale=new u.Vector3D;this._pivotScale.x=this._pivot.x/this._transform.scale.x;this._pivotScale.y=this._pivot.y/this._transform.scale.y;this._pivotScale.z=this._pivot.z/this._transform.scale.z;this._pSceneTransform.prependTranslation(-this._pivotScale.x,-this._pivotScale.y,-this._pivotScale.z);if(this.alignmentMode!=_.AlignmentMode.PIVOT_POINT)this._pSceneTransform.appendTranslation(this._pivot.x,this._pivot.y,this._pivot.z)}if(this._pParent&&!this._pParent._iIsRoot)this._pSceneTransform.append(this._pParent.sceneTransform);this._matrix3DDirty=false;this._positionDirty=false;this._rotationDirty=false;this._skewDirty=false;this._scaleDirty=false;this._hierarchicalPropsDirty^=f.HierarchicalProperties.SCENE_TRANSFORM};e.prototype._iInternalUpdate=function(){if(this._iController)this._iController.update();var t=this._queuedEvents.length;for(var e=0;e<t;++e)this.dispatchEvent(this._queuedEvents[e]);this._queuedEvents.length=0};e.prototype._iIsVisible=function(){if(this._hierarchicalPropsDirty&f.HierarchicalProperties.VISIBLE)this._updateVisible();return this._pImplicitVisibility};e.prototype._iAssignedMaskId=function(){if(this._hierarchicalPropsDirty&f.HierarchicalProperties.MASK_ID)this._updateMaskId();return this._pImplicitMaskId};e.prototype._iAssignedMasks=function(){if(this._hierarchicalPropsDirty&f.HierarchicalProperties.MASKS)this._updateMasks();return this._pImplicitMasks};e.prototype._iMasksConfig=function(){if(this._hierarchicalPropsDirty&f.HierarchicalProperties.MASKS)this._updateMasks();return this._pImplicitMaskIds};e.prototype._iAssignedColorTransform=function(){if(this._hierarchicalPropsDirty&f.HierarchicalProperties.COLOR_TRANSFORM)this._updateColorTransform();return this._pImplicitColorTransform};e.prototype._iIsMouseEnabled=function(){if(this._hierarchicalPropsDirty&f.HierarchicalProperties.MOUSE_ENABLED)this._updateMouseEnabled();return this._pImplicitMouseEnabled&&this._explicitMouseEnabled};e.prototype._acceptTraverser=function(t){};e.prototype._onInvalidateMatrix3D=function(t){if(this._matrix3DDirty)return;this._matrix3DDirty=true;this.pInvalidateHierarchicalProperties(f.HierarchicalProperties.SCENE_TRANSFORM)};e.prototype._onInvalidateColorTransform=function(t){this.pInvalidateHierarchicalProperties(f.HierarchicalProperties.COLOR_TRANSFORM)};e.prototype._pInvalidateBounds=function(){this._boxBoundsInvalid=true;this._sphereBoundsInvalid=true;if(this.isEntity)this.invalidatePartitionBounds();if(this._pParent)this._pParent._pInvalidateBounds()};e.prototype._pUpdateBoxBounds=function(){this._boxBoundsInvalid=false;if(this._pBoxBounds==null)this._pBoxBounds=new s.Box};e.prototype._pUpdateSphereBounds=function(){this._sphereBoundsInvalid=false;if(this._pSphereBounds==null)this._pSphereBounds=new a.Sphere};e.prototype.queueDispatch=function(t){this._queuedEvents.push(t)};e.prototype._setScaleX=function(t){if(this.scaleX==t)return;this._transform.scale.x=t;this._transform.invalidateMatrix3D()};e.prototype._setScaleY=function(t){if(this.scaleY==t)return;this._transform.scale.y=t;this._transform.invalidateMatrix3D()};e.prototype._setScaleZ=function(t){if(this.scaleZ==t)return;this._transform.scale.z=t;this._transform.invalidateMatrix3D()};e.prototype._updateMouseEnabled=function(){this._pImplicitMouseEnabled=this._pParent?this._pParent.mouseChildren&&this._pParent._pImplicitMouseEnabled:true;if(this._pImplicitMouseEnabled&&this._pParent&&!this.pickingCollider)this.pickingCollider=this._pParent.pickingCollider;this._hierarchicalPropsDirty^=f.HierarchicalProperties.MOUSE_ENABLED};e.prototype._updateVisible=function(){this._pImplicitVisibility=this._pParent?this._explicitVisibility&&this._pParent._iIsVisible():this._explicitVisibility;this._hierarchicalPropsDirty^=f.HierarchicalProperties.VISIBLE};e.prototype._updateMaskId=function(){this._pImplicitMaskId=this._pParent&&this._pParent._iAssignedMaskId()!=-1?this._pParent._iAssignedMaskId():this._explicitMaskId;this._hierarchicalPropsDirty^=f.HierarchicalProperties.MASK_ID};e.prototype._updateMasks=function(){this._pImplicitMasks=this._pParent&&this._pParent._iAssignedMasks()?this._explicitMasks!=null?this._pParent._iAssignedMasks().concat([this._explicitMasks]):this._pParent._iAssignedMasks().concat():this._explicitMasks!=null?[this._explicitMasks]:null;this._pImplicitMaskIds.length=0;if(this._pImplicitMasks&&this._pImplicitMasks.length){var t=this._pImplicitMasks.length;var e;var i;var r;for(var s=0;s<t;s++){i=this._pImplicitMasks[s];e=i.length;r=new Array;for(var n=0;n<e;n++)r.push(i[n].id);this._pImplicitMaskIds.push(r)}}this._hierarchicalPropsDirty^=f.HierarchicalProperties.MASKS};e.prototype._updateColorTransform=function(){if(!this._pImplicitColorTransform)this._pImplicitColorTransform=new n.ColorTransform;if(this._inheritColorTransform&&this._pParent&&this._pParent._iAssignedColorTransform()){this._pImplicitColorTransform.copyFrom(this._pParent._iAssignedColorTransform());if(this._transform.colorTransform)this._pImplicitColorTransform.prepend(this._transform.colorTransform)}else{if(this._transform.colorTransform)this._pImplicitColorTransform.copyFrom(this._transform.colorTransform);else this._pImplicitColorTransform.clear()}this._hierarchicalPropsDirty^=f.HierarchicalProperties.COLOR_TRANSFORM};e.prototype._updateMaskMode=function(){if(this.maskMode)this.mouseEnabled=false;this.pInvalidateHierarchicalProperties(f.HierarchicalProperties.MASK_ID)};e.prototype.clear=function(){t.prototype.clear.call(this);var e;this._pImplicitColorTransform=null;this._pImplicitMasks=null};e.prototype.invalidatePartitionBounds=function(){this.dispatchEvent(new b.DisplayObjectEvent(b.DisplayObjectEvent.INVALIDATE_PARTITION_BOUNDS,this))};e.prototype._hitTestPointInternal=function(t,e,i,r){return false};return e}(c.AssetBase);i.DisplayObject=w},{"../base/AlignmentMode":"awayjs-display/lib/base/AlignmentMode","../base/HierarchicalProperties":"awayjs-display/lib/base/HierarchicalProperties","../base/OrientationMode":"awayjs-display/lib/base/OrientationMode","../base/Transform":"awayjs-display/lib/base/Transform","../bounds/BoundsType":"awayjs-display/lib/bounds/BoundsType","../events/DisplayObjectEvent":"awayjs-display/lib/events/DisplayObjectEvent","../events/TransformEvent":"awayjs-display/lib/events/TransformEvent","../pick/PickingCollision":"awayjs-display/lib/pick/PickingCollision","awayjs-core/lib/geom/Box":undefined,"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-core/lib/geom/MathConsts":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/geom/Point":undefined,"awayjs-core/lib/geom/Sphere":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/library/AssetBase":undefined}],"awayjs-display/lib/display/IEntity":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/display/LightBase":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/errors/AbstractMethodError");var n=t("../display/DisplayObjectContainer");var a=t("../events/LightEvent");var o=function(t){r(e,t);function e(){t.call(this);this._color=16777215;this._colorR=1;this._colorG=1;this._colorB=1;this._ambientColor=16777215;this._ambient=0;this._iAmbientR=0;this._iAmbientG=0;this._iAmbientB=0;this._specular=1;this._iSpecularR=1;this._iSpecularG=1;this._iSpecularB=1;this._diffuse=1;this._iDiffuseR=1;this._iDiffuseG=1;this._iDiffuseB=1;this._shadowsEnabled=false}Object.defineProperty(e.prototype,"shadowsEnabled",{get:function(){return this._shadowsEnabled},set:function(t){if(this._shadowsEnabled==t)return;this._shadowsEnabled=t;if(t){if(this._shadowMapper==null)this._shadowMapper=this.pCreateShadowMapper();this._shadowMapper.light=this}else{this._shadowMapper.dispose();this._shadowMapper=null}this.dispatchEvent(new a.LightEvent(a.LightEvent.CASTS_SHADOW_CHANGE))},enumerable:true,configurable:true});e.prototype.pCreateShadowMapper=function(){throw new s.AbstractMethodError};Object.defineProperty(e.prototype,"specular",{get:function(){return this._specular},set:function(t){if(t<0)t=0;this._specular=t;this.updateSpecular()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"diffuse",{get:function(){return this._diffuse},set:function(t){if(t<0)t=0;this._diffuse=t;this.updateDiffuse()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t;this._colorR=(this._color>>16&255)/255;this._colorG=(this._color>>8&255)/255;this._colorB=(this._color&255)/255;this.updateDiffuse();this.updateSpecular()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"ambient",{get:function(){return this._ambient},set:function(t){if(t<0)t=0;else if(t>1)t=1;this._ambient=t;this.updateAmbient()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"ambientColor",{get:function(){return this._ambientColor},set:function(t){this._ambientColor=t;this.updateAmbient()},enumerable:true,configurable:true});e.prototype.updateAmbient=function(){this._iAmbientR=(this._ambientColor>>16&255)/255*this._ambient;this._iAmbientG=(this._ambientColor>>8&255)/255*this._ambient;this._iAmbientB=(this._ambientColor&255)/255*this._ambient};e.prototype.iGetObjectProjectionMatrix=function(t,e,i){if(i===void 0){i=null}throw new s.AbstractMethodError};e.prototype.updateSpecular=function(){this._iSpecularR=this._colorR*this._specular;this._iSpecularG=this._colorG*this._specular;this._iSpecularB=this._colorB*this._specular};e.prototype.updateDiffuse=function(){this._iDiffuseR=this._colorR*this._diffuse;this._iDiffuseG=this._colorG*this._diffuse;this._iDiffuseB=this._colorB*this._diffuse};Object.defineProperty(e.prototype,"shadowMapper",{get:function(){return this._shadowMapper},set:function(t){this._shadowMapper=t;this._shadowMapper.light=this},enumerable:true,configurable:true});return e}(n.DisplayObjectContainer);i.LightBase=o},{"../display/DisplayObjectContainer":"awayjs-display/lib/display/DisplayObjectContainer","../events/LightEvent":"awayjs-display/lib/events/LightEvent","awayjs-core/lib/errors/AbstractMethodError":undefined}],"awayjs-display/lib/display/LightProbe":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/image/SamplerCube");var n=t("awayjs-core/lib/errors/ErrorBase");var a=t("../display/LightBase");var o=t("../bounds/BoundsType");var l=function(t){r(e,t);function e(e,i){if(i===void 0){i=null}t.call(this);this.diffuseSampler=new s.SamplerCube;this.specularSampler=new s.SamplerCube;this._pIsEntity=true;this.diffuseMap=e;this.specularMap=i;this._boundsType=o.BoundsType.NULL}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.iGetObjectProjectionMatrix=function(t,e,i){if(i===void 0){i=null}throw new n.ErrorBase("Object projection matrices are not supported for LightProbe objects!")};e.assetType="[light LightProbe]";return e}(a.LightBase);i.LightProbe=l},{"../bounds/BoundsType":"awayjs-display/lib/bounds/BoundsType","../display/LightBase":"awayjs-display/lib/display/LightBase","awayjs-core/lib/errors/ErrorBase":undefined,"awayjs-core/lib/image/SamplerCube":undefined}],"awayjs-display/lib/display/LineSegment":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../display/DisplayObject");var n=t("../bounds/BoundsType");var a=t("../events/RenderableEvent");var o=t("../events/StyleEvent");var l=function(t){r(e,t);function e(e,i,r,s){var a=this;if(s===void 0){s=1}t.call(this);this._onInvalidatePropertiesDelegate=function(t){return a._onInvalidateProperties(t)};this._pIsEntity=true;this.material=e;this._startPosition=i;this._endPosition=r;this._halfThickness=s*.5;this._boundsType=n.BoundsType.AXIS_ALIGNED_BOX}Object.defineProperty(e.prototype,"animator",{get:function(){return this._animator},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"startPostion",{get:function(){return this._startPosition},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"startPosition",{set:function(t){if(this._startPosition==t)return;this._startPosition=t;this.invalidateElements()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"endPosition",{get:function(){return this._endPosition},set:function(t){if(this._endPosition==t)return;this._endPosition=t;this.invalidateElements()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"material",{get:function(){return this._material},set:function(t){if(this.material)this.material.iRemoveOwner(this);this._material=t;if(this.material)this.material.iAddOwner(this)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"thickness",{get:function(){return this._halfThickness*2},set:function(t){if(this._halfThickness==t)return;this._halfThickness=t*.5;this.invalidateElements()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){if(this._style==t)return;if(this._style)this._style.removeEventListener(o.StyleEvent.INVALIDATE_PROPERTIES,this._onInvalidatePropertiesDelegate);this._style=t;if(this._style)this._style.addEventListener(o.StyleEvent.INVALIDATE_PROPERTIES,this._onInvalidatePropertiesDelegate);this.invalidateSurface()},enumerable:true,configurable:true});e.prototype._pUpdateBoxBounds=function(){t.prototype._pUpdateBoxBounds.call(this);this._pBoxBounds.x=Math.min(this._startPosition.x,this._endPosition.x);this._pBoxBounds.y=Math.min(this._startPosition.y,this._endPosition.y);this._pBoxBounds.z=Math.min(this._startPosition.z,this._endPosition.z);this._pBoxBounds.width=Math.abs(this._startPosition.x-this._endPosition.x);this._pBoxBounds.height=Math.abs(this._startPosition.y-this._endPosition.y);this._pBoxBounds.depth=Math.abs(this._startPosition.z-this._endPosition.z)};e.prototype._pUpdateSphereBounds=function(){t.prototype._pUpdateSphereBounds.call(this);this._pUpdateBoxBounds();var e=(this._endPosition.x-this._startPosition.x)/2;var i=(this._endPosition.y-this._startPosition.y)/2;var r=(this._endPosition.z-this._startPosition.z)/2;this._pSphereBounds.x=this._startPosition.x+e;this._pSphereBounds.y=this._startPosition.y+i;this._pSphereBounds.z=this._startPosition.z+r;this._pSphereBounds.radius=Math.sqrt(e*e+i*i+r*r)};e.prototype.invalidateElements=function(){this.dispatchEvent(new a.RenderableEvent(a.RenderableEvent.INVALIDATE_ELEMENTS,this))};e.prototype.invalidateSurface=function(){this.dispatchEvent(new a.RenderableEvent(a.RenderableEvent.INVALIDATE_SURFACE,this))};e.prototype._onInvalidateProperties=function(t){this.invalidateSurface()};e.prototype._iTestCollision=function(t,e){return false};e.prototype._acceptTraverser=function(t){t.applyRenderable(this)};e.assetType="[asset LineSegment]";return e}(s.DisplayObject);i.LineSegment=l},{"../bounds/BoundsType":"awayjs-display/lib/bounds/BoundsType","../display/DisplayObject":"awayjs-display/lib/display/DisplayObject","../events/RenderableEvent":"awayjs-display/lib/events/RenderableEvent","../events/StyleEvent":"awayjs-display/lib/events/StyleEvent"}],"awayjs-display/lib/display/LoaderContainer":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/library/AssetLibraryBundle");var n=t("awayjs-core/lib/library/Loader");var a=t("awayjs-core/lib/events/AssetEvent");var o=t("awayjs-core/lib/events/URLLoaderEvent");var l=t("awayjs-core/lib/events/LoaderEvent");var h=t("awayjs-core/lib/events/ParserEvent");var p=t("../display/DisplayObjectContainer");var u=function(t){r(e,t);function e(e,i){var r=this;if(e===void 0){e=true}if(i===void 0){i=null}t.call(this);this._useAssetLib=e;this._assetLibId=i;this._onAssetCompleteDelegate=function(t){return r.onAssetComplete(t)};this._onTextureSizeErrorDelegate=function(t){return r.onTextureSizeError(t)};this._onLoadCompleteDelegate=function(t){return r.onLoadComplete(t)};this._onLoadErrorDelegate=function(t){return r.onLoadError(t)};this._onParseErrorDelegate=function(t){return r.onParseError(t)}}Object.defineProperty(e.prototype,"content",{get:function(){return this._content},enumerable:true,configurable:true});e.prototype.close=function(){if(!this._loader)return;if(this._useAssetLib){var t;t=s.AssetLibraryBundle.getInstance(this._assetLibId);t.disposeLoader(this._loader)}this._disposeLoader()};e.prototype.load=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=null}this._getLoader().load(t,e,i,r)};e.prototype.loadData=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=null}this._getLoader().loadData(t,"",e,i,r)};e.prototype._getLoader=function(){if(this._useAssetLib){var t=s.AssetLibraryBundle.getInstance(this._assetLibId);this._loader=t.getLoader()}else{this._loader=new n.Loader}this._loader.addEventListener(l.LoaderEvent.LOAD_COMPLETE,this._onLoadCompleteDelegate);this._loader.addEventListener(a.AssetEvent.TEXTURE_SIZE_ERROR,this._onTextureSizeErrorDelegate);this._loader.addEventListener(a.AssetEvent.ASSET_COMPLETE,this._onAssetCompleteDelegate);this._loader._iAddErrorHandler(this._onLoadErrorDelegate);this._loader._iAddParseErrorHandler(this._onParseErrorDelegate);return this._loader};e.prototype._disposeLoader=function(){this._loader.removeEventListener(l.LoaderEvent.LOAD_COMPLETE,this._onLoadCompleteDelegate);this._loader.removeEventListener(a.AssetEvent.TEXTURE_SIZE_ERROR,this._onTextureSizeErrorDelegate);this._loader.removeEventListener(a.AssetEvent.ASSET_COMPLETE,this._onAssetCompleteDelegate);if(!this._useAssetLib)this._loader.stop();this._loader=null};e.prototype.unload=function(){};e.enableParser=function(t){n.Loader.enableParser(t)};e.enableParsers=function(t){n.Loader.enableParsers(t)};e.prototype.onAssetComplete=function(t){this.dispatchEvent(t)};e.prototype.onLoadError=function(t){if(this.hasEventListener(o.URLLoaderEvent.LOAD_ERROR)){this.dispatchEvent(t);return true}else{return false}};e.prototype.onParseError=function(t){if(this.hasEventListener(h.ParserEvent.PARSE_ERROR)){this.dispatchEvent(t);return true}else{return false}};e.prototype.onTextureSizeError=function(t){this.dispatchEvent(t)};e.prototype.onLoadComplete=function(t){this._content=t.content;if(this._content)this.addChild(this._content);this.dispatchEvent(t);this._disposeLoader()};return e}(p.DisplayObjectContainer);i.LoaderContainer=u},{"../display/DisplayObjectContainer":"awayjs-display/lib/display/DisplayObjectContainer","awayjs-core/lib/events/AssetEvent":undefined,"awayjs-core/lib/events/LoaderEvent":undefined,"awayjs-core/lib/events/ParserEvent":undefined,"awayjs-core/lib/events/URLLoaderEvent":undefined,"awayjs-core/lib/library/AssetLibraryBundle":undefined,"awayjs-core/lib/library/Loader":undefined}],"awayjs-display/lib/display/MovieClip":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/events/AssetEvent");var n=t("../display/Sprite");var a=t("../display/TextField");var o=t("../events/MouseEvent");var l=t("../base/Timeline");var h=t("../managers/FrameScriptManager");var p=function(t){r(e,t);function e(e){var i=this;if(e===void 0){e=null}t.call(this);this._isButton=false;this._time=0;this._currentFrameIndex=-1;this._isPlaying=true;this._isInit=true;this._potentialInstances=[];this._depth_sessionIDs={};this._sessionID_childs={};this.loop=true;this.constructedKeyFrameIndex=-1;this._enterFrame=new s.AssetEvent(s.AssetEvent.ENTER_FRAME,this);this.inheritColorTransform=true;this._onMouseOver=function(t){return i.currentFrameIndex=1};this._onMouseOut=function(t){return i.currentFrameIndex=0};this._onMouseDown=function(t){return i.currentFrameIndex=2};this._onMouseUp=function(t){return i.currentFrameIndex=i.currentFrameIndex==0?0:1};this._timeline=e||new l.Timeline}Object.defineProperty(e.prototype,"adapter",{get:function(){return this._adapter},set:function(t){this._adapter=t},enumerable:true,configurable:true});e.prototype.dispose=function(){this.disposeValues();e._movieClips.push(this)};e.prototype.disposeValues=function(){t.prototype.disposeValues.call(this);this._potentialInstances=[];this._depth_sessionIDs={};this._sessionID_childs={}};e.prototype.reset_textclones=function(){if(this.timeline){var t=this._potentialInstances.length;for(var i=0;i<t;i++){if(this._potentialInstances[i]!=null){if(this._potentialInstances[i].isAsset(a.TextField))this._potentialInstances[i].text=this.timeline.getPotentialChildPrototype(i).text;else if(this._potentialInstances[i].isAsset(e))this._potentialInstances[i].reset_textclones()}}}};Object.defineProperty(e.prototype,"isInit",{get:function(){return this._isInit},set:function(t){this._isInit=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"timeline",{get:function(){return this._timeline},set:function(t){this._timeline=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numFrames",{get:function(){return this._timeline.numFrames},enumerable:true,configurable:true});e.prototype.jumpToLabel=function(t){this._timeline.jumpToLabel(this,t)};e.prototype.reset=function(){t.prototype.reset.call(this);this._time=0;if(this.adapter)this.adapter.freeFromScript();this.constructedKeyFrameIndex=-1;for(var i=this.numChildren-1;i>=0;i--)this.removeChildAt(i);this._skipAdvance=e._skipAdvance;var r=this._timeline.keyframe_indices.length;this._isPlaying=Boolean(r>1);if(r){this._currentFrameIndex=0;this._timeline.constructNextFrame(this,true,true)}else{this._currentFrameIndex=-1}};e.prototype.resetSessionIDs=function(){this._depth_sessionIDs={}};Object.defineProperty(e.prototype,"currentFrameIndex",{get:function(){return this._currentFrameIndex},set:function(t){var i=false;var r=this._timeline.keyframe_indices.length;if(!r)return;if(t<0){t=0}else if(t>=r){t=r-1;i=true}if(this._currentFrameIndex==t)return;this._currentFrameIndex=t;this._skipAdvance=e._skipAdvance;this._timeline.gotoFrame(this,t,i)},enumerable:true,configurable:true});e.prototype.addButtonListeners=function(){this._isButton=true;this.stop();this.addEventListener(o.MouseEvent.MOUSE_OVER,this._onMouseOver);this.addEventListener(o.MouseEvent.MOUSE_OUT,this._onMouseOut);this.addEventListener(o.MouseEvent.MOUSE_DOWN,this._onMouseDown);this.addEventListener(o.MouseEvent.MOUSE_UP,this._onMouseUp)};e.prototype.removeButtonListeners=function(){this.removeEventListener(o.MouseEvent.MOUSE_OVER,this._onMouseOver);this.removeEventListener(o.MouseEvent.MOUSE_OUT,this._onMouseOut);this.removeEventListener(o.MouseEvent.MOUSE_DOWN,this._onMouseDown);this.removeEventListener(o.MouseEvent.MOUSE_UP,this._onMouseUp)};e.prototype.getChildAtSessionID=function(t){return this._sessionID_childs[t]};e.prototype.getSessionIDDepths=function(){return this._depth_sessionIDs};e.prototype.addChildAtDepth=function(e,i,r){if(r===void 0){r=true}e.inheritColorTransform=true;e.reset();return t.prototype.addChildAtDepth.call(this,e,i,r)};e.prototype._addTimelineChildAt=function(t,e,i){this._depth_sessionIDs[e]=t._sessionID=i;this._sessionID_childs[i]=t;return this.addChildAtDepth(t,e)};e.prototype.removeChildAtInternal=function(e){var i=this._children[e];if(i.adapter)i.adapter.freeFromScript();this.adapter.unregisterScriptObject(i);if(this._depth_sessionIDs[i._depthID]==i._sessionID)delete this._depth_sessionIDs[i._depthID];delete this._sessionID_childs[i._sessionID];i._sessionID=-1;return t.prototype.removeChildAtInternal.call(this,e)};Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.play=function(){if(this._timeline.keyframe_indices.length>1)this._isPlaying=true};e.prototype.update=function(){e._skipAdvance=true;this.advanceFrame();e._skipAdvance=false;h.FrameScriptManager.execute_queue();this.dispatchEvent(this._enterFrame);h.FrameScriptManager.execute_queue();h.FrameScriptManager.execute_intervals();h.FrameScriptManager.execute_queue();h.FrameScriptManager.execute_dispose()};e.prototype.getPotentialChildInstance=function(t){if(!this._potentialInstances[t])this._potentialInstances[t]=this._timeline.getPotentialChildInstance(t);return this._potentialInstances[t]};e.prototype.stop=function(){this._isPlaying=false};e.prototype.clone=function(){var t=e._movieClips.length?e._movieClips.pop():new e(this._timeline);this.copyTo(t);return t};e.prototype.copyTo=function(e){t.prototype.copyTo.call(this,e);e.timeline=this._timeline;e.loop=this.loop};e.prototype.advanceFrame=function(){if(this._isPlaying&&!this._skipAdvance){if(this._currentFrameIndex==this._timeline.keyframe_indices.length-1){if(this.loop)this.currentFrameIndex=0;else this._isPlaying=false}else{this._currentFrameIndex++;
this._timeline.constructNextFrame(this)}}var t=this._children.length;var i;for(var r=0;r<t;++r){i=this._children[r];if(i.isAsset(e))i.advanceFrame()}this._skipAdvance=false};e.prototype.logHierarchy=function(t){if(t===void 0){t=0}this.printHierarchyName(t,this);var i=this._children.length;var r;for(var s=0;s<i;s++){r=this._children[s];if(r.isAsset(e))r.logHierarchy(t+1);else this.printHierarchyName(t+1,r)}};e.prototype.printHierarchyName=function(t,e){var i="";for(var r=0;r<t;++r)i+="--";i+=" "+e.name+" = "+e.id;console.log(i)};e.prototype.clear=function(){var e=this._potentialInstances.length;for(var i=0;i<e;i++){var r=this._potentialInstances[i];if(r&&r.name==""){h.FrameScriptManager.add_child_to_dispose(r);delete this._potentialInstances[i]}}t.prototype.clear.call(this)};e._movieClips=new Array;e.assetType="[asset MovieClip]";return e}(n.Sprite);i.MovieClip=p;Object.defineProperty(i,"__esModule",{value:true});i.default=p},{"../base/Timeline":"awayjs-display/lib/base/Timeline","../display/Sprite":"awayjs-display/lib/display/Sprite","../display/TextField":"awayjs-display/lib/display/TextField","../events/MouseEvent":"awayjs-display/lib/events/MouseEvent","../managers/FrameScriptManager":"awayjs-display/lib/managers/FrameScriptManager","awayjs-core/lib/events/AssetEvent":undefined}],"awayjs-display/lib/display/PointLight":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/geom/Matrix3D");var n=t("awayjs-core/lib/geom/Matrix3DUtils");var a=t("awayjs-core/lib/geom/Vector3D");var o=t("../display/LightBase");var l=t("../bounds/BoundsType");var h=t("../materials/shadowmappers/CubeMapShadowMapper");var p=function(t){r(e,t);function e(){t.call(this);this._pRadius=9e4;this._pFallOff=1e5;this._pIsEntity=true;this._pFallOffFactor=1/(this._pFallOff*this._pFallOff-this._pRadius*this._pRadius);this._boundsType=l.BoundsType.SPHERE}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.pCreateShadowMapper=function(){return new h.CubeMapShadowMapper};Object.defineProperty(e.prototype,"radius",{get:function(){return this._pRadius},set:function(t){this._pRadius=t;if(this._pRadius<0){this._pRadius=0}else if(this._pRadius>this._pFallOff){this._pFallOff=this._pRadius;this._pInvalidateBounds()}this._pFallOffFactor=1/(this._pFallOff*this._pFallOff-this._pRadius*this._pRadius)},enumerable:true,configurable:true});e.prototype.iFallOffFactor=function(){return this._pFallOffFactor};Object.defineProperty(e.prototype,"fallOff",{get:function(){return this._pFallOff},set:function(t){this._pFallOff=t;if(this._pFallOff<0)this._pFallOff=0;if(this._pFallOff<this._pRadius)this._pRadius=this._pFallOff;this._pFallOffFactor=1/(this._pFallOff*this._pFallOff-this._pRadius*this._pRadius);this._pInvalidateBounds()},enumerable:true,configurable:true});e.prototype._pUpdateSphereBounds=function(){t.prototype._pUpdateSphereBounds.call(this);this._pSphereBounds.radius=this._pFallOff};e.prototype.iGetObjectProjectionMatrix=function(t,e,i){if(i===void 0){i=null}var r=n.Matrix3DUtils.RAW_DATA_CONTAINER;var o=new s.Matrix3D;o.copyFrom(t.getRenderSceneTransform(e));o.append(this._pParent.inverseSceneTransform);this.lookAt(o.position);o.copyFrom(t.getRenderSceneTransform(e));o.append(this.inverseSceneTransform);var l=t.getBox();var h=o.deltaTransformVector(new a.Vector3D(l.left,l.bottom,l.front));var p=o.deltaTransformVector(new a.Vector3D(l.right,l.top,l.back));var u=h.x*h.x+h.y*h.y+h.z*h.z;var c=p.x*p.x+p.y*p.y+p.z*p.z;var f=Math.sqrt(u>c?u:c);var d;var _;var y=o.rawData[14];d=y-f;_=y+f;r[5]=r[0]=d/f;r[10]=_/(_-d);r[11]=1;r[1]=r[2]=r[3]=r[4]=r[6]=r[7]=r[8]=r[9]=r[12]=r[13]=r[15]=0;r[14]=-d*r[10];if(!i)i=new s.Matrix3D;i.copyRawDataFrom(r);i.prepend(o);return i};e.assetType="[light PointLight]";return e}(o.LightBase);i.PointLight=p},{"../bounds/BoundsType":"awayjs-display/lib/bounds/BoundsType","../display/LightBase":"awayjs-display/lib/display/LightBase","../materials/shadowmappers/CubeMapShadowMapper":"awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper","awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-display/lib/display/Scene":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../display/DisplayObjectContainer");var n=t("../partition/BasicPartition");var a=function(t){r(e,t);function e(e){if(e===void 0){e=null}t.call(this);this._expandedPartitions=new Array;this._partitions=new Array;this._iCollectionMark=0;this.partition=e||new n.BasicPartition;this._iIsRoot=true;this._pScene=this}e.prototype.traversePartitions=function(t){var e=0;var i=this._partitions.length;while(e<i)this._partitions[e++].traverse(t)};e.prototype._iRegisterPartition=function(t){this._expandedPartitions.push(t);if(this._partitions.indexOf(t)==-1)this._partitions.push(t)};e.prototype._iUnregisterPartition=function(t){this._expandedPartitions.splice(this._expandedPartitions.indexOf(t),1);if(this._expandedPartitions.indexOf(t)==-1)this._partitions.splice(this._partitions.indexOf(t),1)};return e}(s.DisplayObjectContainer);i.Scene=a},{"../display/DisplayObjectContainer":"awayjs-display/lib/display/DisplayObjectContainer","../partition/BasicPartition":"awayjs-display/lib/partition/BasicPartition"}],"awayjs-display/lib/display/Shape":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/events/AssetEvent");var n=t("awayjs-core/lib/geom/Point");var a=t("awayjs-core/lib/geom/Vector3D");var o=t("../display/DisplayObject");var l=t("../graphics/Graphics");var h=function(t){r(e,t);function e(e){var i=this;if(e===void 0){e=null}t.call(this);this._tempPoint=new n.Point;this._onGraphicsInvalidateDelegate=function(t){return i._onGraphicsInvalidate(t)};this._graphics=new l.Graphics;this._graphics.addEventListener(s.AssetEvent.INVALIDATE,this._onGraphicsInvalidateDelegate);this.material=e}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"graphics",{get:function(){if(this._iSourcePrefab)this._iSourcePrefab._iValidate();return this._graphics},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"animator",{get:function(){return this._graphics.animator},set:function(t){if(this._graphics.animator)this._graphics.animator.removeOwner(this);this._graphics.animator=t;if(this._graphics.animator)this._graphics.animator.addOwner(this)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"material",{get:function(){return this._graphics.material},set:function(t){this._graphics.material=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"style",{get:function(){return this._graphics.style},set:function(t){this._graphics.style=t},enumerable:true,configurable:true});e.prototype.bakeTransformations=function(){this._graphics.applyTransformation(this.transform.matrix3D);this.transform.clearMatrix3D()};e.prototype.dispose=function(){this.disposeValues();e._shapes.push(this)};e.prototype.disposeValues=function(){t.prototype.disposeValues.call(this);this._graphics.dispose()};e.prototype.clone=function(){var t=e._shapes.length?e._shapes.pop():new e;this.copyTo(t);return t};e.prototype.copyTo=function(e){t.prototype.copyTo.call(this,e);this._graphics.copyTo(e.graphics)};e.prototype._pUpdateBoxBounds=function(){t.prototype._pUpdateBoxBounds.call(this);this._pBoxBounds.union(this._graphics.getBoxBounds(),this._pBoxBounds)};e.prototype._pUpdateSphereBounds=function(){t.prototype._pUpdateSphereBounds.call(this);var e=this.getBox();if(!this._center)this._center=new a.Vector3D;this._center.x=e.x+e.width/2;this._center.y=e.y+e.height/2;this._center.z=e.z+e.depth/2;this._pSphereBounds=this._graphics.getSphereBounds(this._center,this._pSphereBounds)};e.prototype._onGraphicsInvalidate=function(t){if(this._pIsEntity!=Boolean(this._graphics.count)){if(this._pImplicitPartition)this._pImplicitPartition._iUnregisterEntity(this);this._pIsEntity=Boolean(this._graphics.count);if(this._pImplicitPartition)this._pImplicitPartition._iRegisterEntity(this)}this._pInvalidateBounds()};e.prototype._acceptTraverser=function(t){this.graphics.acceptTraverser(t)};e.prototype._hitTestPointInternal=function(t,e,i,r){if(this._graphics.count){this._tempPoint.setTo(t,e);var s=this.globalToLocal(this._tempPoint,this._tempPoint);var n;if(!(n=this.getBox()).contains(s.x,s.y,0))return false;if(!i)return true;if(this._graphics._hitTestPointInternal(s.x,s.y))return true}return false};e.prototype.clear=function(){t.prototype.clear.call(this);this._graphics.clear()};e._shapes=new Array;e.assetType="[asset Shape]";return e}(o.DisplayObject);i.Shape=h},{"../display/DisplayObject":"awayjs-display/lib/display/DisplayObject","../graphics/Graphics":"awayjs-display/lib/graphics/Graphics","awayjs-core/lib/events/AssetEvent":undefined,"awayjs-core/lib/geom/Point":undefined,"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-display/lib/display/Skybox":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/events/AssetEvent");var n=t("awayjs-core/lib/image/BlendMode");var a=t("../display/DisplayObject");var o=t("../bounds/BoundsType");var l=t("../events/RenderableEvent");var h=t("../events/SurfaceEvent");var p=t("../textures/SingleCubeTexture");var u=t("../base/Style");var c=t("../events/StyleEvent");var f=function(t){r(e,t);function e(e){var i=this;if(e===void 0){e=null}t.call(this);this._textures=new Array;this._pAlphaThreshold=0;this._pBlendMode=n.BlendMode.NORMAL;this._curves=false;this._imageRect=false;this._style=new u.Style;this._onTextureInvalidateDelegate=function(t){return i.onTextureInvalidate(t)};this._onInvalidatePropertiesDelegate=function(t){return i._onInvalidateProperties(t)};this._style.addEventListener(c.StyleEvent.INVALIDATE_PROPERTIES,this._onInvalidatePropertiesDelegate);this._pIsEntity=true;this._owners=new Array(this);this._style.image=e;this.texture=new p.SingleCubeTexture;this._boundsType=o.BoundsType.NULL}Object.defineProperty(e.prototype,"alphaThreshold",{get:function(){return this._pAlphaThreshold},set:function(t){if(t<0)t=0;else if(t>1)t=1;if(this._pAlphaThreshold==t)return;this._pAlphaThreshold=t;this.invalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"curves",{get:function(){return this._curves},set:function(t){if(this._curves==t)return;this._curves=t;this.invalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"imageRect",{get:function(){return this._imageRect},set:function(t){if(this._imageRect==t)return;this._imageRect=t;this.invalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightPicker",{get:function(){return this._pLightPicker},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"animationSet",{get:function(){return this._animationSet},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._pBlendMode},set:function(t){if(this._pBlendMode==t)return;this._pBlendMode=t;this.invalidate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"iOwners",{get:function(){return this._owners},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"animator",{get:function(){return this._animator},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){if(this._texture==t)return;if(this._texture)this.removeTexture(this._texture);this._texture=t;if(this._texture)this.addTexture(this._texture);this.invalidatePasses()},enumerable:true,configurable:true});e.prototype.getNumTextures=function(){return this._textures.length};e.prototype.getTextureAt=function(t){return this._textures[t]};Object.defineProperty(e.prototype,"style",{get:function(){return this._style},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.invalidatePasses=function(){this.dispatchEvent(new h.SurfaceEvent(h.SurfaceEvent.INVALIDATE_PASSES,this))};e.prototype.invalidateElements=function(){this.dispatchEvent(new l.RenderableEvent(l.RenderableEvent.INVALIDATE_ELEMENTS,this))};e.prototype.invalidateSurface=function(){this.dispatchEvent(new l.RenderableEvent(l.RenderableEvent.INVALIDATE_SURFACE,this))};e.prototype.addTexture=function(t){this._textures.push(t);t.addEventListener(s.AssetEvent.INVALIDATE,this._onTextureInvalidateDelegate);this.onTextureInvalidate()};e.prototype.removeTexture=function(t){this._textures.splice(this._textures.indexOf(t),1);t.removeEventListener(s.AssetEvent.INVALIDATE,this._onTextureInvalidateDelegate);this.onTextureInvalidate()};e.prototype.onTextureInvalidate=function(t){if(t===void 0){t=null}this.invalidate()};e.prototype._onInvalidateProperties=function(t){this.invalidatePasses()};e.prototype._acceptTraverser=function(t){t.applyRenderable(this)};e.prototype._iTestCollision=function(t,e){return false};e.assetType="[asset Skybox]";return e}(a.DisplayObject);i.Skybox=f},{"../base/Style":"awayjs-display/lib/base/Style","../bounds/BoundsType":"awayjs-display/lib/bounds/BoundsType","../display/DisplayObject":"awayjs-display/lib/display/DisplayObject","../events/RenderableEvent":"awayjs-display/lib/events/RenderableEvent","../events/StyleEvent":"awayjs-display/lib/events/StyleEvent","../events/SurfaceEvent":"awayjs-display/lib/events/SurfaceEvent","../textures/SingleCubeTexture":"awayjs-display/lib/textures/SingleCubeTexture","awayjs-core/lib/events/AssetEvent":undefined,"awayjs-core/lib/image/BlendMode":undefined}],"awayjs-display/lib/display/Sprite":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/events/AssetEvent");var n=t("awayjs-core/lib/geom/Point");var a=t("awayjs-core/lib/geom/Vector3D");var o=t("../graphics/Graphics");var l=t("../display/DisplayObjectContainer");var h=function(t){r(e,t);function e(e){var i=this;if(e===void 0){e=null}t.call(this);this._tempPoint=new n.Point;this._onGraphicsInvalidateDelegate=function(t){return i._onGraphicsInvalidate(t)};this._graphics=new o.Graphics;this._graphics.addEventListener(s.AssetEvent.INVALIDATE,this._onGraphicsInvalidateDelegate);this.material=e}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"graphics",{get:function(){if(this._iSourcePrefab)this._iSourcePrefab._iValidate();return this._graphics},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"animator",{get:function(){return this._graphics.animator},set:function(t){if(this._graphics.animator)this._graphics.animator.removeOwner(this);this._graphics.animator=t;if(this._graphics.animator)this._graphics.animator.addOwner(this)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"material",{get:function(){return this._graphics.material},set:function(t){this._graphics.material=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"style",{get:function(){return this._graphics.style},set:function(t){this._graphics.style=t},enumerable:true,configurable:true});e.prototype.bakeTransformations=function(){this._graphics.applyTransformation(this.transform.matrix3D);this.transform.clearMatrix3D()};e.prototype.dispose=function(){this.disposeValues();e._sprites.push(this)};e.prototype.disposeValues=function(){t.prototype.disposeValues.call(this);this._graphics.dispose()};e.prototype.clone=function(){var t=e._sprites.length?e._sprites.pop():new e;this.copyTo(t);return t};e.prototype.copyTo=function(e){t.prototype.copyTo.call(this,e);this._graphics.copyTo(e.graphics)};e.prototype._pUpdateBoxBounds=function(){t.prototype._pUpdateBoxBounds.call(this);this._pBoxBounds.union(this._graphics.getBoxBounds(),this._pBoxBounds)};e.prototype._pUpdateSphereBounds=function(){t.prototype._pUpdateSphereBounds.call(this);var e=this.getBox();if(!this._center)this._center=new a.Vector3D;this._center.x=e.x+e.width/2;this._center.y=e.y+e.height/2;this._center.z=e.z+e.depth/2;this._pSphereBounds=this._graphics.getSphereBounds(this._center,this._pSphereBounds)};e.prototype._onGraphicsInvalidate=function(t){if(this._pIsEntity!=Boolean(this._graphics.count)){if(this._pImplicitPartition)this._pImplicitPartition._iUnregisterEntity(this);this._pIsEntity=Boolean(this._graphics.count);if(this._pImplicitPartition)this._pImplicitPartition._iRegisterEntity(this)}this._pInvalidateBounds()};e.prototype._acceptTraverser=function(t){this.graphics.acceptTraverser(t)};e.prototype._hitTestPointInternal=function(e,i,r,s){if(this._graphics.count){this._tempPoint.setTo(e,i);var n=this.globalToLocal(this._tempPoint,this._tempPoint);var a;if(!(a=this.getBox()).contains(n.x,n.y,0))return false;if(!r)return true;if(this._graphics._hitTestPointInternal(n.x,n.y))return true}return t.prototype._hitTestPointInternal.call(this,e,i,r,s)};e.prototype.clear=function(){t.prototype.clear.call(this);this._graphics.clear()};e._sprites=new Array;e.assetType="[asset Sprite]";return e}(l.DisplayObjectContainer);i.Sprite=h},{"../display/DisplayObjectContainer":"awayjs-display/lib/display/DisplayObjectContainer","../graphics/Graphics":"awayjs-display/lib/graphics/Graphics","awayjs-core/lib/events/AssetEvent":undefined,"awayjs-core/lib/geom/Point":undefined,"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-display/lib/display/TextFieldMultiRender":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/attributes/AttributesView");var n=t("awayjs-core/lib/attributes/Float2Attributes");var a=t("awayjs-core/lib/attributes/Byte4Attributes");var o=t("awayjs-core/lib/geom/Matrix");var l=t("awayjs-core/lib/geom/ColorTransform");var h=t("awayjs-core/lib/image/Sampler2D");var p=t("../base/HierarchicalProperties");var u=t("../base/Style");var c=t("../text/TextFieldType");var f=t("../display/Sprite");var d=t("../graphics/TriangleElements");var _=t("../text/BitmapFontTable");var y=t("../textures/Single2DTexture");var v=t("../text/TesselatedFontTable");var m=t("../materials/BasicMaterial");var b=function(t){r(e,t);function e(){t.call(this);this._explicitFormats=new Array;this._explicitFormatsRanges=new Array;this._line_indices=new Array;this._text="";this.type=c.TextFieldType.STATIC}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.setFormatForRange=function(t,e,i){var r=0;var s=this._explicitFormats.length;var n=false;var a=new Array;var o=new Array;var l=0;for(r=0;r<s;r++){if(!n){if(this._explicitFormatsRanges[r*2]>t){n=true;a[l]=i;o[l*2]=t;o[l*2+1]=e;l++}}a[l]=this._explicitFormats[r];o[l*2]=this._explicitFormatsRanges[r*2];o[l*2+1]=this._explicitFormatsRanges[r*2+1];l++}this._explicitFormats=a;this._explicitFormatsRanges=o};e.prototype.getFormatAtChar=function(t){var e=0;var i=this._explicitFormats.length;var r=this.textFormat;for(e=0;e<i;e++){if(this._explicitFormatsRanges[e*2]<=t&&this._explicitFormatsRanges[e*2+1]>=t){r=this._explicitFormats[e]}}return r};Object.defineProperty(e.prototype,"bottomScrollV",{get:function(){return this._bottomScrollV},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"caretIndex",{get:function(){return this._caretIndex},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:true,configurable:true});e.prototype.maxScrollH=function(){return this._maxScrollH};e.prototype.maxScrollV=function(){return this._maxScrollV};Object.defineProperty(e.prototype,"numLines",{get:function(){return this._numLines},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"selectionBeginIndex",{get:function(){return this._selectionBeginIndex},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"selectionEndIndex",{get:function(){return this._selectionEndIndex},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=t.toString();if(this._text==t)return;this._text=t;this._textGraphicsDirty=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textFormat",{get:function(){return this._textFormat},set:function(t){if(this._textFormat==t)return;this._textFormat=t;this._textGraphicsDirty=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"graphics",{get:function(){if(this._textGraphicsDirty)this.reConstruct();return this._graphics},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textColor",{get:function(){return this._textColor},set:function(t){this._textColor=t;if(!this.transform.colorTransform)this.transform.colorTransform=new l.ColorTransform;this.transform.colorTransform.color=t;this.pInvalidateHierarchicalProperties(p.HierarchicalProperties.COLOR_TRANSFORM)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textInteractionMode",{get:function(){return this._textInteractionMode},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textWidth",{get:function(){return this._textWidth},set:function(t){this._textWidth=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textHeight",{get:function(){return this._textHeight},set:function(t){this._textHeight=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"isEntity",{get:function(){return true},enumerable:true,configurable:true});e.prototype.clear=function(){t.prototype.clear.call(this);if(this._textElements)this._textElements.clear()};e.prototype.dispose=function(){this.disposeValues();e._textFields.push(this)};e.prototype.disposeValues=function(){t.prototype.disposeValues.call(this);this._textFormat=null;this._textGraphic=null;if(this._textElements){this._textElements.dispose();this._textElements=null}};e.prototype.reConstruct=function(t){if(t===void 0){t=false}this._textGraphicsDirty=false;if(this._textFormat==null)return;if(this._textGraphic){this._textGraphic.dispose();this._textGraphic=null;this._textElements.clear();this._textElements.dispose();this._textElements=null}if(this._text=="")return;var e=null;var i=null;var r=this.text.toString().split("\\n");var l=this.textWidth-(4+this._textFormat.leftMargin+this._textFormat.rightMargin+this._textFormat.indent);var p=[];var c=[];var f=[];var b=[];var g=[];var w=0;var P=0;var x=0;var j=0;var E;var T=0;var A=0;var C=0;this._line_indices=[];for(j=0;j<r.length;j++){console.log("textline nr: "+j+" : "+r[j]);this._line_indices[w]=T;p[w]=[];c[w]=[];f[w]=[];b[w]=0;g[w]=0;w++;E=r[j].split(" ");for(P=0;P<E.length;P++){var D=0;var O=[];var S=[];var M=0;for(x=0;x<E[P].length;x++){i=this.getFormatAtChar(T);if(i!=e){e=i;e.font_table.initFontSize(e.size)}S[x]=e;var I=e.font_table.getLineHeight();if(I>M)M=I;A=e.font_table.getCharWidth(E[P].charCodeAt(x).toString());C+=e.font_table.getCharVertCnt(E[P].charCodeAt(x).toString());O[x]=A;D+=A;T++}if(b[w-1]+D<=l){if(b[w-1]!=0){p[w-1].push(32);c[w-1].push(e.font_table.getCharWidth("32"));f[w-1].push(e);b[w-1]+=e.font_table.getCharWidth("32")}for(x=0;x<E[P].length;x++){p[w-1].push(E[P].charCodeAt(x));c[w-1].push(O[x]);f[w-1].push(S[x]);b[w-1]+=D}if(g[w-1]<M)g[w-1]=M}else if(b[w-1]==0){for(x=0;x<E[P].length;x++){p[w-1].push(E[P].charCodeAt(x));c[w-1].push(O[x]);f[w-1].push(S[x]);b[w-1]+=D}if(g[w-1]<M)g[w-1]=M}else{p[w]=[];c[w]=[];f[w]=[];b[w]=0;g[w]=0;w++;for(x=0;x<E[P].length;x++){p[w-1].push(E[P].charCodeAt(x));c[w-1].push(O[x]);f[w-1].push(S[x]);b[w-1]+=D}if(g[w-1]<M)g[w-1]=M}}}var B=[];for(j=0;j<b.length;j++){var N=2+this._textFormat.leftMargin+this._textFormat.indent;var L=0;if(this._textFormat.align=="center"){N=2+this._textFormat.leftMargin+this._textFormat.indent+(l-b[j])/2}else if(this._textFormat.align=="justify"){}else if(this._textFormat.align=="right"){N=this._textWidth-b[j]-(2+this._textFormat.rightMargin)}B[j]=[];this.textHeight=0;for(var x=0;x<p[j].length;x++){this.textHeight+=g[j];B[j][x]=N;N+=c[j][x];if(p[j][x]==32){N+=L}}}if(this._textFormat.font_table.assetType==v.TesselatedFontTable.assetType){var R=this._textFormat.font_table;var F;var k=0;var V=0;var U=0;var G=0;var H=new Float32Array(C*3);for(j=0;j<b.length;j++){console.log("textline nr: "+j+" : "+p[j]);U+=g[j];for(var x=0;x<p[j].length;x++){var W=R.getChar(p[j][x].toString());G=R._size_multiply;if(W!=null){F=W.elements;if(F!=null){var z=new Float32Array(F.concatenatedBuffer.buffer);for(var q=0;q<F.numVertices;q++){H[k++]=z[q*3]*G+B[j][x];H[k++]=z[q*3+1]*G+U-g[j];H[k++]=z[q*3+2]}}}}}var X=new s.AttributesView(Float32Array,3);X.set(H);var Y=X.attributesBuffer;X.dispose();this._textElements=new d.TriangleElements(Y);this._textElements.setPositions(new n.Float2Attributes(Y));this._textElements.setCustomAttributes("curves",new a.Byte4Attributes(Y,false));this._textGraphic=this._graphics.addGraphic(this._textElements);this.material=this._textFormat.material;var Z=new h.Sampler2D;this.style=new u.Style;this.style.addSamplerAt(Z,this.material.getTextureAt(0));this.style.uvMatrix=new o.Matrix(0,0,0,0,this._textFormat.uv_values[0],this._textFormat.uv_values[1]);this.material.animateUVs=true}else if(this._textFormat.font_table.assetType==_.BitmapFontTable.assetType){console.log("contruct bitmap text = "+this._text);var J=this._textFormat.font_table;if(!t){var H=new Float32Array(C*7);var K=0;var U=0;for(j=0;j<b.length;j++){console.log("textline nr: "+j+" : "+p[j]);U+=g[j];for(var x=0;x<p[j].length;x++){var Q=J.getCharData(p[j][x].toString());console.log("char_data = "+Q);H[K++]=B[j][x]+Q[4];H[K++]=U-g[j]+Q[5];H[K++]=Q[0];H[K++]=Q[1];H[K++]=B[j][x]+c[j][x]+Q[4];H[K++]=U-g[j]+Q[5];H[K++]=Q[0]+Q[2];H[K++]=Q[1];H[K++]=B[j][x]+c[j][x]+Q[4];H[K++]=U;H[K++]=Q[0]+Q[2];H[K++]=Q[1]+Q[3];H[K++]=B[j][x]+c[j][x]+Q[4];H[K++]=U;H[K++]=Q[0]+Q[2];H[K++]=Q[1]+Q[3];H[K++]=B[j][x]+Q[4];H[K++]=U;H[K++]=Q[0];H[K++]=Q[1]+Q[3];H[K++]=B[j][x]+Q[4];H[K++]=U-g[j]+Q[5];H[K++]=Q[0];H[K++]=Q[1]}}var X=new s.AttributesView(Float32Array,4);X.set(H);var Y=X.attributesBuffer;X.dispose();this._textElements=new d.TriangleElements(Y);this._textElements.setPositions(new n.Float2Attributes(Y));this._textElements.setUVs(new n.Float2Attributes(Y));this._textGraphic=this._graphics.addGraphic(this._textElements);var $=new m.BasicMaterial;$.texture=new y.Single2DTexture(J.get_page());$.bothSides=true;$.alphaBlending=true;this.material=$}else{var tt=document.getElementById("myCanvas");if(tt==null){tt=document.createElement("canvas");tt.id="myCanvas";document.body.appendChild(tt)}var et=tt.getContext("2d");et.canvas.width=window.innerWidth;et.canvas.height=window.innerHeight;et.rect(0,0,this.textWidth,this.textHeight);et.fillStyle="black";et.fill();var U=0;for(j=0;j<b.length;j++){console.log("textline nr: "+j+" : "+p[j]);U+=g[j];for(var x=0;x<p[j].length;x++){var Q=J.getCharDataCanvas(p[j][x].toString());et.drawImage(J.get_page().getCanvas(),Q[0],Q[1],Q[2],Q[3],B[j][x]+Q[4],U-g[j]+Q[5],c[j][x],g[j]-Q[5])}}}}};e.prototype.appendText=function(t){this._text+=t};e.prototype.closeParagraph=function(){};e.prototype.getCharBoundaries=function(t){return this._charBoundaries};e.prototype.getCharIndexAtPoint=function(t,e){return this._charIndexAtPoint};e.prototype.getFirstCharInParagraph=function(t){return this._firstCharInParagraph};e.prototype.getImageReference=function(t){return this._imageReference};e.prototype.getLineIndexAtPoint=function(t,e){return this._lineIndexAtPoint};e.prototype.getLineIndexOfChar=function(t){return this._lineIndexOfChar};e.prototype.getLineLength=function(t){return this._lineLength};e.prototype.getLineMetrics=function(t){return this._lineMetrics};e.prototype.getLineOffset=function(t){return this._lineOffset};e.prototype.getLineText=function(t){return this._lineText};e.prototype.getParagraphLength=function(t){return this._paragraphLength};e.prototype.getTextFormat=function(t,e){if(t===void 0){t=-1}if(e===void 0){e=-1}return this._textFormat};e.prototype.replaceSelectedText=function(t){};e.prototype.replaceText=function(t,e,i){};e.prototype.setSelection=function(t,e){};e.prototype.setTextFormat=function(t,e,i){if(e===void 0){e=-1}if(i===void 0){i=-1}};e.isFontCompatible=function(t,e){return false};e.prototype.clone=function(){var t=e._textFields.length?e._textFields.pop():new e;this.copyTo(t);return t};e.prototype.copyTo=function(e){t.prototype.copyTo.call(this,e);e.textWidth=this._textWidth;e.textHeight=this._textHeight;e.textFormat=this._textFormat;e.text=this._text};e._textFields=new Array;e.assetType="[asset TextFieldMultiRender]";return e}(f.Sprite);i.TextFieldMultiRender=b},{"../base/HierarchicalProperties":"awayjs-display/lib/base/HierarchicalProperties","../base/Style":"awayjs-display/lib/base/Style","../display/Sprite":"awayjs-display/lib/display/Sprite","../graphics/TriangleElements":"awayjs-display/lib/graphics/TriangleElements","../materials/BasicMaterial":"awayjs-display/lib/materials/BasicMaterial","../text/BitmapFontTable":"awayjs-display/lib/text/BitmapFontTable","../text/TesselatedFontTable":"awayjs-display/lib/text/TesselatedFontTable","../text/TextFieldType":"awayjs-display/lib/text/TextFieldType","../textures/Single2DTexture":"awayjs-display/lib/textures/Single2DTexture","awayjs-core/lib/attributes/AttributesView":undefined,"awayjs-core/lib/attributes/Byte4Attributes":undefined,"awayjs-core/lib/attributes/Float2Attributes":undefined,"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-core/lib/geom/Matrix":undefined,"awayjs-core/lib/image/Sampler2D":undefined}],"awayjs-display/lib/display/TextField":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/attributes/AttributesView");var n=t("awayjs-core/lib/attributes/Float2Attributes");var a=t("awayjs-core/lib/attributes/Byte4Attributes");var o=t("awayjs-core/lib/geom/Matrix");var l=t("awayjs-core/lib/geom/ColorTransform");var h=t("awayjs-core/lib/image/Sampler2D");var p=t("../base/HierarchicalProperties");var u=t("../base/Style");var c=t("../text/TextFieldType");var f=t("../display/Sprite");var d=t("../graphics/TriangleElements");var _=function(t){r(e,t);function e(){t.call(this);this._text="";this.type=c.TextFieldType.STATIC}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bottomScrollV",{get:function(){return this._bottomScrollV},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"caretIndex",{get:function(){return this._caretIndex},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:true,configurable:true});e.prototype.maxScrollH=function(){return this._maxScrollH;
};e.prototype.maxScrollV=function(){return this._maxScrollV};Object.defineProperty(e.prototype,"numLines",{get:function(){return this._numLines},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"selectionBeginIndex",{get:function(){return this._selectionBeginIndex},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"selectionEndIndex",{get:function(){return this._selectionEndIndex},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=t.toString();if(this._text==t)return;this._text=t;this._textGraphicsDirty=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textFormat",{get:function(){return this._textFormat},set:function(t){if(this._textFormat==t)return;this._textFormat=t;this._textGraphicsDirty=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"graphics",{get:function(){if(this._textGraphicsDirty)this.reConstruct();return this._graphics},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textColor",{get:function(){return this._textColor},set:function(t){this._textColor=t;if(!this.transform.colorTransform)this.transform.colorTransform=new l.ColorTransform;this.transform.colorTransform.color=t;this.pInvalidateHierarchicalProperties(p.HierarchicalProperties.COLOR_TRANSFORM)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textInteractionMode",{get:function(){return this._textInteractionMode},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textWidth",{get:function(){return this._textWidth},set:function(t){this._textWidth=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textHeight",{get:function(){return this._textHeight},set:function(t){this._textHeight=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"isEntity",{get:function(){return true},enumerable:true,configurable:true});e.prototype.clear=function(){t.prototype.clear.call(this);if(this._textElements)this._textElements.clear()};e.prototype.dispose=function(){this.disposeValues();e._textFields.push(this)};e.prototype.disposeValues=function(){t.prototype.disposeValues.call(this);this._textFormat=null;this._textGraphic=null;if(this._textElements){this._textElements.dispose();this._textElements=null}};e.prototype.reConstruct=function(){this._textGraphicsDirty=false;if(this._textFormat==null)return;if(this._textGraphic){this._textGraphic.dispose();this._textGraphic=null;this._textElements.clear();this._textElements.dispose();this._textElements=null}if(this._text=="")return;var t=0;var e;var i=this._textFormat.font_table;var r=null;if(this._textFormat.fallback_font_table)r=this._textFormat.fallback_font_table;var l=this._textFormat.size/i.get_font_em_size();var p=0;var c=null;var f=0;var _=0;var y=i.get_whitespace_width()*l+this._textFormat.letterSpacing;var v=this.text.toString().split("\\n");var m=[];var b=[];var g=[];var w=[];var P=[];var x=this.textWidth-(4+this._textFormat.leftMargin+this._textFormat.rightMargin+this._textFormat.indent);for(var j=0;j<v.length;j++){m.push([]);b.push([]);g.push(0);P.push(0);w.push(false);var E=v[j].split(" ");for(var T=0;T<E.length;T++){var A=0;var C=[];var D=[];var O=0;for(var S=0;S<E[T].length;S++){l=this._textFormat.size/i.get_font_em_size();var M=i.getChar(E[T].charCodeAt(S).toString());if(M==null){if(r){l=this._textFormat.size/r.get_font_em_size();M=r.getChar(E[T].charCodeAt(S).toString())}}if(M!=null){e=M.elements;if(e!=null){t+=e.numVertices;var I=0;if(c!=null){for(var _=0;_<c.kerningCharCodes.length;_++){if(c.kerningCharCodes[_]==E[T].charCodeAt(S)){I=c.kerningValues[_];break}}}A+=(2+M.char_width+I)*l+this._textFormat.letterSpacing}else{A+=y}}else{A+=y}D[O]=l;C[O++]=M}if(g[g.length-1]+A<=x||m[m.length-1].length==0){for(var B=0;B<D.length;B++){m[m.length-1].push(C[B]);b[b.length-1].push(D[B])}g[g.length-1]+=A}else{if(m[m.length-1][m[m.length-1].length-1]==null){m[m.length-1].pop();b[b.length-1].pop();g[g.length-1]-=y;P[P.length-1]-=1}w[w.length-1]=true;m.push([]);b.push([]);g.push(0);P.push(0);w.push(false);for(var B=0;B<D.length;B++){m[m.length-1].push(C[B]);b[b.length-1].push(D[B])}g[g.length-1]=A}if(T<E.length-1){if(g[g.length-1]<=x){m[m.length-1].push(null);b[b.length-1].push(l);g[g.length-1]+=y;P[P.length-1]+=1}}}}p=2+(i.ascent-i.get_font_em_size())*l;var N=new Float32Array(t*3);for(var T=0;T<m.length;T++){var L=2+this._textFormat.leftMargin+this._textFormat.indent;var R=0;if(this._textFormat.align=="center"){L=2+this._textFormat.leftMargin+this._textFormat.indent+(x-g[T])/2}else if(this._textFormat.align=="justify"){if(w[T]){R=(x-g[T])/P[T]}}else if(this._textFormat.align=="right"){L=this._textWidth-g[T]-(2+this._textFormat.rightMargin)}for(var F=0;F<m[T].length;F++){var M=m[T][F];l=b[T][F];if(M!=null){e=M.elements;if(e!=null){var k=new Float32Array(e.concatenatedBuffer.buffer);for(var V=0;V<e.numVertices;V++){N[f++]=k[V*3]*l+L;N[f++]=k[V*3+1]*l+p;N[f++]=k[V*3+2]}var I=0;if(c!=null){for(var _=0;_<c.kerningCharCodes.length;_++){if(c.kerningCharCodes[_]==this._text.charCodeAt(T)){I=c.kerningValues[_];break}}}L+=(M.char_width+I)*l+this._textFormat.letterSpacing}else{L+=y+R}}else{L+=y+R}}p+=(i.ascent+i.descent)*l;p+=this._textFormat.leading}var U=new s.AttributesView(Float32Array,3);U.set(N);var G=U.attributesBuffer;U.dispose();this._textElements=new d.TriangleElements(G);this._textElements.setPositions(new n.Float2Attributes(G));this._textElements.setCustomAttributes("curves",new a.Byte4Attributes(G,false));this._textGraphic=this._graphics.addGraphic(this._textElements);this.material=this._textFormat.material;var H=new h.Sampler2D;this.style=new u.Style;this.style.addSamplerAt(H,this.material.getTextureAt(0));this.style.uvMatrix=new o.Matrix(0,0,0,0,this._textFormat.uv_values[0],this._textFormat.uv_values[1]);this.material.animateUVs=true};e.prototype.appendText=function(t){this._text+=t};e.prototype.closeParagraph=function(){};e.prototype.getCharBoundaries=function(t){return this._charBoundaries};e.prototype.getCharIndexAtPoint=function(t,e){return this._charIndexAtPoint};e.prototype.getFirstCharInParagraph=function(t){return this._firstCharInParagraph};e.prototype.getImageReference=function(t){return this._imageReference};e.prototype.getLineIndexAtPoint=function(t,e){return this._lineIndexAtPoint};e.prototype.getLineIndexOfChar=function(t){return this._lineIndexOfChar};e.prototype.getLineLength=function(t){return this._lineLength};e.prototype.getLineMetrics=function(t){return this._lineMetrics};e.prototype.getLineOffset=function(t){return this._lineOffset};e.prototype.getLineText=function(t){return this._lineText};e.prototype.getParagraphLength=function(t){return this._paragraphLength};e.prototype.getTextFormat=function(t,e){if(t===void 0){t=-1}if(e===void 0){e=-1}return this._textFormat};e.prototype.replaceSelectedText=function(t){};e.prototype.replaceText=function(t,e,i){};e.prototype.setSelection=function(t,e){};e.prototype.setTextFormat=function(t,e,i){if(e===void 0){e=-1}if(i===void 0){i=-1}};e.isFontCompatible=function(t,e){return false};e.prototype.clone=function(){var t=e._textFields.length?e._textFields.pop():new e;this.copyTo(t);return t};e.prototype.copyTo=function(e){t.prototype.copyTo.call(this,e);e.textWidth=this._textWidth;e.textHeight=this._textHeight;e.textFormat=this._textFormat;e.text=this._text};e._textFields=new Array;e.assetType="[asset TextField]";return e}(f.Sprite);i.TextField=_},{"../base/HierarchicalProperties":"awayjs-display/lib/base/HierarchicalProperties","../base/Style":"awayjs-display/lib/base/Style","../display/Sprite":"awayjs-display/lib/display/Sprite","../graphics/TriangleElements":"awayjs-display/lib/graphics/TriangleElements","../text/TextFieldType":"awayjs-display/lib/text/TextFieldType","awayjs-core/lib/attributes/AttributesView":undefined,"awayjs-core/lib/attributes/Byte4Attributes":undefined,"awayjs-core/lib/attributes/Float2Attributes":undefined,"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-core/lib/geom/Matrix":undefined,"awayjs-core/lib/image/Sampler2D":undefined}],"awayjs-display/lib/display":[function(t,e,i){"use strict";var r=t("./display/Billboard");i.Billboard=r.Billboard;var s=t("./display/Camera");i.Camera=s.Camera;var n=t("./display/DirectionalLight");i.DirectionalLight=n.DirectionalLight;var a=t("./display/DisplayObject");i.DisplayObject=a.DisplayObject;var o=t("./display/DisplayObjectContainer");i.DisplayObjectContainer=o.DisplayObjectContainer;var l=t("./display/LightBase");i.LightBase=l.LightBase;var h=t("./display/LightProbe");i.LightProbe=h.LightProbe;var p=t("./display/LineSegment");i.LineSegment=p.LineSegment;var u=t("./display/LoaderContainer");i.LoaderContainer=u.LoaderContainer;var c=t("./display/MovieClip");i.MovieClip=c.MovieClip;var f=t("./display/PointLight");i.PointLight=f.PointLight;var d=t("./display/Scene");i.Scene=d.Scene;var _=t("./display/Shape");i.Shape=_.Shape;var y=t("./display/Skybox");i.Skybox=y.Skybox;var v=t("./display/Sprite");i.Sprite=v.Sprite;var m=t("./display/TextField");i.TextField=m.TextField;var b=t("./display/TextFieldMultiRender");i.TextFieldMultiRender=b.TextFieldMultiRender},{"./display/Billboard":"awayjs-display/lib/display/Billboard","./display/Camera":"awayjs-display/lib/display/Camera","./display/DirectionalLight":"awayjs-display/lib/display/DirectionalLight","./display/DisplayObject":"awayjs-display/lib/display/DisplayObject","./display/DisplayObjectContainer":"awayjs-display/lib/display/DisplayObjectContainer","./display/LightBase":"awayjs-display/lib/display/LightBase","./display/LightProbe":"awayjs-display/lib/display/LightProbe","./display/LineSegment":"awayjs-display/lib/display/LineSegment","./display/LoaderContainer":"awayjs-display/lib/display/LoaderContainer","./display/MovieClip":"awayjs-display/lib/display/MovieClip","./display/PointLight":"awayjs-display/lib/display/PointLight","./display/Scene":"awayjs-display/lib/display/Scene","./display/Shape":"awayjs-display/lib/display/Shape","./display/Skybox":"awayjs-display/lib/display/Skybox","./display/Sprite":"awayjs-display/lib/display/Sprite","./display/TextField":"awayjs-display/lib/display/TextField","./display/TextFieldMultiRender":"awayjs-display/lib/display/TextFieldMultiRender"}],"awayjs-display/lib/draw/CapsStyle":[function(t,e,i){"use strict";var r=function(){function t(){}t.ROUND=1;t.NONE=0;t.SQUARE=2;return t}();i.CapsStyle=r},{}],"awayjs-display/lib/draw/GradientType":[function(t,e,i){"use strict";var r=function(){function t(){}t.LINEAR="linear";t.RADIAL="radial";return t}();i.GradientType=r},{}],"awayjs-display/lib/draw/GraphicsFactoryFills":[function(t,e,i){"use strict";var r=t("../draw/GraphicsPathCommand");var s=t("../managers/DefaultMaterialManager");var n=t("awayjs-core/lib/geom/Point");var a=t("awayjs-core/lib/attributes/AttributesView");var o=t("awayjs-core/lib/attributes/Float3Attributes");var l=t("awayjs-core/lib/attributes/Float2Attributes");var h=t("awayjs-core/lib/geom/MathConsts");var p=t("../draw/GraphicsFactoryHelper");var u=t("../graphics/TriangleElements");var c=function(){function t(){}t.draw_pathes=function(t){var e=t.queued_fill_pathes.length;var i=0;for(i=0;i<e;i++){var c=t.queued_fill_pathes[i];var f=c.commands;var d=c.data;var _;var y;var v=0;var m=0;var b=0;var g=0;var w=0;var P=[[]];var x=[];var j=0;var E=new n.Point;var T=new n.Point;var A=new n.Point;for(m=0;m<f.length;m++){P.push([]);b=0;g=0;_=f[m];y=d[m];w=0;var C=0;var D=0;var O=0;var S=0;var M=0;var I=new n.Point;if(y[0]!=y[y.length-2]||y[1]!=y[y.length-1]){y[y.length]==y[0];y[y.length]==y[1]}E.x=y[0];E.y=y[1];if(_[1]==r.GraphicsPathCommand.LINE_TO){T.x=y[2]-E.x;T.y=y[3]-E.y}else if(_[1]==r.GraphicsPathCommand.CURVE_TO){T.x=y[4]-E.x;T.y=y[5]-E.y}g=2;T.normalize();M=Math.atan2(T.y,T.x)*h.MathConsts.RADIANS_TO_DEGREES;for(v=1;v<_.length;v++){A=new n.Point(y[g++],y[g++]);if(_[v]==r.GraphicsPathCommand.MOVE_TO){console.log("ERROR ! ONLY THE FIRST COMMAND FOR A CONTOUR IS ALLOWED TO BE A 'MOVE_TO' COMMAND")}else if(_[v]==r.GraphicsPathCommand.CURVE_TO){A=new n.Point(y[g++],y[g++])}I.x=A.x-E.x;I.y=A.y-E.y;I.normalize();C=Math.atan2(I.y,I.x)*h.MathConsts.RADIANS_TO_DEGREES;S=C-M;if(S>180){S-=360}if(S<-180){S+=360}w+=S;M=C;E.x=A.x;E.y=A.y}E.x=y[0];E.y=y[1];g=2;P[P.length-1][b++]=E.x;P[P.length-1][b++]=E.y;for(v=1;v<_.length;v++){switch(_[v]){case r.GraphicsPathCommand.MOVE_TO:console.log("ERROR ! ONLY THE FIRST COMMAND FOR A CONTOUR IS ALLOWED TO BE A 'MOVE_TO' COMMAND");break;case r.GraphicsPathCommand.LINE_TO:E.x=y[g++];E.y=y[g++];P[P.length-1][b++]=E.x;P[P.length-1][b++]=E.y;break;case r.GraphicsPathCommand.CURVE_TO:var B=y[g++];var N=y[g++];var L=y[g++];var R=y[g++];I.x=B-E.x;I.y=N-E.y;I.normalize();D=Math.atan2(I.y,I.x)*h.MathConsts.RADIANS_TO_DEGREES;I.x=L-E.x;I.y=R-E.y;I.normalize();O=Math.atan2(I.y,I.x)*h.MathConsts.RADIANS_TO_DEGREES;var F=O-D;if(F>180){F-=360}if(F<-180){F+=360}if(F==0&&F==180&&F==-180){E.x=L;E.y=R;P[P.length-1][b++]=E.x;P[P.length-1][b++]=E.y;break}var k=-1;if(w<0){if(F>0){k=1;P[P.length-1][b++]=B;P[P.length-1][b++]=N}P[P.length-1][b++]=L;P[P.length-1][b++]=R}else{if(F<0){k=1;P[P.length-1][b++]=B;P[P.length-1][b++]=N}P[P.length-1][b++]=L;P[P.length-1][b++]=R}if(p.GraphicsFactoryHelper.isClockWiseXY(L,R,B,N,E.x,E.y)){x[j++]=L;x[j++]=R;x[j++]=k;x[j++]=1;x[j++]=1;x[j++]=1;x[j++]=0;x[j++]=B;x[j++]=N;x[j++]=k;x[j++]=.5;x[j++]=0;x[j++]=1;x[j++]=0;x[j++]=E.x;x[j++]=E.y;x[j++]=k;x[j++]=0;x[j++]=0;x[j++]=1;x[j++]=0}else{x[j++]=E.x;x[j++]=E.y;x[j++]=k;x[j++]=1;x[j++]=1;x[j++]=1;x[j++]=0;x[j++]=B;x[j++]=N;x[j++]=k;x[j++]=.5;x[j++]=0;x[j++]=1;x[j++]=0;x[j++]=L;x[j++]=R;x[j++]=k;x[j++]=0;x[j++]=0;x[j++]=1;x[j++]=0}E.x=L;E.y=R;break;case r.GraphicsPathCommand.CUBIC_CURVE:break}}}var V=[];var U=[];var G=[];var H=[];for(m=0;m<P.length;m++){var W=P[m];var z=new Float32Array(W);if(p.GraphicsFactoryHelper._tess_obj==null){console.log("No libtess2 tesselator available.\nMake it available using Graphics._tess_obj=new TESS();");return}p.GraphicsFactoryHelper._tess_obj.addContour(z,2,8,W.length/2)}p.GraphicsFactoryHelper._tess_obj.tesselate(0,0,3,2,null);V=p.GraphicsFactoryHelper._tess_obj.getVertices();H=p.GraphicsFactoryHelper._tess_obj.getElements();var q=V.length/2;var X=H.length/3;for(v=0;v<q;++v)U.push(new n.Point(V[v*2],V[v*2+1]));for(v=0;v<X;++v){var Y=H[v*3];var Z=H[v*3+1];var J=H[v*3+2];x[j++]=U[J].x;x[j++]=U[J].y;x[j++]=1;x[j++]=2;x[j++]=0;x[j++]=1;x[j++]=0;x[j++]=U[Z].x;x[j++]=U[Z].y;x[j++]=1;x[j++]=2;x[j++]=0;x[j++]=1;x[j++]=0;x[j++]=U[Y].x;x[j++]=U[Y].y;x[j++]=1;x[j++]=2;x[j++]=0;x[j++]=1;x[j++]=0}var K=new a.AttributesView(Float32Array,7);K.set(x);var Q=K.attributesBuffer;K.dispose();var $=new u.TriangleElements(Q);$.setPositions(new l.Float2Attributes(Q));$.setCustomAttributes("curves",new o.Float3Attributes(Q));$.setUVs(new l.Float2Attributes(Q));var tt=s.DefaultMaterialManager.getDefaultMaterial();tt.bothSides=true;tt.useColorTransform=true;tt.curves=true;var et=t.addGraphic($,tt)}t.queued_fill_pathes.length=0};return t}();i.GraphicsFactoryFills=c},{"../draw/GraphicsFactoryHelper":"awayjs-display/lib/draw/GraphicsFactoryHelper","../draw/GraphicsPathCommand":"awayjs-display/lib/draw/GraphicsPathCommand","../graphics/TriangleElements":"awayjs-display/lib/graphics/TriangleElements","../managers/DefaultMaterialManager":"awayjs-display/lib/managers/DefaultMaterialManager","awayjs-core/lib/attributes/AttributesView":undefined,"awayjs-core/lib/attributes/Float2Attributes":undefined,"awayjs-core/lib/attributes/Float3Attributes":undefined,"awayjs-core/lib/geom/MathConsts":undefined,"awayjs-core/lib/geom/Point":undefined}],"awayjs-display/lib/draw/GraphicsFactoryHelper":[function(t,e,i){"use strict";var r=t("../draw/CapsStyle");var s=t("awayjs-core/lib/geom/Point");var n=t("awayjs-core/lib/geom/MathConsts");var a=function(){function t(){}t.isClockWiseXY=function(t,e,i,r,s,n){var a=(t-i)*(n-r)-(e-r)*(s-i);if(a<0)return false;return true};t.getSign=function(t,e,i,r,s,n){return(t-s)*(r-n)-(e-n)*(i-s)};t.pointInTri=function(e,i,r,s,n,a,o,l){var h=t.getSign(e,i,o,l,r,s)>0;var p=t.getSign(r,s,o,l,n,a)>0;var u=t.getSign(n,a,o,l,e,i)>0;return h==p&&p==u};t.getControlXForCurveX=function(t,e,i){return e};t.getControlYForCurveY=function(t,e,i){return e};t.drawPoint=function(e,i,r){t.addTriangle(e-2,i-2,e+2,i-2,e+2,i+2,0,r);t.addTriangle(e-2,i-2,e-2,i+2,e+2,i+2,0,r)};t.addTriangle=function(t,e,i,r,s,n,a,o){var l=o.length;if(a==0){o[l++]=t;o[l++]=e;o[l++]=1;o[l++]=2;o[l++]=0;o[l++]=i;o[l++]=r;o[l++]=1;o[l++]=2;o[l++]=0;o[l++]=s;o[l++]=n;o[l++]=1;o[l++]=2;o[l++]=0}else{o[l++]=t;o[l++]=e;o[l++]=a;o[l++]=1;o[l++]=1;o[l++]=i;o[l++]=r;o[l++]=a;o[l++]=.5;o[l++]=0;o[l++]=s;o[l++]=n;o[l++]=a;o[l++]=0;o[l++]=0}};t.createCap=function(e,i,s,n,a,o,l,h,p){if(o==r.CapsStyle.ROUND){var u=e+l*(a.x*h);var c=i+l*(a.y*h);u=u*2-s.x/2-n.x/2;c=c*2-s.y/2-n.y/2;t.addTriangle(s.x,s.y,u,c,n.x,n.y,-1,p)}else if(o==r.CapsStyle.SQUARE){var u=s.x+l*(a.x*h);var c=s.y+l*(a.y*h);var f=n.x+l*(a.x*h);var d=n.y+l*(a.y*h);t.addTriangle(f,d,u,c,s.x,s.y,0,p);t.addTriangle(f,d,s.x,s.y,n.x,n.y,0,p)}};t.getLineFormularData=function(t,e){var i=e.x-t.x;var r=e.y-t.y;var n=new s.Point;if(i!=0&&r!=0)n.x=r/i;n.y=-(n.x*t.x-t.y);return n};t.getQuadricBezierPosition=function(t,e,i,r){var s=1-t;return s*s*e+2*s*t*i+t*t*r};t.subdivideCurve=function(e,i,r,s,a,o,l,h,p,u,c,f,d,_){var y=Math.atan2(s-i,r-e)*n.MathConsts.RADIANS_TO_DEGREES;var v=Math.atan2(o-s,a-r)*n.MathConsts.RADIANS_TO_DEGREES;var m=v-y;if(m>180){m-=360}if(m<-180){m+=360}if(Math.abs(m)>=150){d.push(e,i,r,s,a,o);_.push(l,h,p,u,c,f);return}var b=false;var g=false;if(m<0){b=t.getSign(e,i,p,u,a,o)>0;g=t.getSign(e,i,r,s,a,o)>0;b=((i-o)*(r-e)+(a-e)*(s-i))*((i-o)*(p-e)+(a-e)*(u-i))<0}else{b=t.getSign(l,h,p,u,c,f)>0;g=t.getSign(l,h,r,s,c,f)>0;b=((h-o)*(r-l)+(c-l)*(s-h))*((h-f)*(p-l)+(c-l)*(u-h))<0}if(b){d.push(e,i,r,s,a,o);_.push(l,h,p,u,c,f);return}var w=e+(r-e)*.5;var P=i+(s-i)*.5;var x=r+(a-r)*.5;var j=s+(o-s)*.5;var E=w+(x-w)*.5;var T=P+(j-P)*.5;var A=l+(p-l)*.5;var C=h+(u-h)*.5;var D=p+(c-p)*.5;var O=u+(f-u)*.5;var S=A+(D-A)*.5;var M=C+(O-C)*.5;t.subdivideCurve(e,i,w,P,E,T,l,h,A,C,S,M,d,_);t.subdivideCurve(E,T,x,j,a,o,S,M,D,O,c,f,d,_)};return t}();i.GraphicsFactoryHelper=a},{"../draw/CapsStyle":"awayjs-display/lib/draw/CapsStyle","awayjs-core/lib/geom/MathConsts":undefined,"awayjs-core/lib/geom/Point":undefined}],"awayjs-display/lib/draw/GraphicsFactoryStrokes":[function(t,e,i){"use strict";var r=t("awayjs-core/lib/geom/MathConsts");var s=t("../draw/JointStyle");var n=t("../draw/GraphicsPathCommand");var a=t("../managers/DefaultMaterialManager");var o=t("awayjs-core/lib/geom/Point");var l=t("awayjs-core/lib/attributes/AttributesView");var h=t("awayjs-core/lib/attributes/Float3Attributes");var p=t("awayjs-core/lib/attributes/Float2Attributes");var u=t("../draw/GraphicsFactoryHelper");var c=t("../graphics/TriangleElements");var f=function(){function t(){}t.draw_pathes=function(t){var e=t.queued_stroke_pathes.length;var i;var f;var d;var _;var y;var v;var m=0;var b=0;var g=0;var w=0;var P=[];var x=0;var j=new o.Point;var E=new o.Point;var T=new o.Point;var A=new o.Point;var C=new o.Point;var D=new o.Point;var O=new o.Point;var S=new o.Point;var M=new o.Point;var I=new o.Point;var B=new o.Point;var N=new o.Point;var L=new o.Point;var R=new o.Point;var F=false;var k=new o.Point;var V=0;for(V=0;V<e;V++){_=t.queued_stroke_pathes[V];i=_.commands;f=_.data;d=_.stroke();var U=[];for(b=0;b<i.length;b++){y=i[b];v=f[b];g=0;w=0;var G=0;var H=0;var W=0;var z=new o.Point;F=true;if(v[0]!=v[v.length-2]||v[1]!=v[v.length-1])F=false;else{k.x=v[v.length-2]-v[v.length-4];k.y=v[v.length-1]-v[v.length-3];k.normalize();W=Math.atan2(k.y,k.x)*r.MathConsts.RADIANS_TO_DEGREES}w=0;j.x=v[w++];j.y=v[w++];var q=[];var X=[];var Y=0;var Z=0;var J=new o.Point;var K=new o.Point;var Q=new o.Point;var $=new o.Point;var tt=new o.Point;J.x=-1*k.y;J.y=k.x;for(m=1;m<y.length;m++){if(y[m]==n.GraphicsPathCommand.MOVE_TO){console.log("ERROR ! ONLY THE FIRST COMMAND FOR A CONTOUR IS ALLOWED TO BE A 'MOVE_TO' COMMAND");continue}T=new o.Point(v[w++],v[w++]);if(y[m]==n.GraphicsPathCommand.CURVE_TO){Q=new o.Point(v[w++],v[w++])}z.x=T.x-j.x;z.y=T.y-j.y;z.normalize();G=Math.atan2(z.y,z.x)*r.MathConsts.RADIANS_TO_DEGREES;H=G-W;if(H>180){H-=360}if(H<-180){H+=360}W=G;N.x=-1*z.y;N.y=z.x;$=new o.Point(j.x+N.x*d.half_thickness,j.y+N.y*d.half_thickness);K=new o.Point(j.x-N.x*d.half_thickness,j.y-N.y*d.half_thickness);var et=false;if(m==1&&!F){et=true}else{if(H==0||H==180){if(m!=1&&y[m]==n.GraphicsPathCommand.LINE_TO&&q[q.length-1]==n.GraphicsPathCommand.LINE_TO){et=false}else{et=true}}if(H==180){console.log("path goes straight back (180). DO we need to handle this edge case different ? !")}else if(H!=0){et=true;var it=180-H;if(H<0){it=-180-H}it=it*-.5*r.MathConsts.DEGREES_TO_RADIANS;var rt=d.half_thickness/Math.sin(it);L.x=z.x*Math.cos(it)+z.y*Math.sin(it);L.y=z.y*Math.cos(it)-z.x*Math.sin(it);L.normalize();var st=new o.Point(j.x-L.x*rt,j.y-L.y*rt);var nt=new o.Point(j.x+L.x*rt,j.y+L.y*rt);if(H>0){$=st;var at=new o.Point(j.x-N.x*d.half_thickness,j.y-N.y*d.half_thickness);var ot=new o.Point(j.x-J.x*d.half_thickness,j.y-J.y*d.half_thickness);K=at}else{K=nt;var lt=new o.Point(j.x+N.x*d.half_thickness,j.y+N.y*d.half_thickness);var ht=new o.Point(j.x+J.x*d.half_thickness,j.y+J.y*d.half_thickness);$=lt}var pt=true;if(d.jointstyle==s.JointStyle.MITER){var ut=Math.sqrt(rt*rt-d.half_thickness*d.half_thickness)/d.half_thickness;if(ut<=d.miter_limit){pt=false;$=st;K=nt}else{if(H>0){at.x=at.x-z.x*(d.miter_limit*d.half_thickness);at.y=at.y-z.y*(d.miter_limit*d.half_thickness);R.x=J.y*-1;R.y=J.x;ot.x=ot.x-R.x*(d.miter_limit*d.half_thickness);ot.y=ot.y-R.y*(d.miter_limit*d.half_thickness)}else{lt.x=lt.x-z.x*(d.miter_limit*d.half_thickness);lt.y=lt.y-z.y*(d.miter_limit*d.half_thickness);R.x=J.y*-1;R.y=J.x;ht.x=ht.x-R.x*(d.miter_limit*d.half_thickness);ht.y=ht.y-R.y*(d.miter_limit*d.half_thickness)}}}if(pt){q[Y++]=d.jointstyle!=s.JointStyle.ROUND?n.GraphicsPathCommand.BUILD_JOINT:n.GraphicsPathCommand.BUILD_ROUND_JOINT;if(H>0){X[Z++]=st;X[Z++]=ot;X[Z++]=at}else{X[Z++]=ht;X[Z++]=nt;X[Z++]=lt}if(d.jointstyle==s.JointStyle.ROUND){X[Z++]=new o.Point(j.x-L.x*Math.abs(rt),j.y-L.y*Math.abs(rt));if(H>0){X[Z++]=ot;X[Z++]=at}else{X[Z++]=ht;X[Z++]=lt}}}}}J.x=N.x;J.y=N.y;if(et){if(y[m]==n.GraphicsPathCommand.LINE_TO){q[Y++]=n.GraphicsPathCommand.LINE_TO;X[Z++]=$;X[Z++]=K}else if(y[m]==n.GraphicsPathCommand.CURVE_TO){z.x=Q.x-T.x;z.y=Q.y-T.y;z.normalize();G=Math.atan2(z.y,z.x)*r.MathConsts.RADIANS_TO_DEGREES;H=G-W;W=G;N.x=-1*z.y;N.y=z.x;if(H!=0&&H!=180){q[Y++]=n.GraphicsPathCommand.CURVE_TO;X[Z++]=$;X[Z++]=K;X[Z++]=new o.Point(j.x,j.y);X[Z++]=new o.Point(T.x,T.y);X[Z++]=Q}else{q[Y++]=n.GraphicsPathCommand.LINE_TO;X[Z++]=$;X[Z++]=K}J.x=N.x;J.y=N.y;j=Q}}if(y[m]==n.GraphicsPathCommand.LINE_TO){j=T}if(m==y.length-1){if(!F){q[Y++]=n.GraphicsPathCommand.NO_OP;X[Z++]=new o.Point(j.x+N.x*d.half_thickness,j.y+N.y*d.half_thickness);X[Z++]=new o.Point(j.x-N.x*d.half_thickness,j.y-N.y*d.half_thickness)}else{q[Y++]=n.GraphicsPathCommand.NO_OP;X[Z++]=X[0];X[Z++]=X[1]}}}Y=0;Z=0;for(m=0;m<q.length;m++){if(q[m]==n.GraphicsPathCommand.LINE_TO){Z+=2}else if(q[m]==n.GraphicsPathCommand.CURVE_TO){C=X[Z++];A=X[Z++];E=X[Z++];tt=X[Z++];T=X[Z++];B=X[Z];I=X[Z+1];z.x=tt.x-E.x;z.y=tt.y-E.y;R.x=tt.x-E.x;R.y=tt.y-E.y;var ct=R.length;z.normalize();L.x=T.x-tt.x;L.y=T.y-tt.y;var ft=L.length;L.normalize();var dt=.5-(ft-ct)/ct*.5;if(ct>ft){dt=.5+(ct-ft)/ft*.5}var _t=Math.atan2(z.y,z.x)*r.MathConsts.RADIANS_TO_DEGREES;var yt=Math.atan2(L.y,L.x)*r.MathConsts.RADIANS_TO_DEGREES;H=yt-_t;if(H>180){H-=360}if(H<-180){H+=360}if(H==0){console.log("This is not a curve, we can just draw it like a straight line")}var vt=1;if(H<0){vt=-1}var it=H*.5*r.MathConsts.DEGREES_TO_RADIANS;var mt=Math.abs(ct*Math.sin(it));var rt=d.half_thickness/Math.sin(it);R.x=L.x*Math.cos(it)+L.y*Math.sin(it);R.y=L.y*Math.cos(it)-L.x*Math.sin(it);R.normalize();var st=new o.Point(tt.x-R.x*rt,tt.y-R.y*rt);var nt=new o.Point(tt.x+R.x*rt,tt.y+R.y*rt);var bt=u.GraphicsFactoryHelper.getQuadricBezierPosition(.5,E.x,tt.x,T.x);var gt=u.GraphicsFactoryHelper.getQuadricBezierPosition(.5,E.y,tt.y,T.y);var wt=u.GraphicsFactoryHelper.getQuadricBezierPosition(.501,E.x,tt.x,T.x);var Pt=u.GraphicsFactoryHelper.getQuadricBezierPosition(.501,E.y,tt.y,T.y);R.x=-1*(gt-Pt);R.y=bt-wt;R.normalize();O.x=bt+vt*R.x*d.half_thickness;O.y=gt+vt*R.y*d.half_thickness;D.x=bt-vt*R.x*d.half_thickness;D.y=gt-vt*R.y*d.half_thickness;O.x=O.x*2-C.x/2-B.x/2;O.y=O.y*2-C.y/2-B.y/2;D.x=D.x*2-A.x/2-I.x/2;D.y=D.y*2-A.y/2-I.y/2;var xt=[];var jt=[];u.GraphicsFactoryHelper.subdivideCurve(C.x,C.y,O.x,O.y,B.x,B.y,A.x,A.y,D.x,D.y,I.x,I.y,xt,jt);if(H>0){for(var Et=0;Et<xt.length/6;Et++){u.GraphicsFactoryHelper.addTriangle(xt[Et*6],xt[Et*6+1],xt[Et*6+2],xt[Et*6+3],xt[Et*6+4],xt[Et*6+5],1,P);u.GraphicsFactoryHelper.addTriangle(jt[Et*6],jt[Et*6+1],xt[Et*6],xt[Et*6+1],xt[Et*6+2],xt[Et*6+3],0,P);u.GraphicsFactoryHelper.addTriangle(jt[Et*6],jt[Et*6+1],jt[Et*6+4],jt[Et*6+5],xt[Et*6+2],xt[Et*6+3],0,P);u.GraphicsFactoryHelper.addTriangle(jt[Et*6+4],jt[Et*6+5],xt[Et*6+2],xt[Et*6+3],xt[Et*6+4],xt[Et*6+5],0,P);u.GraphicsFactoryHelper.addTriangle(jt[Et*6],jt[Et*6+1],jt[Et*6+2],jt[Et*6+3],jt[Et*6+4],jt[Et*6+5],-1,P)}}else{for(var Et=0;Et<xt.length/6;Et++){u.GraphicsFactoryHelper.addTriangle(xt[Et*6],xt[Et*6+1],xt[Et*6+2],xt[Et*6+3],xt[Et*6+4],xt[Et*6+5],-1,P);u.GraphicsFactoryHelper.addTriangle(xt[Et*6],xt[Et*6+1],jt[Et*6],jt[Et*6+1],jt[Et*6+2],jt[Et*6+3],0,P);u.GraphicsFactoryHelper.addTriangle(xt[Et*6],xt[Et*6+1],xt[Et*6+4],xt[Et*6+5],jt[Et*6+2],jt[Et*6+3],0,P);u.GraphicsFactoryHelper.addTriangle(xt[Et*6+4],xt[Et*6+5],jt[Et*6+2],jt[Et*6+3],jt[Et*6+4],jt[Et*6+5],0,P);u.GraphicsFactoryHelper.addTriangle(jt[Et*6],jt[Et*6+1],jt[Et*6+2],jt[Et*6+3],jt[Et*6+4],jt[Et*6+5],1,P)}}}else if(q[m]>=n.GraphicsPathCommand.BUILD_JOINT){Z+=3;if(q[m]==n.GraphicsPathCommand.BUILD_ROUND_JOINT){I=X[Z++];C=X[Z++];A=X[Z++];u.GraphicsFactoryHelper.addTriangle(C.x,C.y,I.x,I.y,A.x,A.y,-1,P)}}}Y=0;Z=0;for(m=0;m<q.length;m++){if(q[m]==n.GraphicsPathCommand.LINE_TO){C=X[Z++];A=X[Z++];B=X[Z];I=X[Z+1];u.GraphicsFactoryHelper.addTriangle(C.x,C.y,A.x,A.y,B.x,B.y,0,P);u.GraphicsFactoryHelper.addTriangle(A.x,A.y,I.x,I.y,B.x,B.y,0,P)}else if(q[m]==n.GraphicsPathCommand.CURVE_TO){Z+=5}else if(q[m]>=n.GraphicsPathCommand.BUILD_JOINT){B=X[Z++];C=X[Z++];A=X[Z++];u.GraphicsFactoryHelper.addTriangle(C.x,C.y,A.x,A.y,B.x,B.y,0,P);if(q[m]==n.GraphicsPathCommand.BUILD_ROUND_JOINT){Z+=3}}}if(!F){k.x=v[2]-v[0];k.y=v[3]-v[1];k.normalize();u.GraphicsFactoryHelper.createCap(v[0],v[1],X[0],X[1],k,d.capstyle,-1,d.half_thickness,P);k.x=v[v.length-2]-v[v.length-4];k.y=v[v.length-1]-v[v.length-3];k.normalize();u.GraphicsFactoryHelper.createCap(v[v.length-2],v[v.length-1],X[X.length-2],X[X.length-1],k,d.capstyle,1,d.half_thickness,P)}}var Tt=new l.AttributesView(Float32Array,5);Tt.set(P);var At=Tt.attributesBuffer;Tt.dispose();var Ct=new c.TriangleElements(At);Ct.setPositions(new p.Float2Attributes(At));Ct.setCustomAttributes("curves",new h.Float3Attributes(At));var Dt=a.DefaultMaterialManager.getDefaultMaterial();Dt.bothSides=true;Dt.useColorTransform=true;Dt.curves=true;t.addGraphic(Ct,Dt)}t.queued_stroke_pathes.length=0};return t}();i.GraphicsFactoryStrokes=f},{"../draw/GraphicsFactoryHelper":"awayjs-display/lib/draw/GraphicsFactoryHelper","../draw/GraphicsPathCommand":"awayjs-display/lib/draw/GraphicsPathCommand","../draw/JointStyle":"awayjs-display/lib/draw/JointStyle","../graphics/TriangleElements":"awayjs-display/lib/graphics/TriangleElements","../managers/DefaultMaterialManager":"awayjs-display/lib/managers/DefaultMaterialManager","awayjs-core/lib/attributes/AttributesView":undefined,"awayjs-core/lib/attributes/Float2Attributes":undefined,"awayjs-core/lib/attributes/Float3Attributes":undefined,"awayjs-core/lib/geom/MathConsts":undefined,"awayjs-core/lib/geom/Point":undefined}],"awayjs-display/lib/draw/GraphicsFillStyle":[function(t,e,i){"use strict";var r=function(){function t(t,e){if(t===void 0){t=16777215}if(e===void 0){e=1}this._color=t;this._alpha=e}Object.defineProperty(t.prototype,"data_type",{get:function(){return t.data_type},enumerable:true,configurable:true});t.data_type="[graphicsdata FillStyle]";return t}();i.GraphicsFillStyle=r},{}],"awayjs-display/lib/draw/GraphicsPathCommand":[function(t,e,i){"use strict";var r=function(){function t(){}t.NO_OP=0;t.MOVE_TO=1;t.LINE_TO=2;t.CURVE_TO=3;t.BUILD_JOINT=13;t.BUILD_ROUND_JOINT=14;t.WIDE_LINE_TO=4;t.WIDE_MOVE_TO=5;t.CUBIC_CURVE=6;return t}();i.GraphicsPathCommand=r;Object.defineProperty(i,"__esModule",{value:true});i.default=r},{}],"awayjs-display/lib/draw/GraphicsPathWinding":[function(t,e,i){"use strict";var r=function(){function t(){}t.EVEN_ODD="evenOdd";t.NON_ZERO="nonZero";return t}();i.GraphicsPathWinding=r},{}],"awayjs-display/lib/draw/GraphicsPath":[function(t,e,i){"use strict";var r=t("../draw/GraphicsPathWinding");var s=t("../draw/GraphicsPathCommand");var n=t("../draw/GraphicsFillStyle");var a=t("../draw/GraphicsStrokeStyle");var o=t("awayjs-core/lib/geom/Point");var l=function(){function t(t,e,i){if(t===void 0){t=null}if(e===void 0){e=null}if(i===void 0){i=r.GraphicsPathWinding.EVEN_ODD}this._data=[];this._commands=[];this._style=null;if(t!=null&&e!=null){this._data[0]=e;this._commands[0]=t}else{this._data[0]=[];this._commands[0]=[]}this._startPoint=new o.Point;this._cur_point=new o.Point;this._winding_rule=i;this._winding_directions=[]}Object.defineProperty(t.prototype,"data_type",{get:function(){return t.data_type},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"style",{get:function(){return this._style},set:function(t){this._style=t},enumerable:true,configurable:true});t.prototype.fill=function(){if(this._style==null)return null;if(this._style.data_type==n.GraphicsFillStyle.data_type)return this._style;return null};t.prototype.stroke=function(){if(this._style==null)return null;if(this._style.data_type==a.GraphicsStrokeStyle.data_type)return this._style;return null};Object.defineProperty(t.prototype,"commands",{get:function(){return this._commands},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:true,configurable:true});t.prototype.curveTo=function(t,e,i,r){if(this._commands[this._commands.length-1].length==0){this._commands[this._commands.length-1].push(s.GraphicsPathCommand.MOVE_TO);this._data[this._data.length-1].push(this._cur_point.x);this._data[this._data.length-1].push(this._cur_point.y)}this._commands[this._commands.length-1].push(s.GraphicsPathCommand.CURVE_TO);this._data[this._data.length-1].push(t);this._data[this._data.length-1].push(e);this._data[this._data.length-1].push(i);this._data[this._data.length-1].push(r);this._cur_point.x=i;this._cur_point.y=r};t.prototype.lineTo=function(t,e){if(this._commands[this._commands.length-1].length==0){this._commands[this._commands.length-1].push(s.GraphicsPathCommand.MOVE_TO);this._data[this._data.length-1].push(this._cur_point.x);this._data[this._data.length-1].push(this._cur_point.y)}this._commands[this._commands.length-1].push(s.GraphicsPathCommand.LINE_TO);this._data[this._data.length-1].push(t);this._data[this._data.length-1].push(e);this._cur_point.x=t;this._cur_point.y=e};t.prototype.moveTo=function(t,e){if(this._commands[this._commands.length-1].length>0){this._commands.push([s.GraphicsPathCommand.MOVE_TO]);this._data.push([t,e])}this._startPoint.x=t;this._startPoint.y=e;this._cur_point.x=t;this._cur_point.y=e};t.prototype.wideLineTo=function(t,e){};t.prototype.wideMoveTo=function(t,e){};t.data_type="[graphicsdata path]";return t}();i.GraphicsPath=l},{"../draw/GraphicsFillStyle":"awayjs-display/lib/draw/GraphicsFillStyle","../draw/GraphicsPathCommand":"awayjs-display/lib/draw/GraphicsPathCommand","../draw/GraphicsPathWinding":"awayjs-display/lib/draw/GraphicsPathWinding","../draw/GraphicsStrokeStyle":"awayjs-display/lib/draw/GraphicsStrokeStyle",
"awayjs-core/lib/geom/Point":undefined}],"awayjs-display/lib/draw/GraphicsStrokeStyle":[function(t,e,i){"use strict";var r=t("../draw/JointStyle");var s=t("../draw/CapsStyle");var n=function(){function t(t,e,i,n,a,o){if(t===void 0){t=16777215}if(e===void 0){e=1}if(i===void 0){i=10}if(n===void 0){n=r.JointStyle.ROUND}if(a===void 0){a=s.CapsStyle.SQUARE}if(o===void 0){o=10}this._color=t;this._alpha=e;this._thickness=i;this._jointstyle=n;this._capstyle=a;this._miter_limit=o}Object.defineProperty(t.prototype,"data_type",{get:function(){return t.data_type},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"half_thickness",{get:function(){return this._thickness/2},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(t){this._thickness=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"jointstyle",{get:function(){return this._jointstyle},set:function(t){this._jointstyle=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"miter_limit",{get:function(){return this._miter_limit},set:function(t){this._miter_limit=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"capstyle",{get:function(){return this._capstyle},set:function(t){this._capstyle=t},enumerable:true,configurable:true});t.data_type="[graphicsdata StrokeStyle]";return t}();i.GraphicsStrokeStyle=n},{"../draw/CapsStyle":"awayjs-display/lib/draw/CapsStyle","../draw/JointStyle":"awayjs-display/lib/draw/JointStyle"}],"awayjs-display/lib/draw/IGraphicsData":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/draw/InterpolationMethod":[function(t,e,i){"use strict";var r=function(){function t(){}t.LINEAR_RGB="linearRGB";t.RGB="rgb";return t}();i.InterpolationMethod=r},{}],"awayjs-display/lib/draw/JointStyle":[function(t,e,i){"use strict";var r=function(){function t(){}t.BEVEL=2;t.MITER=0;t.ROUND=1;return t}();i.JointStyle=r},{}],"awayjs-display/lib/draw/LineScaleMode":[function(t,e,i){"use strict";var r=function(){function t(){}t.HORIZONTAL="horizontal";t.NONE="none";t.NORMAL="normal";t.VERTICAL="vertical";return t}();i.LineScaleMode=r},{}],"awayjs-display/lib/draw/PixelSnapping":[function(t,e,i){"use strict";var r=function(){function t(){}t.ALWAYS="always";t.AUTO="auto";t.NEVER="never";return t}();i.PixelSnapping=r},{}],"awayjs-display/lib/draw/SpreadMethod":[function(t,e,i){"use strict";var r=function(){function t(){}t.PAD="pad";t.REFLECT="reflect";t.REPEAT="repeat";return t}();i.SpreadMethod=r},{}],"awayjs-display/lib/draw/TriangleCulling":[function(t,e,i){"use strict";var r=function(){function t(){}t.NEGATIVE="negative";t.NONE="none";t.POSITIVE="positive";return t}();i.TriangleCulling=r},{}],"awayjs-display/lib/draw":[function(t,e,i){"use strict";var r=t("./draw/CapsStyle");i.CapsStyle=r.CapsStyle;var s=t("./draw/GradientType");i.GradientType=s.GradientType;var n=t("./draw/GraphicsFactoryFills");i.GraphicsFactoryFills=n.GraphicsFactoryFills;var a=t("./draw/GraphicsFactoryHelper");i.GraphicsFactoryHelper=a.GraphicsFactoryHelper;var o=t("./draw/GraphicsFactoryStrokes");i.GraphicsFactoryStrokes=o.GraphicsFactoryStrokes;var l=t("./draw/GraphicsFillStyle");i.GraphicsFillStyle=l.GraphicsFillStyle;var h=t("./draw/GraphicsStrokeStyle");i.GraphicsStrokeStyle=h.GraphicsStrokeStyle;var p=t("./draw/GraphicsPath");i.GraphicsPath=p.GraphicsPath;var u=t("./draw/GraphicsPathCommand");i.GraphicsPathCommand=u.GraphicsPathCommand;var c=t("./draw/GraphicsPathWinding");i.GraphicsPathWinding=c.GraphicsPathWinding;var f=t("./draw/InterpolationMethod");i.InterpolationMethod=f.InterpolationMethod;var d=t("./draw/JointStyle");i.JointStyle=d.JointStyle;var _=t("./draw/LineScaleMode");i.LineScaleMode=_.LineScaleMode;var y=t("./draw/PixelSnapping");i.PixelSnapping=y.PixelSnapping;var v=t("./draw/SpreadMethod");i.SpreadMethod=v.SpreadMethod;var m=t("./draw/TriangleCulling");i.TriangleCulling=m.TriangleCulling},{"./draw/CapsStyle":"awayjs-display/lib/draw/CapsStyle","./draw/GradientType":"awayjs-display/lib/draw/GradientType","./draw/GraphicsFactoryFills":"awayjs-display/lib/draw/GraphicsFactoryFills","./draw/GraphicsFactoryHelper":"awayjs-display/lib/draw/GraphicsFactoryHelper","./draw/GraphicsFactoryStrokes":"awayjs-display/lib/draw/GraphicsFactoryStrokes","./draw/GraphicsFillStyle":"awayjs-display/lib/draw/GraphicsFillStyle","./draw/GraphicsPath":"awayjs-display/lib/draw/GraphicsPath","./draw/GraphicsPathCommand":"awayjs-display/lib/draw/GraphicsPathCommand","./draw/GraphicsPathWinding":"awayjs-display/lib/draw/GraphicsPathWinding","./draw/GraphicsStrokeStyle":"awayjs-display/lib/draw/GraphicsStrokeStyle","./draw/InterpolationMethod":"awayjs-display/lib/draw/InterpolationMethod","./draw/JointStyle":"awayjs-display/lib/draw/JointStyle","./draw/LineScaleMode":"awayjs-display/lib/draw/LineScaleMode","./draw/PixelSnapping":"awayjs-display/lib/draw/PixelSnapping","./draw/SpreadMethod":"awayjs-display/lib/draw/SpreadMethod","./draw/TriangleCulling":"awayjs-display/lib/draw/TriangleCulling"}],"awayjs-display/lib/errors/CastError":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/errors/ErrorBase");var n=function(t){r(e,t);function e(e){t.call(this,e)}return e}(s.ErrorBase);i.CastError=n},{"awayjs-core/lib/errors/ErrorBase":undefined}],"awayjs-display/lib/errors":[function(t,e,i){"use strict";var r=t("./errors/CastError");i.CastError=r.CastError},{"./errors/CastError":"awayjs-display/lib/errors/CastError"}],"awayjs-display/lib/events/CameraEvent":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/events/EventBase");var n=function(t){r(e,t);function e(e,i){t.call(this,e);this._camera=i}Object.defineProperty(e.prototype,"camera",{get:function(){return this._camera},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this._camera)};e.PROJECTION_CHANGED="projectionChanged";return e}(s.EventBase);i.CameraEvent=n},{"awayjs-core/lib/events/EventBase":undefined}],"awayjs-display/lib/events/DisplayObjectEvent":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/events/EventBase");var n=function(t){r(e,t);function e(e,i){t.call(this,e);this._object=i}Object.defineProperty(e.prototype,"object",{get:function(){return this._object},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this._object)};e.VISIBLITY_UPDATED="visiblityUpdated";e.SCENETRANSFORM_CHANGED="scenetransformChanged";e.SCENE_CHANGED="sceneChanged";e.PARTITION_CHANGED="partitionChanged";e.INVALIDATE_PARTITION_BOUNDS="invalidatePartitionBounds";return e}(s.EventBase);i.DisplayObjectEvent=n},{"awayjs-core/lib/events/EventBase":undefined}],"awayjs-display/lib/events/ElementsEvent":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/events/EventBase");var n=function(t){r(e,t);function e(e,i){t.call(this,e);this._attributesView=i}Object.defineProperty(e.prototype,"attributesView",{get:function(){return this._attributesView},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this._attributesView)};e.INVALIDATE_INDICES="invalidateIndices";e.CLEAR_INDICES="clearIndices";e.INVALIDATE_VERTICES="invalidateVertices";e.CLEAR_VERTICES="clearVertices";return e}(s.EventBase);i.ElementsEvent=n},{"awayjs-core/lib/events/EventBase":undefined}],"awayjs-display/lib/events/LightEvent":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/events/EventBase");var n=function(t){r(e,t);function e(e){t.call(this,e)}e.prototype.clone=function(){return new e(this.type)};e.CASTS_SHADOW_CHANGE="castsShadowChange";return e}(s.EventBase);i.LightEvent=n},{"awayjs-core/lib/events/EventBase":undefined}],"awayjs-display/lib/events/MouseEvent":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/events/EventBase");var n=function(t){r(e,t);function e(e){t.call(this,e);this._iAllowedToPropagate=true}Object.defineProperty(e.prototype,"bubbles",{get:function(){var t=this._iAllowedToPropagate;this._iAllowedToPropagate=true;return t},enumerable:true,configurable:true});e.prototype.stopPropagation=function(){this._iAllowedToPropagate=false;if(this._iParentEvent)this._iParentEvent.stopPropagation()};e.prototype.stopImmediatePropagation=function(){this._iAllowedToPropagate=false;if(this._iParentEvent)this._iParentEvent.stopImmediatePropagation()};e.prototype.clone=function(){var t=new e(this.type);t.screenX=this.screenX;t.screenY=this.screenY;t.view=this.view;t.entity=this.entity;t.renderable=this.renderable;t.material=this.material;t.uv=this.uv;t.position=this.position;t.normal=this.normal;t.elementIndex=this.elementIndex;t.delta=this.delta;t.ctrlKey=this.ctrlKey;t.shiftKey=this.shiftKey;t._iParentEvent=this;t._iAllowedToPropagate=this._iAllowedToPropagate;return t};Object.defineProperty(e.prototype,"scenePosition",{get:function(){return this.entity.sceneTransform.transformVector(this.position)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"sceneNormal",{get:function(){var t=this.entity.sceneTransform.deltaTransformVector(this.normal);t.normalize();return t},enumerable:true,configurable:true});e.MOUSE_OVER="mouseOver3d";e.MOUSE_OUT="mouseOut3d";e.MOUSE_UP="mouseUp3d";e.MOUSE_DOWN="mouseDown3d";e.MOUSE_MOVE="mouseMove3d";e.CLICK="click3d";e.DOUBLE_CLICK="doubleClick3d";e.MOUSE_WHEEL="mouseWheel3d";return e}(s.EventBase);i.MouseEvent=n},{"awayjs-core/lib/events/EventBase":undefined}],"awayjs-display/lib/events/RenderableEvent":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/events/EventBase");var n=function(t){r(e,t);function e(e,i){t.call(this,e);this._renderable=i}Object.defineProperty(e.prototype,"renderable",{get:function(){return this._renderable},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this._renderable)};e.INVALIDATE_SURFACE="invalidateRenderable";e.INVALIDATE_ELEMENTS="invalidateElements";return e}(s.EventBase);i.RenderableEvent=n},{"awayjs-core/lib/events/EventBase":undefined}],"awayjs-display/lib/events/RendererEvent":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/events/EventBase");var n=function(t){r(e,t);function e(e){t.call(this,e)}e.VIEWPORT_UPDATED="viewportUpdated";e.SCISSOR_UPDATED="scissorUpdated";return e}(s.EventBase);i.RendererEvent=n},{"awayjs-core/lib/events/EventBase":undefined}],"awayjs-display/lib/events/ResizeEvent":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/events/EventBase");var n=function(t){r(e,t);function e(e,i,r){if(i===void 0){i=NaN}if(r===void 0){r=NaN}t.call(this,e);this._oldHeight=i;this._oldWidth=r}Object.defineProperty(e.prototype,"oldHeight",{get:function(){return this._oldHeight},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"oldWidth",{get:function(){return this._oldWidth},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this._oldHeight,this._oldWidth)};e.RESIZE="resize";return e}(s.EventBase);i.ResizeEvent=n},{"awayjs-core/lib/events/EventBase":undefined}],"awayjs-display/lib/events/StyleEvent":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/events/EventBase");var n=function(t){r(e,t);function e(e,i){t.call(this,e);this._style=i}Object.defineProperty(e.prototype,"style",{get:function(){return this._style},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this._style)};e.INVALIDATE_PROPERTIES="invalidateProperties";return e}(s.EventBase);i.StyleEvent=n},{"awayjs-core/lib/events/EventBase":undefined}],"awayjs-display/lib/events/SurfaceEvent":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/events/EventBase");var n=function(t){r(e,t);function e(e,i){t.call(this,e);this._surface=i}Object.defineProperty(e.prototype,"surface",{get:function(){return this._surface},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this._surface)};e.INVALIDATE_TEXTURE="invalidateTexture";e.INVALIDATE_ANIMATION="invalidateAnimation";e.INVALIDATE_PASSES="invalidatePasses";return e}(s.EventBase);i.SurfaceEvent=n},{"awayjs-core/lib/events/EventBase":undefined}],"awayjs-display/lib/events/TouchEvent":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/events/EventBase");var n=function(t){r(e,t);function e(e){t.call(this,e);this._iAllowedToPropagate=true}Object.defineProperty(e.prototype,"bubbles",{get:function(){var t=this._iAllowedToPropagate;this._iAllowedToPropagate=true;return t},enumerable:true,configurable:true});e.prototype.stopPropagation=function(){this._iAllowedToPropagate=false;if(this._iParentEvent)this._iParentEvent.stopPropagation()};e.prototype.stopImmediatePropagation=function(){this._iAllowedToPropagate=false;if(this._iParentEvent)this._iParentEvent.stopImmediatePropagation()};e.prototype.clone=function(){var t=new e(this.type);t.screenX=this.screenX;t.screenY=this.screenY;t.view=this.view;t.entity=this.entity;t.renderable=this.renderable;t.material=this.material;t.uv=this.uv;t.position=this.position;t.normal=this.normal;t.elementIndex=this.elementIndex;t.ctrlKey=this.ctrlKey;t.shiftKey=this.shiftKey;t._iParentEvent=this;return t};Object.defineProperty(e.prototype,"scenePosition",{get:function(){return this.entity.sceneTransform.transformVector(this.position)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"sceneNormal",{get:function(){var t=this.entity.sceneTransform.deltaTransformVector(this.normal);t.normalize();return t},enumerable:true,configurable:true});e.TOUCH_END="touchEnd3d";e.TOUCH_BEGIN="touchBegin3d";e.TOUCH_MOVE="touchMove3d";e.TOUCH_OUT="touchOut3d";e.TOUCH_OVER="touchOver3d";return e}(s.EventBase);i.TouchEvent=n},{"awayjs-core/lib/events/EventBase":undefined}],"awayjs-display/lib/events/TransformEvent":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/events/EventBase");var n=function(t){r(e,t);function e(e,i){t.call(this,e);this._transform=i}Object.defineProperty(e.prototype,"transform",{get:function(){return this._transform},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this._transform)};e.INVALIDATE_MATRIX3D="invalidateMatrix3D";e.INVALIDATE_COLOR_TRANSFORM="invalidateColorTransform";return e}(s.EventBase);i.TransformEvent=n},{"awayjs-core/lib/events/EventBase":undefined}],"awayjs-display/lib/events":[function(t,e,i){"use strict";var r=t("./events/CameraEvent");i.CameraEvent=r.CameraEvent;var s=t("./events/DisplayObjectEvent");i.DisplayObjectEvent=s.DisplayObjectEvent;var n=t("./events/ElementsEvent");i.ElementsEvent=n.ElementsEvent;var a=t("./events/LightEvent");i.LightEvent=a.LightEvent;var o=t("./events/MouseEvent");i.MouseEvent=o.MouseEvent;var l=t("./events/RenderableEvent");i.RenderableEvent=l.RenderableEvent;var h=t("./events/RendererEvent");i.RendererEvent=h.RendererEvent;var p=t("./events/ResizeEvent");i.ResizeEvent=p.ResizeEvent;var u=t("./events/StyleEvent");i.StyleEvent=u.StyleEvent;var c=t("./events/SurfaceEvent");i.SurfaceEvent=c.SurfaceEvent;var f=t("./events/TouchEvent");i.TouchEvent=f.TouchEvent;var d=t("./events/TransformEvent");i.TransformEvent=d.TransformEvent},{"./events/CameraEvent":"awayjs-display/lib/events/CameraEvent","./events/DisplayObjectEvent":"awayjs-display/lib/events/DisplayObjectEvent","./events/ElementsEvent":"awayjs-display/lib/events/ElementsEvent","./events/LightEvent":"awayjs-display/lib/events/LightEvent","./events/MouseEvent":"awayjs-display/lib/events/MouseEvent","./events/RenderableEvent":"awayjs-display/lib/events/RenderableEvent","./events/RendererEvent":"awayjs-display/lib/events/RendererEvent","./events/ResizeEvent":"awayjs-display/lib/events/ResizeEvent","./events/StyleEvent":"awayjs-display/lib/events/StyleEvent","./events/SurfaceEvent":"awayjs-display/lib/events/SurfaceEvent","./events/TouchEvent":"awayjs-display/lib/events/TouchEvent","./events/TransformEvent":"awayjs-display/lib/events/TransformEvent"}],"awayjs-display/lib/factories/ITimelineSceneGraphFactory":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/factories":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/graphics/ElementsBase":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/attributes/AttributesView");var n=t("awayjs-core/lib/attributes/Float3Attributes");var a=t("awayjs-core/lib/attributes/Short3Attributes");var o=t("awayjs-core/lib/errors/AbstractMethodError");var l=t("awayjs-core/lib/library/AssetBase");var h=t("../events/ElementsEvent");var p=function(t){r(e,t);function e(e){if(e===void 0){e=null}t.call(this);this._customAttributesNames=new Array;this._customAttributes=new Object;this._numElements=0;this._numVertices=0;this._verticesDirty=new Object;this._invalidateVertices=new Object;this._concatenatedBuffer=e}Object.defineProperty(e.prototype,"concatenatedBuffer",{get:function(){return this._concatenatedBuffer},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"indices",{get:function(){return this._indices},enumerable:true,configurable:true});e.prototype.getCustomAtributesNames=function(){return this._customAttributesNames};e.prototype.getCustomAtributes=function(t){return this._customAttributes[t]};Object.defineProperty(e.prototype,"numElements",{get:function(){return this._numElements},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:true,configurable:true});e.prototype.copyTo=function(t){if(this.indices)t.setIndices(this.indices.clone());for(var e in this._customAttributes)t.setCustomAttributes(e,this.getCustomAtributes(e).clone())};e.prototype.dispose=function(){t.prototype.dispose.call(this);if(this._indices){this._indices.dispose();this._indices=null}for(var e in this._customAttributes){this._customAttributes[e].dispose();delete this._customAttributes}};e.prototype.setIndices=function(t,e){if(e===void 0){e=0}if(t instanceof a.Short3Attributes){if(this._indices)this.clearIndices();this._indices=t}else if(t){if(!this._indices)this._indices=new a.Short3Attributes;this._indices.set(t,e)}else if(this._indices){this._indices.dispose();this._indices=null;this.clearIndices()}if(this._indices){this._numElements=this._indices.count;this.invalidateIndices()}else{this._numElements=0}};e.prototype.setCustomAttributes=function(t,e,i){if(i===void 0){i=0}if(e==this._customAttributes[t])return;if(e instanceof s.AttributesView){this.clearVertices(this._customAttributes[t]);this._customAttributes[t]=e}else if(e){if(!this._customAttributes[t])this._customAttributes[t]=new n.Float3Attributes(this._concatenatedBuffer);this._customAttributes[t].set(e,i)}else if(this._customAttributes[t]){this.clearVertices(this._customAttributes[t]);this._customAttributesNames.splice(this._customAttributesNames.indexOf(t),1);delete this._customAttributes[t];return}this.invalidateVertices(this._customAttributes[t]);this._verticesDirty[this._customAttributes[t].id]=false;if(this._customAttributesNames.indexOf(t)==-1)this._customAttributesNames.push(t)};e.prototype.clone=function(){throw new o.AbstractMethodError};e.prototype.applyTransformation=function(t,e,i){if(e===void 0){e=0}if(i===void 0){i=0}throw new o.AbstractMethodError};e.prototype.scale=function(t,e,i){if(e===void 0){e=0}if(i===void 0){i=0}throw new o.AbstractMethodError};e.prototype.scaleUV=function(t,e,i,r){if(t===void 0){t=1}if(e===void 0){e=1}if(i===void 0){i=0}if(r===void 0){r=0}throw new o.AbstractMethodError};e.prototype.getBoxBounds=function(t,e,i){if(t===void 0){t=null}if(e===void 0){e=0}if(i===void 0){i=0}throw new o.AbstractMethodError};e.prototype.getSphereBounds=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=0}if(r===void 0){r=0}throw new o.AbstractMethodError};e.prototype.hitTestPoint=function(t,e,i,r,s,n){if(s===void 0){s=0}if(n===void 0){n=0}throw new o.AbstractMethodError};e.prototype.invalidateIndices=function(){if(!this._invalidateIndices)this._invalidateIndices=new h.ElementsEvent(h.ElementsEvent.INVALIDATE_INDICES,this._indices);this.dispatchEvent(this._invalidateIndices)};e.prototype.clearIndices=function(){this.dispatchEvent(new h.ElementsEvent(h.ElementsEvent.CLEAR_INDICES,this._indices))};e.prototype.invalidateVertices=function(t){if(!t||this._verticesDirty[t.id])return;this._verticesDirty[t.id]=true;if(!this._invalidateVertices[t.id])this._invalidateVertices[t.id]=new h.ElementsEvent(h.ElementsEvent.INVALIDATE_VERTICES,t);this.dispatchEvent(this._invalidateVertices[t.id])};e.prototype.clearVertices=function(t){if(!t)return;t.dispose();this.dispatchEvent(new h.ElementsEvent(h.ElementsEvent.CLEAR_VERTICES,t));this._verticesDirty[t.id]=null;this._invalidateVertices[t.id]=null};e.prototype._iTestCollision=function(t,e,i,r,s){if(r===void 0){r=0}if(s===void 0){s=0}throw new o.AbstractMethodError};return e}(l.AssetBase);i.ElementsBase=p},{"../events/ElementsEvent":"awayjs-display/lib/events/ElementsEvent","awayjs-core/lib/attributes/AttributesView":undefined,"awayjs-core/lib/attributes/Float3Attributes":undefined,"awayjs-core/lib/attributes/Short3Attributes":undefined,"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/library/AssetBase":undefined}],"awayjs-display/lib/graphics/ElementsType":[function(t,e,i){"use strict";var r=function(){function t(){}t.TRIANGLE="triangle";t.LINE="line";return t}();i.ElementsType=r},{}],"awayjs-display/lib/graphics/Graphics":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/geom/Point");var n=t("awayjs-core/lib/geom/Box");var a=t("awayjs-core/lib/library/AssetBase");var o=t("../graphics/Graphic");var l=t("../events/ElementsEvent");var h=t("../events/StyleEvent");var p=t("../draw/GraphicsPath");var u=t("../draw/GraphicsFactoryFills");var c=t("../draw/GraphicsFactoryStrokes");var f=t("awayjs-core/lib/errors/PartialImplementationError");var d=t("../draw/JointStyle");var _=t("../draw/CapsStyle");var y=t("../draw/GraphicsStrokeStyle");var v=t("../draw/GraphicsFillStyle");var m=function(t){r(e,t);function e(){var e=this;t.call(this);this._boxBoundsInvalid=true;this._sphereBoundsInvalid=true;this._graphics=new Array;this._current_position=new s.Point;this._current_position=new s.Point;this._queued_fill_pathes=[];this._queued_stroke_pathes=[];this._active_fill_path=null;this._active_stroke_path=null;this._onInvalidatePropertiesDelegate=function(t){return e._onInvalidateProperties(t)};this._onInvalidateVerticesDelegate=function(t){return e._onInvalidateVertices(t)}}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"count",{get:function(){return this._graphics.length},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"animator",{get:function(){return this._animator},set:function(t){this._animator=t;var e=this._graphics.length;var i;for(var r=0;r<e;++r){i=this._graphics[r];if(i.material){i.material.iRemoveOwner(i);i.material.iAddOwner(i)}i.invalidateElements()}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){if(this._style==t)return;if(this._style)this._style.removeEventListener(h.StyleEvent.INVALIDATE_PROPERTIES,this._onInvalidatePropertiesDelegate);this._style=t;if(this._style)this._style.addEventListener(h.StyleEvent.INVALIDATE_PROPERTIES,this._onInvalidatePropertiesDelegate);this._iInvalidateSurfaces()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"queued_stroke_pathes",{get:function(){return this._queued_stroke_pathes},set:function(t){this._queued_stroke_pathes=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"queued_fill_pathes",{get:function(){return this._queued_fill_pathes},set:function(t){this._queued_fill_pathes=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"material",{get:function(){return this._material},set:function(t){if(t==this._material)return;var e;var i=this._graphics.length;var r;if(this._material)for(e=0;e<i;e++)if(!(r=this._graphics[e])._iGetExplicitMaterial())this._material.iRemoveOwner(r);this._material=t;if(this._material)for(e=0;e<i;e++)if(!(r=this._graphics[e])._iGetExplicitMaterial())this._material.iAddOwner(r)},enumerable:true,configurable:true});e.prototype.addGraphic=function(t,e,i,r,s){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=0}if(s===void 0){s=0}var n;if(o.Graphic._available.length){n=o.Graphic._available.pop();n._iIndex=this._graphics.length;n.parent=this;n.elements=t;n.material=e;n.style=i;n.count=r;n.offset=s}else{n=new o.Graphic(this._graphics.length,this,t,e,i,r,s)}this._graphics.push(n);n.addEventListener(l.ElementsEvent.INVALIDATE_VERTICES,this._onInvalidateVerticesDelegate);this.invalidate();return n};e.prototype.removeGraphic=function(t){this._graphics.splice(this._graphics.indexOf(t),1);t.removeEventListener(l.ElementsEvent.INVALIDATE_VERTICES,this._onInvalidateVerticesDelegate);t.elements=null;t.material=null;t.style=null;t.clear();this.invalidate()};e.prototype.getGraphicAt=function(t){return this._graphics[t]};e.prototype.applyTransformation=function(t){var e=this._graphics.length;for(var i=0;i<e;++i)this._graphics[i].applyTransformation(t)};e.prototype.copyTo=function(t){t.material=this._material;t.style=this.style;t.particles=this.particles;t.numParticles=this.numParticles;var e;var i=this._graphics.length;for(var r=0;r<i;++r){e=this._graphics[r];t.addGraphic(e.elements,e._iGetExplicitMaterial(),e._iGetExplicitStyle(),e.count,e.offset)}if(this._animator)t.animator=this._animator.clone()};e.prototype.clone=function(){var t=new e;this.copyTo(t);return t};e.prototype.scale=function(t){var e=this._graphics.length;for(var i=0;i<e;++i)this._graphics[i].scale(t)};e.prototype.clear=function(){for(var t=this._graphics.length-1;t>=0;t--){this._graphics[t].clear()}};e.prototype.dispose=function(){this.material=null;for(var t=this._graphics.length-1;t>=0;t--)this._graphics[t].dispose();if(this._animator)this._animator.dispose()};e.prototype.scaleUV=function(t,e){if(t===void 0){t=1}if(e===void 0){e=1}var i=this._graphics.length;for(var r=0;r<i;++r)this._graphics[r].scaleUV(t,e)};e.prototype.getBoxBounds=function(){if(this._boxBoundsInvalid){this._boxBoundsInvalid=false;if(!this._boxBounds)this._boxBounds=new n.Box;if(this._graphics.length){this._boxBounds.setBoundIdentity();var t=this._graphics.length;for(var e=0;e<t;e++)this._boxBounds=this._boxBounds.union(this._graphics[e].getBoxBounds(),this._boxBounds)}else{this._boxBounds.setEmpty()}}return this._boxBounds};e.prototype.getSphereBounds=function(t,e){if(e===void 0){e=null}var i=this._graphics.length;for(var r=0;r<i;r++)e=this._graphics[r].getSphereBounds(t,e);return e};e.prototype.invalidate=function(){t.prototype.invalidate.call(this);this._boxBoundsInvalid=true;this._sphereBoundsInvalid=true};e.prototype._iInvalidateSurfaces=function(){var t=this._graphics.length;for(var e=0;e<t;++e)this._graphics[e].invalidateSurface()};e.prototype.invalidateElements=function(){var t=this._graphics.length;for(var e=0;e<t;++e)this._graphics[e].invalidateElements()};e.prototype._hitTestPointInternal=function(t,e){var i=this._graphics.length;for(var r=0;r<i;r++)if(this._graphics[r].hitTestPoint(t,e,0))return true;return false};e.prototype.acceptTraverser=function(t){var e=this._graphics.length;for(var i=0;i<e;i++)t.applyRenderable(this._graphics[i])};e.prototype._onInvalidateProperties=function(t){this._iInvalidateSurfaces()};e.prototype._onInvalidateVertices=function(t){if(t.attributesView!=t.target.positions)return;this.invalidate()};e.prototype.draw_fills=function(){u.GraphicsFactoryFills.draw_pathes(this)};e.prototype.draw_strokes=function(){c.GraphicsFactoryStrokes.draw_pathes(this)};e.prototype.beginBitmapFill=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=true}if(r===void 0){r=false}this.draw_fills();this._active_fill_path=new p.GraphicsPath;this._active_fill_path.style=new v.GraphicsFillStyle(16777215,1);if(this._current_position.x!=0||this._current_position.y!=0)this._active_fill_path.moveTo(this._current_position.x,this._current_position.y);this._queued_fill_pathes.push(this._active_fill_path)};e.prototype.beginFill=function(t,e){if(e===void 0){e=1}this.draw_fills();this._active_fill_path=new p.GraphicsPath;this._active_fill_path.style=new v.GraphicsFillStyle(t,e);if(this._current_position.x!=0||this._current_position.y!=0)this._active_fill_path.moveTo(this._current_position.x,this._current_position.y);this._queued_fill_pathes.push(this._active_fill_path)};e.prototype.beginGradientFill=function(t,e,i,r,s,n,a,o){if(s===void 0){s=null}if(n===void 0){n="pad"}if(a===void 0){a="rgb"}if(o===void 0){o=0}this.draw_fills();this._active_fill_path=new p.GraphicsPath;this._active_fill_path.style=new v.GraphicsFillStyle(e[0],i[0]);if(this._current_position.x!=0||this._current_position.y!=0)this._active_fill_path.moveTo(this._current_position.x,this._current_position.y);
this._queued_fill_pathes.push(this._active_fill_path)};e.prototype.copyFrom=function(t){t.copyTo(this)};e.prototype.cubicCurveTo=function(t,e,i,r,s,n){throw new f.PartialImplementationError("cubicCurveTo")};e.prototype.curveTo=function(t,e,i,r){if(this._active_fill_path!=null){this._active_fill_path.curveTo(t,e,i,r)}if(this._active_stroke_path!=null){this._active_stroke_path.curveTo(t,e,i,r)}this._current_position.x=i;this._current_position.y=r};e.prototype.drawCircle=function(t,e,i){var r=i*1.065;if(this._active_fill_path!=null){this._active_fill_path.moveTo(t-i,e);for(var s=8;s>=0;s--){var n=s*(360/8)*Math.PI/180;var a=n+360/16*Math.PI/180;this._active_fill_path.curveTo(t-Math.cos(a)*r,e+Math.sin(a)*r,t-Math.cos(n)*i,e+Math.sin(n)*i)}}if(this._active_stroke_path!=null){this._active_stroke_path.moveTo(t,e+i);var r=i*.93;this._active_stroke_path.curveTo(t-r,e+r,t-i,e);this._active_stroke_path.curveTo(t-r,e-r,t,e-i);this._active_stroke_path.curveTo(t+r,e-r,t+i,e);this._active_stroke_path.curveTo(t+r,e+r,t,e+i)}};e.prototype.drawEllipse=function(t,e,i,r){i/=2;r/=2;if(this._active_fill_path!=null){this._active_fill_path.moveTo(t,e+r);this._active_fill_path.curveTo(t-i,e+r,t-i,e);this._active_fill_path.curveTo(t-i,e-r,t,e-r);this._active_fill_path.curveTo(t+i,e-r,t+i,e);this._active_fill_path.curveTo(t+i,e+r,t,e+r)}if(this._active_stroke_path!=null){this._active_stroke_path.moveTo(t,e+r);this._active_stroke_path.curveTo(t-i,e+r,t-i,e);this._active_stroke_path.curveTo(t-i,e-r,t,e-r);this._active_stroke_path.curveTo(t+i,e-r,t+i,e);this._active_stroke_path.curveTo(t+i,e+r,t,e+r)}};e.prototype.drawGraphicsData=function(t){};e.prototype.drawPath=function(t,e,i){};e.prototype.drawRect=function(t,e,i,r){if(this._active_fill_path!=null){this._active_fill_path.moveTo(t,e);this._active_fill_path.lineTo(t+i,e);this._active_fill_path.lineTo(t+i,e+r);this._active_fill_path.lineTo(t,e+r);this._active_fill_path.lineTo(t,e)}if(this._active_stroke_path!=null){this._active_stroke_path.moveTo(t,e);this._active_stroke_path.lineTo(t+i,e);this._active_stroke_path.lineTo(t+i,e+r);this._active_stroke_path.lineTo(t,e+r);this._active_stroke_path.lineTo(t,e)}};e.prototype.drawRoundRect=function(t,e,i,r,s,n){if(n===void 0){n=NaN}if(!n){n=s}if(this._active_fill_path!=null){this._active_fill_path.moveTo(t+s,e);this._active_fill_path.lineTo(t+i-s,e);this._active_fill_path.curveTo(t+i,e,t+i,e+n);this._active_fill_path.lineTo(t+i,e+r-n);this._active_fill_path.curveTo(t+i,e+r,t+i-s,e+r);this._active_fill_path.lineTo(t+s,e+r);this._active_fill_path.curveTo(t,e+r,t,e+r-n);this._active_fill_path.lineTo(t,e+n);this._active_fill_path.curveTo(t,e,t+s,e)}if(this._active_stroke_path!=null){this._active_stroke_path.moveTo(t+s,e);this._active_stroke_path.lineTo(t+i-s,e);this._active_stroke_path.curveTo(t+i,e,t+i,e+n);this._active_stroke_path.lineTo(t+i,e+r-n);this._active_stroke_path.curveTo(t+i,e+r,t+i-s,e+r);this._active_stroke_path.lineTo(t+s,e+r);this._active_stroke_path.curveTo(t,e+r,t,e+r-n);this._active_stroke_path.lineTo(t,e+n);this._active_stroke_path.curveTo(t,e,t+s,e)}};e.prototype.drawTriangles=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=null}if(this._active_fill_path!=null){}if(this._active_stroke_path!=null){}};e.prototype.endFill=function(){this.draw_strokes();this.draw_fills();this._active_fill_path=null;this._active_stroke_path=null};e.prototype.lineBitmapStyle=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=true}if(r===void 0){r=false}this._active_stroke_path=new p.GraphicsPath;if(this._current_position.x!=0||this._current_position.y!=0)this._active_stroke_path.moveTo(this._current_position.x,this._current_position.y);this._queued_stroke_pathes.push(this._active_stroke_path)};e.prototype.lineGradientStyle=function(t,e,i,r,s,n,a,o){if(s===void 0){s=null}if(n===void 0){n=null}if(a===void 0){a=null}if(o===void 0){o=0}this._active_stroke_path=new p.GraphicsPath;if(this._current_position.x!=0||this._current_position.y!=0)this._active_stroke_path.moveTo(this._current_position.x,this._current_position.y);this._queued_stroke_pathes.push(this._active_stroke_path)};e.prototype.lineStyle=function(t,e,i,r,s,n,a,o){if(t===void 0){t=0}if(e===void 0){e=0}if(i===void 0){i=1}if(r===void 0){r=false}if(s===void 0){s=null}if(n===void 0){n=_.CapsStyle.NONE}if(a===void 0){a=d.JointStyle.MITER}if(o===void 0){o=100}this._active_stroke_path=new p.GraphicsPath;this._active_stroke_path.style=new y.GraphicsStrokeStyle(e,i,t,a,n,o);if(this._current_position.x!=0||this._current_position.y!=0)this._active_stroke_path.moveTo(this._current_position.x,this._current_position.y);this._queued_stroke_pathes.push(this._active_stroke_path)};e.prototype.lineTo=function(t,e){if(this._active_fill_path!=null){this._active_fill_path.lineTo(t,e)}if(this._active_stroke_path!=null){this._active_stroke_path.lineTo(t,e)}this._current_position.x=t;this._current_position.y=e};e.prototype.moveTo=function(t,e){if(this._active_fill_path!=null){this._active_fill_path.moveTo(t,e)}if(this._active_stroke_path!=null){this._active_stroke_path.moveTo(t,e)}this._current_position.x=t;this._current_position.y=e};e.assetType="[asset Graphics]";return e}(a.AssetBase);i.Graphics=m},{"../draw/CapsStyle":"awayjs-display/lib/draw/CapsStyle","../draw/GraphicsFactoryFills":"awayjs-display/lib/draw/GraphicsFactoryFills","../draw/GraphicsFactoryStrokes":"awayjs-display/lib/draw/GraphicsFactoryStrokes","../draw/GraphicsFillStyle":"awayjs-display/lib/draw/GraphicsFillStyle","../draw/GraphicsPath":"awayjs-display/lib/draw/GraphicsPath","../draw/GraphicsStrokeStyle":"awayjs-display/lib/draw/GraphicsStrokeStyle","../draw/JointStyle":"awayjs-display/lib/draw/JointStyle","../events/ElementsEvent":"awayjs-display/lib/events/ElementsEvent","../events/StyleEvent":"awayjs-display/lib/events/StyleEvent","../graphics/Graphic":"awayjs-display/lib/graphics/Graphic","awayjs-core/lib/errors/PartialImplementationError":undefined,"awayjs-core/lib/geom/Box":undefined,"awayjs-core/lib/geom/Point":undefined,"awayjs-core/lib/library/AssetBase":undefined}],"awayjs-display/lib/graphics/Graphic":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/geom/Box");var n=t("awayjs-core/lib/library/AssetBase");var a=t("../events/RenderableEvent");var o=t("../events/StyleEvent");var l=function(t){r(e,t);function e(e,i,r,s,n,a,o){var l=this;if(s===void 0){s=null}if(n===void 0){n=null}if(a===void 0){a=0}if(o===void 0){o=0}t.call(this);this._iIndex=0;this._boxBoundsInvalid=true;this._sphereBoundsInvalid=true;this._onInvalidatePropertiesDelegate=function(t){return l._onInvalidateProperties(t)};this._onInvalidateVerticesDelegate=function(t){return l._onInvalidateVertices(t)};this._iIndex=e;this.parent=i;this.elements=r;this.material=s;this.style=n;this.count=a;this.offset=o}Object.defineProperty(e.prototype,"elements",{get:function(){return this._elements},set:function(t){if(this._elements==t)return;this._elements=t;this.invalidateElements()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"animator",{get:function(){return this.parent.animator},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"material",{get:function(){return this._material||this.parent.material},set:function(t){if(this.material)this.material.iRemoveOwner(this);this._material=t;if(this.material)this.material.iAddOwner(this)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"style",{get:function(){return this._style||this.parent.style},set:function(t){if(this._style==t)return;if(this._style)this._style.removeEventListener(o.StyleEvent.INVALIDATE_PROPERTIES,this._onInvalidatePropertiesDelegate);this._style=t;if(this._style)this._style.addEventListener(o.StyleEvent.INVALIDATE_PROPERTIES,this._onInvalidatePropertiesDelegate);this.invalidateSurface()},enumerable:true,configurable:true});e.prototype.dispose=function(){t.prototype.dispose.call(this);this.parent.removeGraphic(this);this.parent=null;e._available.push(this)};e.prototype.invalidate=function(){t.prototype.invalidate.call(this);this._boxBoundsInvalid=true;this._sphereBoundsInvalid=true};e.prototype.invalidateElements=function(){this.dispatchEvent(new a.RenderableEvent(a.RenderableEvent.INVALIDATE_ELEMENTS,this));this._boxBoundsInvalid=true;this._sphereBoundsInvalid=true};e.prototype.invalidateSurface=function(){this.dispatchEvent(new a.RenderableEvent(a.RenderableEvent.INVALIDATE_SURFACE,this))};e.prototype._iGetExplicitMaterial=function(){return this._material};e.prototype._iGetExplicitStyle=function(){return this._style};e.prototype._onInvalidateProperties=function(t){this.invalidateSurface()};e.prototype._onInvalidateVertices=function(t){if(t.attributesView!=t.target.positions)return;this.invalidate();this.dispatchEvent(t)};e.prototype._iTestCollision=function(t,e){return this._elements._iTestCollision(e,this.material,t,this.count,this.offset)};e.prototype.applyTransformation=function(t){this._elements.applyTransformation(t,this.count,this.offset)};e.prototype.hitTestPoint=function(t,e,i){var r;if(!(r=this.getBoxBounds()).contains(t,e,i))return false;return this._elements.hitTestPoint(t,e,i,r,this.count,this.offset)};e.prototype.scale=function(t){this._elements.scale(t,this.count,this.offset)};e.prototype.scaleUV=function(t,e){if(t===void 0){t=1}if(e===void 0){e=1}this._elements.scaleUV(t,e,this.count,this.offset)};e.prototype.getBoxBounds=function(){if(this._boxBoundsInvalid){this._boxBoundsInvalid=false;this._boxBounds=this._elements.getBoxBounds(this._boxBounds||(this._boxBounds=new s.Box),this.count,this.offset)}return this._boxBounds};e.prototype.getSphereBounds=function(t,e){if(e===void 0){e=null}return this._elements.getSphereBounds(t,e,this.count,this.offset)};e._available=new Array;e.assetType="[asset Graphic]";return e}(n.AssetBase);i.Graphic=l},{"../events/RenderableEvent":"awayjs-display/lib/events/RenderableEvent","../events/StyleEvent":"awayjs-display/lib/events/StyleEvent","awayjs-core/lib/geom/Box":undefined,"awayjs-core/lib/library/AssetBase":undefined}],"awayjs-display/lib/graphics/HitTestCache":[function(t,e,i){"use strict";var r=function(){function t(){this.cells=new Array;this.lastCollisionIndex=-1}return t}();i.HitTestCache=r},{}],"awayjs-display/lib/graphics/LineElements":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/attributes/AttributesView");var n=t("awayjs-core/lib/attributes/Byte4Attributes");var a=t("awayjs-core/lib/attributes/Float1Attributes");var o=t("../graphics/ElementsBase");var l=t("../utils/ElementsUtils");var h=function(t){r(e,t);function e(e){if(e===void 0){e=null}t.call(this,e);this._positions=new s.AttributesView(Float32Array,6,e)}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"thickness",{get:function(){return this._thickness},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"colors",{get:function(){if(!this._colors)this.setColors(this._colors);return this._colors},enumerable:true,configurable:true});e.prototype.getBoxBounds=function(t){if(t===void 0){t=null}return t};e.prototype.getSphereBounds=function(t,e){if(e===void 0){e=null}return e};e.prototype.setPositions=function(t,e){if(e===void 0){e=0}if(t instanceof s.AttributesView){this.clearVertices(this._positions);this._positions=t}else if(t){var i=0;var r=0;var n=0;var a=new Float32Array(t.length*4);var o=new Uint16Array(t.length);while(i<t.length){if(n/6&1){a[n]=t[i+3];a[n+1]=t[i+4];a[n+2]=t[i+5];a[n+3]=t[i];a[n+4]=t[i+1];a[n+5]=t[i+2]}else{a[n]=t[i];a[n+1]=t[i+1];a[n+2]=t[i+2];a[n+3]=t[i+3];a[n+4]=t[i+4];a[n+5]=t[i+5]}n+=6;if(++r==4){var l=n/6-4;o.set([l,l+1,l+2,l+3,l+2,l+1],i);r=0;i+=6}}this._positions.set(a,e*4);this.setIndices(o,e)}else{this.clearVertices(this._positions);this._positions=new s.AttributesView(Float32Array,6,this._concatenatedBuffer)}this._numVertices=this._positions.count;this.invalidateVertices(this._positions);this._verticesDirty[this._positions.id]=false};e.prototype.setThickness=function(t,e){if(e===void 0){e=0}if(t instanceof a.Float1Attributes){this._thickness=t}else if(t){if(!this._thickness)this._thickness=new a.Float1Attributes(this._concatenatedBuffer);var i=0;var r=0;var s=0;var n=new Float32Array(t.length*4);while(i<t.length){n[s]=Math.floor(.5*s+.5)&1?-t[i]:t[i];if(++r==4){r=0;i++}s++}this._thickness.set(n,e*4)}else if(this._thickness){this._thickness.dispose();this._thickness=null}this.invalidateVertices(this._thickness);this._verticesDirty[this._thickness.id]=false};e.prototype.setColors=function(t,e){if(e===void 0){e=0}if(t){if(t==this._colors)return;if(t instanceof n.Byte4Attributes){this.clearVertices(this._colors);this._colors=t}else{if(!this._colors)this._colors=new n.Byte4Attributes(this._concatenatedBuffer);var i=0;var r=0;var s=0;var a=new Uint8Array(t.length*4);while(i<t.length){if(s/4&1){a[s]=t[i+4];a[s+1]=t[i+5];a[s+2]=t[i+6];a[s+3]=t[i+7]}else{a[s]=t[i];a[s+1]=t[i+1];a[s+2]=t[i+2];a[s+3]=t[i+3]}if(++r==4){r=0;i+=8}s+=4}this._colors.set(a,e*4)}}else{this._colors=l.ElementsUtils.generateColors(this.indices,this._colors,this._concatenatedBuffer,this._numVertices)}this.invalidateVertices(this._colors);this._verticesDirty[this._colors.id]=false};e.prototype.dispose=function(){t.prototype.dispose.call(this);this._positions.dispose();this._positions=null;this._thickness.dispose();this._thickness=null;this._colors.dispose();this._colors=null};e.prototype.clone=function(){var t=new e(this._concatenatedBuffer?this._concatenatedBuffer.clone():null);t.setIndices(this.indices.clone());t.setPositions(this._positions.clone());t.setThickness(this._thickness.clone());t.setColors(this._colors.clone());return t};e.prototype._iTestCollision=function(t,e,i,r,s){if(r===void 0){r=0}if(s===void 0){s=0}return t.testLineCollision(this,e,i,r||this._numVertices,s)};e.assetType="[asset LineElements]";return e}(o.ElementsBase);i.LineElements=h},{"../graphics/ElementsBase":"awayjs-display/lib/graphics/ElementsBase","../utils/ElementsUtils":"awayjs-display/lib/utils/ElementsUtils","awayjs-core/lib/attributes/AttributesView":undefined,"awayjs-core/lib/attributes/Byte4Attributes":undefined,"awayjs-core/lib/attributes/Float1Attributes":undefined}],"awayjs-display/lib/graphics/TriangleElements":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/attributes/AttributesView");var n=t("awayjs-core/lib/attributes/Float3Attributes");var a=t("awayjs-core/lib/attributes/Float2Attributes");var o=t("../graphics/ElementsBase");var l=t("../utils/ElementsUtils");var h=function(t){r(e,t);function e(){t.apply(this,arguments);this._faceNormalsDirty=true;this._faceTangentsDirty=true;this._autoDeriveNormals=true;this._autoDeriveTangents=true;this.hitTestCache=new Object}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"useCondensedIndices",{get:function(){return this._useCondensedIndices},set:function(t){if(this._useCondensedIndices==t)return;this._useCondensedIndices=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"jointsPerVertex",{get:function(){return this._jointsPerVertex},set:function(t){if(this._jointsPerVertex==t)return;this._jointsPerVertex=t;if(this._jointIndices)this._jointIndices.dimensions=this._jointsPerVertex;if(this._jointWeights)this._jointWeights.dimensions=this._jointsPerVertex},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"autoDeriveNormals",{get:function(){return this._autoDeriveNormals},set:function(t){if(this._autoDeriveNormals==t)return;this._autoDeriveNormals=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"autoDeriveTangents",{get:function(){return this._autoDeriveTangents},set:function(t){if(this._autoDeriveTangents==t)return;this._autoDeriveTangents=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"positions",{get:function(){if(!this._positions)this.setPositions(new n.Float3Attributes(this._concatenatedBuffer));return this._positions},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"normals",{get:function(){if(!this._normals||this._verticesDirty[this._normals.id])this.setNormals(this._normals);return this._normals},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"tangents",{get:function(){if(!this._tangents||this._verticesDirty[this._tangents.id])this.setTangents(this._tangents);return this._tangents},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"faceNormals",{get:function(){if(this._faceNormalsDirty)this.updateFaceNormals();return this._faceNormals},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"faceTangents",{get:function(){if(this._faceTangentsDirty)this.updateFaceTangents();return this._faceTangents},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"uvs",{get:function(){return this._uvs},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"jointIndices",{get:function(){return this._jointIndices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"jointWeights",{get:function(){return this._jointWeights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"condensedIndexLookUp",{get:function(){return this._condensedIndexLookUp},enumerable:true,configurable:true});e.prototype.getBoxBounds=function(t,e,i){if(t===void 0){t=null}if(e===void 0){e=0}if(i===void 0){i=0}return l.ElementsUtils.getTriangleGraphicsBoxBounds(this.positions,t,e||this._numVertices,i)};e.prototype.getSphereBounds=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=0}if(r===void 0){r=0}return l.ElementsUtils.getTriangleGraphicsSphereBounds(this.positions,t,e,i||this._numVertices,r)};e.prototype.hitTestPoint=function(t,e,i,r,s,n){if(s===void 0){s=0}if(n===void 0){n=0}return l.ElementsUtils.hitTestTriangleElements(t,e,0,r,this,s||this._numVertices,n)};e.prototype.setPositions=function(t,e){if(e===void 0){e=0}if(t==this._positions)return;if(t instanceof s.AttributesView){this.clearVertices(this._positions);this._positions=t}else if(t){if(!this._positions)this._positions=new n.Float3Attributes(this._concatenatedBuffer);this._positions.set(t,e)}else{this.clearVertices(this._positions);this._positions=new n.Float3Attributes(this._concatenatedBuffer)}this._numVertices=this._positions.count;if(this._autoDeriveNormals)this.invalidateVertices(this._normals);if(this._autoDeriveTangents)this.invalidateVertices(this._tangents);this.invalidateVertices(this._positions);this._verticesDirty[this._positions.id]=false};e.prototype.setNormals=function(t,e){if(e===void 0){e=0}if(!this._autoDeriveNormals){if(t==this._normals)return;if(t instanceof n.Float3Attributes){this.clearVertices(this._normals);this._normals=t}else if(t){if(!this._normals)this._normals=new n.Float3Attributes(this._concatenatedBuffer);this._normals.set(t,e)}else if(this._normals){this.clearVertices(this._normals);this._normals=null;return}}else{this._normals=l.ElementsUtils.generateNormals(this.indices,this.faceNormals,this._normals,this._concatenatedBuffer)}this.invalidateVertices(this._normals);this._verticesDirty[this._normals.id]=false};e.prototype.setTangents=function(t,e){if(e===void 0){e=0}if(!this._autoDeriveTangents){if(t==this._tangents)return;if(t instanceof n.Float3Attributes){this.clearVertices(this._tangents);this._tangents=t}else if(t){if(!this._tangents)this._tangents=new n.Float3Attributes(this._concatenatedBuffer);this._tangents.set(t,e)}else if(this._tangents){this.clearVertices(this._tangents);this._tangents=null;return}}else{this._tangents=l.ElementsUtils.generateTangents(this.indices,this.faceTangents,this.faceNormals,this._tangents,this._concatenatedBuffer)}this.invalidateVertices(this._tangents);this._verticesDirty[this._tangents.id]=false};e.prototype.setUVs=function(t,e){if(e===void 0){e=0}if(t==this._uvs)return;if(t instanceof s.AttributesView){this.clearVertices(this._uvs);this._uvs=t}else if(t){if(!this._uvs)this._uvs=new a.Float2Attributes(this._concatenatedBuffer);this._uvs.set(t,e)}else if(this._uvs){this.clearVertices(this._uvs);this._uvs=null;return}this.invalidateVertices(this._uvs);this._verticesDirty[this._uvs.id]=false};e.prototype.setJointIndices=function(t,e){if(e===void 0){e=0}if(t==this._jointIndices)return;if(t instanceof s.AttributesView){this.clearVertices(this._jointIndices);this._jointIndices=t}else if(t){if(!this._jointIndices)this._jointIndices=new s.AttributesView(Float32Array,this._jointsPerVertex,this._concatenatedBuffer);if(this._useCondensedIndices){var i=0;var r;var n=0;var a=new Object;this._condensedIndexLookUp=new Array;while(i<t.length){r=t[i];if(a[r]==undefined){a[r]=n;this._condensedIndexLookUp[n++]=r}t[i++]=a[r]}}this._jointIndices.set(t,e)}else if(this._jointIndices){this.clearVertices(this._jointIndices);this._jointIndices=null;return}this.invalidateVertices(this._jointIndices);this._verticesDirty[this._jointIndices.id]=false};e.prototype.setJointWeights=function(t,e){if(e===void 0){e=0}if(t==this._jointWeights)return;if(t instanceof s.AttributesView){this.clearVertices(this._jointWeights);this._jointWeights=t}else if(t){if(!this._jointWeights)this._jointWeights=new s.AttributesView(Float32Array,this._jointsPerVertex,this._concatenatedBuffer);this._jointWeights.set(t,e)}else if(this._jointWeights){this.clearVertices(this._jointWeights);this._jointWeights=null;return}this.invalidateVertices(this._jointWeights);this._verticesDirty[this._jointWeights.id]=false};e.prototype.dispose=function(){t.prototype.dispose.call(this);if(this._positions){this._positions.dispose();this._positions=null}if(this._normals){this._normals.dispose();this._normals=null}if(this._tangents){this._tangents.dispose();this._tangents=null}if(this._uvs){this._uvs.dispose();this._uvs=null}if(this._jointIndices){this._jointIndices.dispose();this._jointIndices=null}if(this._jointWeights){this._jointWeights.dispose();this._jointWeights=null}if(this._faceNormals){this._faceNormals.dispose();this._faceNormals=null}if(this._faceTangents){this._faceTangents.dispose();this._faceTangents=null}};e.prototype.setIndices=function(e,i){if(i===void 0){i=0}t.prototype.setIndices.call(this,e,i);this._faceNormalsDirty=true;this._faceTangentsDirty=true;if(this._autoDeriveNormals)this.invalidateVertices(this._normals);if(this._autoDeriveTangents)this.invalidateVertices(this._tangents)};e.prototype.copyTo=function(e){t.prototype.copyTo.call(this,e);var i=this._autoDeriveNormals;var r=this._autoDeriveTangents;e.autoDeriveNormals=this._autoDeriveNormals=false;e.autoDeriveTangents=this._autoDeriveTangents=false;e.setPositions(this.positions.clone());if(this.normals)e.setNormals(this.normals.clone());if(this.tangents)e.setTangents(this.tangents.clone());if(this.uvs)e.setUVs(this.uvs.clone());e.jointsPerVertex=this._jointsPerVertex;if(this.jointIndices)e.setJointIndices(this.jointIndices.clone());if(this.jointWeights)e.setJointWeights(this.jointWeights.clone());e.autoDeriveNormals=this._autoDeriveNormals=i;e.autoDeriveTangents=this._autoDeriveTangents=r};e.prototype.clone=function(){var t=new e(this._concatenatedBuffer?this._concatenatedBuffer.clone():null);this.copyTo(t);return t};e.prototype.scaleUV=function(t,e,i,r){if(t===void 0){t=1}if(e===void 0){e=1}if(i===void 0){i=0}if(r===void 0){r=0}if(this.uvs)l.ElementsUtils.scale(t,e,0,this.uvs,i||this._numVertices,r)};e.prototype.scale=function(t,e,i){if(e===void 0){e=0}if(i===void 0){i=0}l.ElementsUtils.scale(t,t,t,this.positions,e||this._numVertices,i)};e.prototype.applyTransformation=function(t,e,i){if(e===void 0){e=0}if(i===void 0){i=0}l.ElementsUtils.applyTransformation(t,this.positions,this.normals,this.tangents,e||this._numVertices,i)};e.prototype.updateFaceTangents=function(){this._faceTangents=l.ElementsUtils.generateFaceTangents(this.indices,this.positions,this.uvs||this.positions,this._faceTangents,this.numElements);this._faceTangentsDirty=false};e.prototype.updateFaceNormals=function(){this._faceNormals=l.ElementsUtils.generateFaceNormals(this.indices,this.positions,this._faceNormals,this.numElements);this._faceNormalsDirty=false};e.prototype._iTestCollision=function(t,e,i,r,s){if(r===void 0){r=0}if(s===void 0){s=0}return t.testTriangleCollision(this,e,i,r||this._numVertices,s)};e.assetType="[asset TriangleElements]";return e}(o.ElementsBase);i.TriangleElements=h},{"../graphics/ElementsBase":"awayjs-display/lib/graphics/ElementsBase","../utils/ElementsUtils":"awayjs-display/lib/utils/ElementsUtils","awayjs-core/lib/attributes/AttributesView":undefined,"awayjs-core/lib/attributes/Float2Attributes":undefined,"awayjs-core/lib/attributes/Float3Attributes":undefined}],"awayjs-display/lib/graphics":[function(t,e,i){"use strict";var r=t("./graphics/ElementsBase");i.ElementsBase=r.ElementsBase;var s=t("./graphics/ElementsType");i.ElementsType=s.ElementsType;var n=t("./graphics/Graphic");i.Graphic=n.Graphic;var a=t("./graphics/Graphics");i.Graphics=a.Graphics;var o=t("./graphics/LineElements");i.LineElements=o.LineElements;var l=t("./graphics/TriangleElements");i.TriangleElements=l.TriangleElements},{"./graphics/ElementsBase":"awayjs-display/lib/graphics/ElementsBase","./graphics/ElementsType":"awayjs-display/lib/graphics/ElementsType","./graphics/Graphic":"awayjs-display/lib/graphics/Graphic","./graphics/Graphics":"awayjs-display/lib/graphics/Graphics","./graphics/LineElements":"awayjs-display/lib/graphics/LineElements","./graphics/TriangleElements":"awayjs-display/lib/graphics/TriangleElements"}],"awayjs-display/lib/managers/DefaultMaterialManager":[function(t,e,i){"use strict";var r=t("awayjs-core/lib/image/Sampler2D");var s=t("awayjs-core/lib/image/BitmapImage2D");var n=t("awayjs-core/lib/image/BitmapImageCube");var a=t("../graphics/LineElements");var o=t("../display/Skybox");var l=t("../materials/BasicMaterial");var h=t("../textures/Single2DTexture");var p=t("../textures/SingleCubeTexture");var u=t("../graphics/Graphic");var c=function(){function t(){}t.getDefaultMaterial=function(e){if(e===void 0){e=null}if(e!=null&&e.isAsset(u.Graphic)&&e.elements.isAsset(a.LineElements)){if(!t._defaultColorMaterial)t.createDefaultColorMaterial();return t._defaultColorMaterial}if(e!=null&&e.isAsset(o.Skybox)){if(!t._defaultCubeTextureMaterial)t.createDefaultCubeTextureMaterial();return t._defaultCubeTextureMaterial}if(!t._defaultTextureMaterial)t.createDefaultTextureMaterial();return t._defaultTextureMaterial};t.getDefaultTexture=function(e){if(e===void 0){e=null}if(e!=null&&e.isAsset(o.Skybox)){if(!t._defaultCubeTexture)t.createDefaultCubeTexture();return t._defaultCubeTexture}if(!t._defaultTexture)t.createDefaultTexture();return t._defaultTexture};t.getDefaultImage2D=function(){if(!t._defaultBitmapImage2D)t.createDefaultImage2D();return t._defaultBitmapImage2D};t.getDefaultImageCube=function(){if(!t._defaultBitmapImageCube)t.createDefaultImageCube();return t._defaultBitmapImageCube};t.getDefaultSampler=function(){if(!t._defaultSampler2D)t.createDefaultSampler2D();return t._defaultSampler2D};t.createDefaultTexture=function(){t._defaultTexture=new h.Single2DTexture;t._defaultTexture.name="defaultTexture"};t.createDefaultCubeTexture=function(){t._defaultCubeTexture=new p.SingleCubeTexture;t._defaultCubeTexture.name="defaultCubeTexture"};t.createDefaultImageCube=function(){if(!t._defaultBitmapImage2D)t.createDefaultImage2D();var e=new n.BitmapImageCube(t._defaultBitmapImage2D.width);for(var i=0;i<6;i++)e.draw(i,t._defaultBitmapImage2D);t._defaultBitmapImageCube=e};t.createDefaultImage2D=function(){var e=new s.BitmapImage2D(8,8,false,0);var i,r;for(i=0;i<8;i++)for(r=0;r<8;r++)if(r&1^i&1)e.setPixel(i,r,16777215);t._defaultBitmapImage2D=e};t.createDefaultTextureMaterial=function(){if(!t._defaultTexture)t.createDefaultTexture();t._defaultTextureMaterial=new l.BasicMaterial;t._defaultTextureMaterial.texture=t._defaultTexture;t._defaultTextureMaterial.name="defaultTextureMaterial"};t.createDefaultCubeTextureMaterial=function(){if(!t._defaultCubeTexture)t.createDefaultCubeTexture();t._defaultCubeTextureMaterial=new l.BasicMaterial;t._defaultCubeTextureMaterial.texture=t._defaultCubeTexture;t._defaultCubeTextureMaterial.name="defaultCubeTextureMaterial"};t.createDefaultColorMaterial=function(){t._defaultColorMaterial=new l.BasicMaterial(16777215);t._defaultColorMaterial.name="defaultColorMaterial"};t.createDefaultSampler2D=function(){t._defaultSampler2D=new r.Sampler2D};return t}();i.DefaultMaterialManager=c},{"../display/Skybox":"awayjs-display/lib/display/Skybox","../graphics/Graphic":"awayjs-display/lib/graphics/Graphic","../graphics/LineElements":"awayjs-display/lib/graphics/LineElements","../materials/BasicMaterial":"awayjs-display/lib/materials/BasicMaterial","../textures/Single2DTexture":"awayjs-display/lib/textures/Single2DTexture","../textures/SingleCubeTexture":"awayjs-display/lib/textures/SingleCubeTexture","awayjs-core/lib/image/BitmapImage2D":undefined,"awayjs-core/lib/image/BitmapImageCube":undefined,"awayjs-core/lib/image/Sampler2D":undefined}],"awayjs-display/lib/managers/FrameScriptManager":[function(t,e,i){"use strict";var r=function(){function t(){}t.setInterval=function(t){this._intervalID++;this._active_intervals[this._intervalID]=t;return this._intervalID};t.clearInterval=function(t){delete this._active_intervals[t]};t.execute_intervals=function(){for(var t in this._active_intervals){this._active_intervals[t].call()}};t.add_child_to_dispose=function(t){this._queued_dispose.push(t)};t.add_script_to_queue=function(t,e){var i=this._queued_mcs_pass2.length;while(i--){this._queued_mcs.push(this._queued_mcs_pass2[i]);this._queued_scripts.push(this._queued_scripts_pass2[i])}this._queued_mcs_pass2.length=0;this._queued_scripts_pass2.length=0;this._queued_mcs.push(t);this._queued_scripts.push(e)};t.add_script_to_queue_pass2=function(t,e){this._queued_mcs_pass2.push(t);this._queued_scripts_pass2.push(e)};t.execute_queue=function(){if(this._queued_mcs.length==0&&this._queued_mcs_pass2.length==0)return;var t=this._queued_mcs_pass2.length;while(t--){this._queued_mcs.push(this._queued_mcs_pass2[t]);this._queued_scripts.push(this._queued_scripts_pass2[t])}this._queued_mcs_pass2.length=0;this._queued_scripts_pass2.length=0;var e;for(t=0;t<this._queued_mcs.length;t++){e=this._queued_mcs[t];if(e.scene!=null){var i=e.adapter?e.adapter:e;this._queued_scripts[t].call(i)}}this._queued_mcs.length=0;this._queued_scripts.length=0};t.execute_dispose=function(){var t=this._queued_dispose.length;for(var e=0;e<t;e++)this._queued_dispose[e].dispose();this._queued_dispose.length=0};t.frameScriptDebug=undefined;t._queued_dispose=new Array;t._queued_mcs=[];t._queued_scripts=[];t._queued_mcs_pass2=[];t._queued_scripts_pass2=[];t._active_intervals=new Object;t._intervalID=0;return t}();i.FrameScriptManager=r;Object.defineProperty(i,"__esModule",{value:true});i.default=r},{}],"awayjs-display/lib/managers/MouseManager":[function(t,e,i){"use strict";var r=t("awayjs-core/lib/geom/Vector3D");var s=t("../base/TouchPoint");var n=t("../events/MouseEvent");var a=t("../managers/FrameScriptManager");var o=function(){function t(){var t=this;
this._viewLookup=new Array;this._nullVector=new r.Vector3D;this._queuedEvents=new Array;this._mouseUp=new n.MouseEvent(n.MouseEvent.MOUSE_UP);this._mouseClick=new n.MouseEvent(n.MouseEvent.CLICK);this._mouseOut=new n.MouseEvent(n.MouseEvent.MOUSE_OUT);this._mouseDown=new n.MouseEvent(n.MouseEvent.MOUSE_DOWN);this._mouseMove=new n.MouseEvent(n.MouseEvent.MOUSE_MOVE);this._mouseOver=new n.MouseEvent(n.MouseEvent.MOUSE_OVER);this._mouseWheel=new n.MouseEvent(n.MouseEvent.MOUSE_WHEEL);this._mouseDoubleClick=new n.MouseEvent(n.MouseEvent.DOUBLE_CLICK);this.onClickDelegate=function(e){return t.onClick(e)};this.onDoubleClickDelegate=function(e){return t.onDoubleClick(e)};this.onMouseDownDelegate=function(e){return t.onMouseDown(e)};this.onMouseMoveDelegate=function(e){return t.onMouseMove(e)};this.onMouseUpDelegate=function(e){return t.onMouseUp(e)};this.onMouseWheelDelegate=function(e){return t.onMouseWheel(e)};this.onMouseOverDelegate=function(e){return t.onMouseOver(e)};this.onMouseOutDelegate=function(e){return t.onMouseOut(e)}}t.getInstance=function(){if(this._instance)return this._instance;return this._instance=new t};t.prototype.fireMouseEvents=function(t){if(this._iCollision!=this._previousCollidingObject){if(this._previousCollidingObject)this.queueDispatch(this._mouseOut,this._mouseMoveEvent,this._previousCollidingObject);if(this._iCollision)this.queueDispatch(this._mouseOver,this._mouseMoveEvent)}if(t&&this._iCollision)this.queueDispatch(this._mouseMove,this._mouseMoveEvent);var e;var i;var r=this._queuedEvents.length;for(var s=0;s<r;++s){e=this._queuedEvents[s];i=e.entity;while(i){if(i._iIsMouseEnabled())i.dispatchEvent(e);i=i.parent}a.FrameScriptManager.execute_queue()}this._queuedEvents.length=0;this._previousCollidingObject=this._iCollision;this._iUpdateDirty=false};t.prototype.registerView=function(t){if(t&&t.htmlElement){t.htmlElement.addEventListener("click",this.onClickDelegate);t.htmlElement.addEventListener("dblclick",this.onDoubleClickDelegate);t.htmlElement.addEventListener("touchstart",this.onMouseDownDelegate);t.htmlElement.addEventListener("mousedown",this.onMouseDownDelegate);t.htmlElement.addEventListener("touchmove",this.onMouseMoveDelegate);t.htmlElement.addEventListener("mousemove",this.onMouseMoveDelegate);t.htmlElement.addEventListener("mouseup",this.onMouseUpDelegate);t.htmlElement.addEventListener("touchend",this.onMouseUpDelegate);t.htmlElement.addEventListener("mousewheel",this.onMouseWheelDelegate);t.htmlElement.addEventListener("mouseover",this.onMouseOverDelegate);t.htmlElement.addEventListener("mouseout",this.onMouseOutDelegate);this._viewLookup.push(t)}};t.prototype.unregisterView=function(t){if(t&&t.htmlElement){t.htmlElement.removeEventListener("click",this.onClickDelegate);t.htmlElement.removeEventListener("dblclick",this.onDoubleClickDelegate);t.htmlElement.removeEventListener("touchstart",this.onMouseDownDelegate);t.htmlElement.removeEventListener("mousedown",this.onMouseDownDelegate);t.htmlElement.removeEventListener("touchmove",this.onMouseMoveDelegate);t.htmlElement.removeEventListener("mousemove",this.onMouseMoveDelegate);t.htmlElement.removeEventListener("touchend",this.onMouseUpDelegate);t.htmlElement.removeEventListener("mouseup",this.onMouseUpDelegate);t.htmlElement.removeEventListener("mousewheel",this.onMouseWheelDelegate);t.htmlElement.removeEventListener("mouseover",this.onMouseOverDelegate);t.htmlElement.removeEventListener("mouseout",this.onMouseOutDelegate);this._viewLookup.slice(this._viewLookup.indexOf(t),1)}};t.prototype.queueDispatch=function(t,e,i){if(i===void 0){i=null}if(e){t.ctrlKey=e.ctrlKey;t.altKey=e.altKey;t.shiftKey=e.shiftKey;t.screenX=e.clientX!=null?e.clientX:e.changedTouches[0].clientX;t.screenY=e.clientY!=null?e.clientY:e.changedTouches[0].clientY}if(i==null)i=this._iCollision;if(i){t.entity=i.entity;t.renderable=i.renderable;t.uv=i.uv;t.position=i.position?i.position.clone():null;t.normal=i.normal?i.normal.clone():null;t.elementIndex=i.elementIndex}else{t.uv=null;t.entity=null;t.position=this._nullVector;t.normal=this._nullVector;t.elementIndex=0}this._queuedEvents.push(t)};t.prototype.onMouseMove=function(t){t.preventDefault();this.updateColliders(t);if(this._iCollision)this.queueDispatch(this._mouseMove,this._mouseMoveEvent=t)};t.prototype.onMouseOut=function(t){this._iActiveDiv=null;this.updateColliders(t);if(this._iCollision)this.queueDispatch(this._mouseOut,t)};t.prototype.onMouseOver=function(t){this._iActiveDiv=t.target;this.updateColliders(t);if(this._iCollision)this.queueDispatch(this._mouseOver,t)};t.prototype.onClick=function(t){this.updateColliders(t);if(this._iCollision)this.queueDispatch(this._mouseClick,t)};t.prototype.onDoubleClick=function(t){this.updateColliders(t);if(this._iCollision)this.queueDispatch(this._mouseDoubleClick,t)};t.prototype.onMouseDown=function(t){t.preventDefault();this._iActiveDiv=t.target;this.updateColliders(t);if(this._iCollision)this.queueDispatch(this._mouseDown,t)};t.prototype.onMouseUp=function(t){t.preventDefault();this.updateColliders(t);if(this._iCollision)this.queueDispatch(this._mouseUp,t)};t.prototype.onMouseWheel=function(t){this.updateColliders(t);if(this._iCollision)this.queueDispatch(this._mouseWheel,t)};t.prototype.updateColliders=function(t){var e;var i;var r=t.clientX!=null?t.clientX:t.changedTouches[0].clientX;var n=t.clientY!=null?t.clientY:t.changedTouches[0].clientY;var a=this._viewLookup.length;for(var o=0;o<a;o++){e=this._viewLookup[o];e._pTouchPoints.length=0;i=e.htmlElement.getBoundingClientRect();if(t.touches){var l;var a=t.touches.length;for(var o=0;o<a;o++){l=t.touches[o];e._pTouchPoints.push(new s.TouchPoint(l.clientX+i.left,l.clientY+i.top,l.identifier))}}if(this._iUpdateDirty)continue;if(r<i.left||r>i.right||n<i.top||n>i.bottom){e._pMouseX=null;e._pMouseY=null}else{e._pMouseX=r+i.left;e._pMouseY=n+i.top;e.updateCollider();if(e.layeredView&&this._iCollision)break}}this._iUpdateDirty=true};return t}();i.MouseManager=o},{"../base/TouchPoint":"awayjs-display/lib/base/TouchPoint","../events/MouseEvent":"awayjs-display/lib/events/MouseEvent","../managers/FrameScriptManager":"awayjs-display/lib/managers/FrameScriptManager","awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-display/lib/managers/TouchManager":[function(t,e,i){"use strict";var r=t("awayjs-core/lib/geom/Vector3D");var s=t("../events/TouchEvent");var n=function(){function t(){var e=this;this._updateDirty=true;this._nullVector=new r.Vector3D;this._queuedEvents=new Array;this._touchOut=new s.TouchEvent(s.TouchEvent.TOUCH_OUT);this._touchBegin=new s.TouchEvent(s.TouchEvent.TOUCH_BEGIN);this._touchMove=new s.TouchEvent(s.TouchEvent.TOUCH_MOVE);this._touchEnd=new s.TouchEvent(s.TouchEvent.TOUCH_END);this._touchOver=new s.TouchEvent(s.TouchEvent.TOUCH_OVER);this._touchPoints=new Array;this._touchPointFromId=new Object;t._iCollisionFromTouchId=new Object;t._previousCollidingObjectFromTouchId=new Object;this.onTouchBeginDelegate=function(t){return e.onTouchBegin(t)};this.onTouchMoveDelegate=function(t){return e.onTouchMove(t)};this.onTouchEndDelegate=function(t){return e.onTouchEnd(t)}}t.getInstance=function(){if(this._instance)return this._instance;return this._instance=new t};t.prototype.updateCollider=function(t){};t.prototype.fireTouchEvents=function(e){var i;for(i=0;i<this._numTouchPoints;++i){this._touchPoint=this._touchPoints[i];this._iCollision=t._iCollisionFromTouchId[this._touchPoint.id];this._previousCollidingObject=t._previousCollidingObjectFromTouchId[this._touchPoint.id];if(this._iCollision!=this._previousCollidingObject){if(this._previousCollidingObject)this.queueDispatch(this._touchOut,this._touchMoveEvent,this._previousCollidingObject,this._touchPoint);if(this._iCollision)this.queueDispatch(this._touchOver,this._touchMoveEvent,this._iCollision,this._touchPoint)}if(e&&this._iCollision)this.queueDispatch(this._touchMove,this._touchMoveEvent,this._iCollision,this._touchPoint)}var r;var s;var n=this._queuedEvents.length;for(i=0;i<n;++i){r=this._queuedEvents[i];s=r.entity;while(s&&!s._iIsMouseEnabled())s=s.parent;if(s)s.dispatchEvent(r)}this._queuedEvents.length=0;this._updateDirty=false;for(i=0;i<this._numTouchPoints;++i){this._touchPoint=this._touchPoints[i];t._previousCollidingObjectFromTouchId[this._touchPoint.id]=t._iCollisionFromTouchId[this._touchPoint.id]}};t.prototype.registerView=function(t){t.htmlElement.addEventListener("touchstart",this.onTouchBeginDelegate);t.htmlElement.addEventListener("touchmove",this.onTouchMoveDelegate);t.htmlElement.addEventListener("touchend",this.onTouchEndDelegate)};t.prototype.unregisterView=function(t){t.htmlElement.removeEventListener("touchstart",this.onTouchBeginDelegate);t.htmlElement.removeEventListener("touchmove",this.onTouchMoveDelegate);t.htmlElement.removeEventListener("touchend",this.onTouchEndDelegate)};t.prototype.queueDispatch=function(t,e,i,r){t.ctrlKey=e.ctrlKey;t.altKey=e.altKey;t.shiftKey=e.shiftKey;t.screenX=r.x;t.screenY=r.y;t.touchPointID=r.id;if(i){t.entity=i.entity;t.renderable=i.renderable;t.uv=i.uv;t.position=i.position?i.position.clone():null;t.normal=i.normal?i.normal.clone():null;t.elementIndex=i.elementIndex}else{t.uv=null;t.entity=null;t.position=this._nullVector;t.normal=this._nullVector;t.elementIndex=0}this._queuedEvents.push(t)};t.prototype.onTouchBegin=function(e){var i=new a;this._numTouchPoints++;this._touchPoints.push(i);this._touchPointFromId[i.id]=i;this._iCollision=t._iCollisionFromTouchId[i.id];if(this._iCollision)this.queueDispatch(this._touchBegin,e,this._iCollision,i);this._updateDirty=true};t.prototype.onTouchMove=function(t){};t.prototype.onTouchEnd=function(t){};return t}();i.TouchManager=n;var a=function(){function t(){}return t}()},{"../events/TouchEvent":"awayjs-display/lib/events/TouchEvent","awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-display/lib/managers":[function(t,e,i){"use strict";var r=t("./managers/DefaultMaterialManager");i.DefaultMaterialManager=r.DefaultMaterialManager;var s=t("./managers/FrameScriptManager");i.FrameScriptManager=s.FrameScriptManager;var n=t("./managers/MouseManager");i.MouseManager=n.MouseManager;var a=t("./managers/TouchManager");i.TouchManager=a.TouchManager},{"./managers/DefaultMaterialManager":"awayjs-display/lib/managers/DefaultMaterialManager","./managers/FrameScriptManager":"awayjs-display/lib/managers/FrameScriptManager","./managers/MouseManager":"awayjs-display/lib/managers/MouseManager","./managers/TouchManager":"awayjs-display/lib/managers/TouchManager"}],"awayjs-display/lib/materials/BasicMaterial":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/image/Image2D");var n=t("../materials/MaterialBase");var a=t("../textures/Single2DTexture");var o=function(t){r(e,t);function e(e,i){if(e===void 0){e=null}if(i===void 0){i=1}t.call(this,e,i);this._preserveAlpha=false;if(e instanceof s.Image2D)this.texture=new a.Single2DTexture}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"preserveAlpha",{get:function(){return this._preserveAlpha},set:function(t){if(this._preserveAlpha==t)return;this._preserveAlpha=t;this.invalidate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){if(this._texture==t)return;if(this._texture)this.removeTexture(this._texture);this._texture=t;if(this._texture)this.addTexture(this._texture);this.invalidateTexture()},enumerable:true,configurable:true});e.assetType="[materials BasicMaterial]";return e}(n.MaterialBase);i.BasicMaterial=o},{"../materials/MaterialBase":"awayjs-display/lib/materials/MaterialBase","../textures/Single2DTexture":"awayjs-display/lib/textures/Single2DTexture","awayjs-core/lib/image/Image2D":undefined}],"awayjs-display/lib/materials/LightSources":[function(t,e,i){"use strict";var r=function(){function t(){}t.LIGHTS=1;t.PROBES=2;t.ALL=3;return t}();i.LightSources=r},{}],"awayjs-display/lib/materials/MaterialBase":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/image/BlendMode");var n=t("awayjs-core/lib/image/ImageBase");var a=t("awayjs-core/lib/geom/ColorTransform");var o=t("awayjs-core/lib/events/AssetEvent");var l=t("awayjs-core/lib/library/AssetBase");var h=t("../events/SurfaceEvent");var p=t("../base/Style");var u=t("../events/StyleEvent");var c=function(t){r(e,t);function e(e,i){var r=this;if(e===void 0){e=null}if(i===void 0){i=1}t.call(this);this._textures=new Array;this._pUseColorTransform=false;this._alphaBlending=false;this._alpha=1;this._pAlphaThreshold=0;this._pAnimateUVs=false;this._enableLightFallOff=true;this._specularLightSources=1;this._diffuseLightSources=3;this._style=new p.Style;this._iBaseScreenPassIndex=0;this._bothSides=false;this._owners=new Array;this._pBlendMode=s.BlendMode.NORMAL;this._imageRect=false;this._curves=false;this._onInvalidatePropertiesDelegate=function(t){return r._onInvalidateProperties(t)};this._style.addEventListener(u.StyleEvent.INVALIDATE_PROPERTIES,this._onInvalidatePropertiesDelegate);if(e instanceof n.ImageBase)this._style.image=e;else if(e)this._style.color=Number(e);this.alpha=i;this._onLightChangeDelegate=function(t){return r.onLightsChange(t)};this._onTextureInvalidateDelegate=function(t){return r.onTextureInvalidate(t)};this.alphaPremultiplied=false}Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){if(t>1)t=1;else if(t<0)t=0;if(this._alpha==t)return;this._alpha=t;if(this._colorTransform==null)this._colorTransform=new a.ColorTransform;this._colorTransform.alphaMultiplier=t;this.invalidate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"colorTransform",{get:function(){return this._colorTransform},set:function(t){this._colorTransform=t;this.invalidate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alphaBlending",{get:function(){return this._alphaBlending},set:function(t){if(this._alphaBlending==t)return;this._alphaBlending=t;this.invalidate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"animationSet",{get:function(){return this._animationSet},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightPicker",{get:function(){return this._pLightPicker},set:function(t){if(this._pLightPicker==t)return;if(this._pLightPicker)this._pLightPicker.removeEventListener(o.AssetEvent.INVALIDATE,this._onLightChangeDelegate);this._pLightPicker=t;if(this._pLightPicker)this._pLightPicker.addEventListener(o.AssetEvent.INVALIDATE,this._onLightChangeDelegate);this.invalidate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"curves",{get:function(){return this._curves},set:function(t){if(this._curves==t)return;this._curves=t;this.invalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"imageRect",{get:function(){return this._imageRect},set:function(t){if(this._imageRect==t)return;this._imageRect=t;this.invalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){if(this._style==t)return;if(this._style)this._style.removeEventListener(u.StyleEvent.INVALIDATE_PROPERTIES,this._onInvalidatePropertiesDelegate);this._style=t;if(this._style)this._style.addEventListener(u.StyleEvent.INVALIDATE_PROPERTIES,this._onInvalidatePropertiesDelegate);this.invalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"animateUVs",{get:function(){return this._pAnimateUVs},set:function(t){if(this._pAnimateUVs==t)return;this._pAnimateUVs=t;this.invalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"useColorTransform",{get:function(){return this._pUseColorTransform},set:function(t){if(this._pUseColorTransform==t)return;this._pUseColorTransform=t;this.invalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"enableLightFallOff",{get:function(){return this._enableLightFallOff},set:function(t){if(this._enableLightFallOff==t)return;this._enableLightFallOff=t;this.invalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"diffuseLightSources",{get:function(){return this._diffuseLightSources},set:function(t){if(this._diffuseLightSources==t)return;this._diffuseLightSources=t;this.invalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specularLightSources",{get:function(){return this._specularLightSources},set:function(t){if(this._specularLightSources==t)return;this._specularLightSources=t;this.invalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bothSides",{get:function(){return this._bothSides},set:function(t){if(this._bothSides=t)return;this._bothSides=t;this.invalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._pBlendMode},set:function(t){if(this._pBlendMode==t)return;this._pBlendMode=t;this.invalidate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alphaPremultiplied",{get:function(){return this._alphaPremultiplied},set:function(t){if(this._alphaPremultiplied==t)return;this._alphaPremultiplied=t;this.invalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alphaThreshold",{get:function(){return this._pAlphaThreshold},set:function(t){if(t<0)t=0;else if(t>1)t=1;if(this._pAlphaThreshold==t)return;this._pAlphaThreshold=t;this.invalidatePasses()},enumerable:true,configurable:true});e.prototype.iAddOwner=function(t){this._owners.push(t);var e;var i=t.animator;if(i)e=i.animationSet;if(t.animator){if(this._animationSet&&e!=this._animationSet){throw new Error("A Material instance cannot be shared across material owners with different animation sets")}else{if(this._animationSet!=e){this._animationSet=e;this.invalidateAnimation()}}}t.invalidateSurface()};e.prototype.iRemoveOwner=function(t){this._owners.splice(this._owners.indexOf(t),1);if(this._owners.length==0){this._animationSet=null;this.invalidateAnimation()}t.invalidateSurface()};Object.defineProperty(e.prototype,"iOwners",{get:function(){return this._owners},enumerable:true,configurable:true});e.prototype.getNumTextures=function(){return this._textures.length};e.prototype.getTextureAt=function(t){return this._textures[t]};e.prototype.invalidatePasses=function(){this.dispatchEvent(new h.SurfaceEvent(h.SurfaceEvent.INVALIDATE_PASSES,this))};e.prototype.invalidateAnimation=function(){this.dispatchEvent(new h.SurfaceEvent(h.SurfaceEvent.INVALIDATE_ANIMATION,this))};e.prototype.invalidateSurfaces=function(){var t=this._owners.length;for(var e=0;e<t;e++)this._owners[e].invalidateSurface()};e.prototype.onLightsChange=function(t){this.invalidate()};e.prototype.invalidateTexture=function(){this.dispatchEvent(new h.SurfaceEvent(h.SurfaceEvent.INVALIDATE_TEXTURE,this))};e.prototype.addTextureAt=function(t,e){var i=this._textures.indexOf(t);if(i==e)return;else if(i!=-1)this._textures.splice(i,1);this._textures.splice(e,0,t);t.addEventListener(o.AssetEvent.INVALIDATE,this._onTextureInvalidateDelegate);this.onTextureInvalidate()};e.prototype.addTexture=function(t){if(this._textures.indexOf(t)!=-1)return;this._textures.push(t);t.addEventListener(o.AssetEvent.INVALIDATE,this._onTextureInvalidateDelegate);this.onTextureInvalidate()};e.prototype.removeTexture=function(t){this._textures.splice(this._textures.indexOf(t),1);t.removeEventListener(o.AssetEvent.INVALIDATE,this._onTextureInvalidateDelegate);this.onTextureInvalidate()};e.prototype.onTextureInvalidate=function(t){if(t===void 0){t=null}this.invalidatePasses();this.invalidateSurfaces()};e.prototype._onInvalidateProperties=function(t){this.invalidatePasses()};return e}(l.AssetBase);i.MaterialBase=c},{"../base/Style":"awayjs-display/lib/base/Style","../events/StyleEvent":"awayjs-display/lib/events/StyleEvent","../events/SurfaceEvent":"awayjs-display/lib/events/SurfaceEvent","awayjs-core/lib/events/AssetEvent":undefined,"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-core/lib/image/BlendMode":undefined,"awayjs-core/lib/image/ImageBase":undefined,"awayjs-core/lib/library/AssetBase":undefined}],"awayjs-display/lib/materials/lightpickers/LightPickerBase":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/library/AssetBase");var n=function(t){r(e,t);function e(){t.call(this);this._pNumPointLights=0;this._pNumDirectionalLights=0;this._pNumCastingPointLights=0;this._pNumCastingDirectionalLights=0;this._pNumLightProbes=0}e.prototype.dispose=function(){};Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numDirectionalLights",{get:function(){return this._pNumDirectionalLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numPointLights",{get:function(){return this._pNumPointLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numCastingDirectionalLights",{get:function(){return this._pNumCastingDirectionalLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numCastingPointLights",{get:function(){return this._pNumCastingPointLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numLightProbes",{get:function(){return this._pNumLightProbes},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"pointLights",{get:function(){return this._pPointLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"directionalLights",{get:function(){return this._pDirectionalLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"castingPointLights",{get:function(){return this._pCastingPointLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"castingDirectionalLights",{get:function(){return this._pCastingDirectionalLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightProbes",{get:function(){return this._pLightProbes},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightProbeWeights",{get:function(){return this._pLightProbeWeights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"allPickedLights",{get:function(){return this._pAllPickedLights},enumerable:true,configurable:true});e.prototype.collectLights=function(t){this.updateProbeWeights(t)};e.prototype.updateProbeWeights=function(t){var e=t.scenePosition;var i;var r=e.x,s=e.y,n=e.z;var a,o,l;var h,p=0;var u;for(u=0;u<this._pNumLightProbes;++u){i=this._pLightProbes[u].scenePosition;a=r-i.x;o=s-i.y;l=n-i.z;h=a*a+o*o+l*l;h=h>1e-5?1/h:5e7;this._pLightProbeWeights[u]=h;p+=h}p=1/p;for(u=0;u<this._pNumLightProbes;++u)this._pLightProbeWeights[u]*=p};e.assetType="[asset LightPicker]";return e}(s.AssetBase);i.LightPickerBase=n},{"awayjs-core/lib/library/AssetBase":undefined}],"awayjs-display/lib/materials/lightpickers/StaticLightPicker":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/events/AssetEvent");var n=t("../../display/DirectionalLight");var a=t("../../display/LightProbe");var o=t("../../display/PointLight");var l=t("../../events/LightEvent");var h=t("../../materials/lightpickers/LightPickerBase");var p=function(t){r(e,t);function e(e){var i=this;t.call(this);this._onCastShadowChangeDelegate=function(t){return i.onCastShadowChange(t)};this.lights=e}Object.defineProperty(e.prototype,"lights",{get:function(){return this._lights},set:function(t){var e=0;var i=0;var r=0;var h=0;var p=0;var u;if(this._lights)this.clearListeners();this._lights=t;this._pAllPickedLights=t;this._pPointLights=new Array;this._pCastingPointLights=new Array;this._pDirectionalLights=new Array;this._pCastingDirectionalLights=new Array;this._pLightProbes=new Array;var c=t.length;for(var f=0;f<c;++f){u=t[f];u.addEventListener(l.LightEvent.CASTS_SHADOW_CHANGE,this._onCastShadowChangeDelegate);if(u instanceof o.PointLight){if(u.shadowsEnabled)this._pCastingPointLights[r++]=u;else this._pPointLights[e++]=u}else if(u instanceof n.DirectionalLight){if(u.shadowsEnabled)this._pCastingDirectionalLights[h++]=u;else this._pDirectionalLights[i++]=u}else if(u instanceof a.LightProbe){this._pLightProbes[p++]=u}}if(this._pNumDirectionalLights==i&&this._pNumPointLights==e&&this._pNumLightProbes==p&&this._pNumCastingPointLights==r&&this._pNumCastingDirectionalLights==h)return;this._pNumDirectionalLights=i;this._pNumCastingDirectionalLights=h;this._pNumPointLights=e;this._pNumCastingPointLights=r;this._pNumLightProbes=p;this._pLightProbeWeights=new Array(Math.ceil(p/4)*4);this.dispatchEvent(new s.AssetEvent(s.AssetEvent.INVALIDATE,this))},enumerable:true,configurable:true});e.prototype.clearListeners=function(){var t=this._lights.length;for(var e=0;e<t;++e)this._lights[e].removeEventListener(l.LightEvent.CASTS_SHADOW_CHANGE,this._onCastShadowChangeDelegate)};e.prototype.onCastShadowChange=function(t){var e=t.target;if(e instanceof o.PointLight)this.updatePointCasting(e);else if(e instanceof n.DirectionalLight)this.updateDirectionalCasting(e);this.dispatchEvent(new s.AssetEvent(s.AssetEvent.INVALIDATE,this))};e.prototype.updateDirectionalCasting=function(t){var e=t;if(t.shadowsEnabled){--this._pNumDirectionalLights;++this._pNumCastingDirectionalLights;this._pDirectionalLights.splice(this._pDirectionalLights.indexOf(e),1);this._pCastingDirectionalLights.push(t)}else{++this._pNumDirectionalLights;--this._pNumCastingDirectionalLights;this._pCastingDirectionalLights.splice(this._pCastingDirectionalLights.indexOf(e),1);this._pDirectionalLights.push(t)}};e.prototype.updatePointCasting=function(t){var e=t;if(t.shadowsEnabled){--this._pNumPointLights;++this._pNumCastingPointLights;this._pPointLights.splice(this._pPointLights.indexOf(e),1);this._pCastingPointLights.push(t)}else{++this._pNumPointLights;--this._pNumCastingPointLights;this._pCastingPointLights.splice(this._pCastingPointLights.indexOf(e),1);this._pPointLights.push(t)}};return e}(h.LightPickerBase);i.StaticLightPicker=p},{"../../display/DirectionalLight":"awayjs-display/lib/display/DirectionalLight","../../display/LightProbe":"awayjs-display/lib/display/LightProbe","../../display/PointLight":"awayjs-display/lib/display/PointLight","../../events/LightEvent":"awayjs-display/lib/events/LightEvent","../../materials/lightpickers/LightPickerBase":"awayjs-display/lib/materials/lightpickers/LightPickerBase","awayjs-core/lib/events/AssetEvent":undefined}],"awayjs-display/lib/materials/shadowmappers/CascadeShadowMapper":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/geom/Matrix3DUtils");var n=t("awayjs-core/lib/geom/Rectangle");var a=t("awayjs-core/lib/events/AssetEvent");var o=t("awayjs-core/lib/projections/FreeMatrixProjection");var l=t("../../display/Camera");var h=t("../../materials/shadowmappers/DirectionalShadowMapper");var p=function(t){r(e,t);function e(e){if(e===void 0){e=3}t.call(this);this._pScissorRectsInvalid=true;if(e<1||e>4)throw new Error("numCascades must be an integer between 1 and 4");this._numCascades=e;this.init()}e.prototype.getSplitRatio=function(t){return this._splitRatios[t]};e.prototype.setSplitRatio=function(t,e){if(e<0)e=0;else if(e>1)e=1;if(t>=this._numCascades)throw new Error("index must be smaller than the number of cascades!");this._splitRatios[t]=e};e.prototype.getDepthProjections=function(t){return this._depthCameras[t].viewProjection};e.prototype.init=function(){this._splitRatios=new Array(this._numCascades);this._nearPlaneDistances=new Array(this._numCascades);var t=1;for(var e=this._numCascades-1;e>=0;--e){this._splitRatios[e]=t;t*=.4}this._texOffsetsX=Array(-1,1,-1,1);this._texOffsetsY=Array(1,1,-1,-1);this._pScissorRects=new Array(4);this._depthLenses=new Array;this._depthCameras=new Array;for(e=0;e<this._numCascades;++e){this._depthLenses[e]=new o.FreeMatrixProjection;this._depthCameras[e]=new l.Camera(this._depthLenses[e])}};e.prototype._pSetDepthMapSize=function(e){t.prototype._pSetDepthMapSize.call(this,e);this.invalidateScissorRects()};e.prototype.invalidateScissorRects=function(){this._pScissorRectsInvalid=true};Object.defineProperty(e.prototype,"numCascades",{get:function(){return this._numCascades},set:function(t){if(t==this._numCascades)return;if(t<1||t>4)throw new Error("numCascades must be an integer between 1 and 4");this._numCascades=t;this.invalidateScissorRects();this.init();this.dispatchEvent(new a.AssetEvent(a.AssetEvent.INVALIDATE,this))},enumerable:true,configurable:true});e.prototype.pDrawDepthMap=function(t,e,i){if(this._pScissorRectsInvalid)this.updateScissorRects();i.cullPlanes=this._pCullPlanes;i._iRenderCascades(this._pOverallDepthCamera,t,e.image2D,this._numCascades,this._pScissorRects,this._depthCameras)};e.prototype.updateScissorRects=function(){var t=this._pDepthMapSize*.5;this._pScissorRects[0]=new n.Rectangle(0,0,t,t);this._pScissorRects[1]=new n.Rectangle(t,0,t,t);this._pScissorRects[2]=new n.Rectangle(0,t,t,t);this._pScissorRects[3]=new n.Rectangle(t,t,t,t);this._pScissorRectsInvalid=false};e.prototype.pUpdateDepthProjection=function(t){var e;var i=t.projection;var r=i.near;var s=i.far-r;this.pUpdateProjectionFromFrustumCorners(t,t.projection.frustumCorners,this._pMatrix);this._pMatrix.appendScale(.96,.96,1);this._pOverallDepthProjection.matrix=this._pMatrix;this.pUpdateCullPlanes(t);for(var n=0;n<this._numCascades;++n){e=this._depthLenses[n].matrix;this._nearPlaneDistances[n]=r+this._splitRatios[n]*s;this._depthCameras[n].transform.matrix3D=this._pOverallDepthCamera.transform.matrix3D;this.updateProjectionPartition(e,this._splitRatios[n],this._texOffsetsX[n],this._texOffsetsY[n]);this._depthLenses[n].matrix=e}};e.prototype.updateProjectionPartition=function(t,e,i,r){var n=s.Matrix3DUtils.RAW_DATA_CONTAINER;var a,o,l;var h,p,u;var c=Number.POSITIVE_INFINITY,f=Number.POSITIVE_INFINITY,d;var _=Number.NEGATIVE_INFINITY,y=Number.NEGATIVE_INFINITY,v=Number.NEGATIVE_INFINITY;var m=0;while(m<12){a=this._pLocalFrustum[m];o=this._pLocalFrustum[m+1];l=this._pLocalFrustum[m+2];h=a+(this._pLocalFrustum[m+12]-a)*e;p=o+(this._pLocalFrustum[m+13]-o)*e;u=l+(this._pLocalFrustum[m+14]-l)*e;if(a<c)c=a;if(a>_)_=a;if(o<f)f=o;if(o>y)y=o;if(l>v)v=l;if(h<c)c=h;if(h>_)_=h;if(p<f)f=p;if(p>y)y=p;if(u>v)v=u;m+=3}d=1;var b=_-c;var g=y-f;var w=1/(v-d);if(c<0)c-=this._pSnap;if(f<0)f-=this._pSnap;c=Math.floor(c/this._pSnap)*this._pSnap;f=Math.floor(f/this._pSnap)*this._pSnap;var P=2*this._pSnap;b=Math.floor(b/P+1)*P;g=Math.floor(g/P+1)*P;_=c+b;y=f+g;b=1/b;g=1/g;n[0]=2*b;n[5]=2*g;n[10]=w;n[12]=-(_+c)*b;n[13]=-(y+f)*g;n[14]=-d*w;n[15]=1;n[1]=n[2]=n[3]=n[4]=n[6]=n[7]=n[8]=n[9]=n[11]=0;t.copyRawDataFrom(n);t.appendScale(.96,.96,1);t.appendTranslation(i,r,0);t.appendScale(.5,.5,1)};Object.defineProperty(e.prototype,"_iNearPlaneDistances",{get:function(){return this._nearPlaneDistances},enumerable:true,configurable:true});return e}(h.DirectionalShadowMapper);i.CascadeShadowMapper=p},{"../../display/Camera":"awayjs-display/lib/display/Camera",
"../../materials/shadowmappers/DirectionalShadowMapper":"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper","awayjs-core/lib/events/AssetEvent":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/geom/Rectangle":undefined,"awayjs-core/lib/projections/FreeMatrixProjection":undefined}],"awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/image/ImageCube");var n=t("../../display/Camera");var a=t("../../materials/shadowmappers/ShadowMapperBase");var o=t("../../textures/SingleCubeTexture");var l=function(t){r(e,t);function e(){t.call(this);this._pDepthMapSize=512;this._needsRender=new Array;this.initCameras()}e.prototype.initCameras=function(){this._depthCameras=new Array;this._projections=new Array;this.addCamera(0,90,0);this.addCamera(0,-90,0);this.addCamera(-90,0,0);this.addCamera(90,0,0);this.addCamera(0,0,0);this.addCamera(0,180,0)};e.prototype.addCamera=function(t,e,i){var r=new n.Camera;r.rotationX=t;r.rotationY=e;r.rotationZ=i;r.projection.near=.01;var s=r.projection;s.fieldOfView=90;this._projections.push(s);r.projection._iAspectRatio=1;this._depthCameras.push(r)};e.prototype.pCreateDepthTexture=function(){return new o.SingleCubeTexture(new s.ImageCube(this._pDepthMapSize))};e.prototype.pUpdateDepthProjection=function(t){var e=this._pLight;var i=e._pFallOff;var r=this._pLight.scenePosition;for(var s=0;s<6;++s){this._projections[s].far=i;this._depthCameras[s].transform.moveTo(r.x,r.y,r.z);this._needsRender[s]=true}};e.prototype.pDrawDepthMap=function(t,e,i){for(var r=0;r<6;++r)if(this._needsRender[r])i._iRender(this._depthCameras[r],t,e.imageCube,null,r)};return e}(a.ShadowMapperBase);i.CubeMapShadowMapper=l},{"../../display/Camera":"awayjs-display/lib/display/Camera","../../materials/shadowmappers/ShadowMapperBase":"awayjs-display/lib/materials/shadowmappers/ShadowMapperBase","../../textures/SingleCubeTexture":"awayjs-display/lib/textures/SingleCubeTexture","awayjs-core/lib/image/ImageCube":undefined}],"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/image/Image2D");var n=t("awayjs-core/lib/geom/Matrix3D");var a=t("awayjs-core/lib/geom/Matrix3DUtils");var o=t("awayjs-core/lib/projections/FreeMatrixProjection");var l=t("../../display/Camera");var h=t("../../materials/shadowmappers/ShadowMapperBase");var p=t("../../textures/Single2DTexture");var u=function(t){r(e,t);function e(){t.call(this);this._pLightOffset=1e4;this._pSnap=64;this._pCullPlanes=[];this._pOverallDepthProjection=new o.FreeMatrixProjection;this._pOverallDepthCamera=new l.Camera(this._pOverallDepthProjection);this._pLocalFrustum=[];this._pMatrix=new n.Matrix3D}Object.defineProperty(e.prototype,"snap",{get:function(){return this._pSnap},set:function(t){this._pSnap=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightOffset",{get:function(){return this._pLightOffset},set:function(t){this._pLightOffset=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"iDepthProjection",{get:function(){return this._pOverallDepthCamera.viewProjection},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"depth",{get:function(){return this._pMaxZ-this._pMinZ},enumerable:true,configurable:true});e.prototype.iSetDepthMap=function(e){if(this._depthMap==e)return;t.prototype.iSetDepthMap.call(this,e);if(this._depthMap){this._explicitDepthMap=true;this._pDepthMapSize=e.image2D.rect.width}else{this._explicitDepthMap=false}};e.prototype.pCreateDepthTexture=function(){return new p.Single2DTexture(new s.Image2D(this._pDepthMapSize,this._pDepthMapSize))};e.prototype.pDrawDepthMap=function(t,e,i){i.cullPlanes=this._pCullPlanes;i._iRender(this._pOverallDepthCamera,t,e.image2D)};e.prototype.pUpdateCullPlanes=function(t){var e=this._pOverallDepthCamera.frustumPlanes;var i=t.frustumPlanes;this._pCullPlanes.length=4;this._pCullPlanes[0]=e[0];this._pCullPlanes[1]=e[1];this._pCullPlanes[2]=e[2];this._pCullPlanes[3]=e[3];var r=this._pLight;var s=r.sceneDirection;var n=s.x;var a=s.y;var o=s.z;var l=4;for(var h=0;h<6;++h){var p=i[h];if(p.a*n+p.b*a+p.c*o<0)this._pCullPlanes[l++]=p}};e.prototype.pUpdateDepthProjection=function(t){this.pUpdateProjectionFromFrustumCorners(t,t.projection.frustumCorners,this._pMatrix);this._pOverallDepthProjection.matrix=this._pMatrix;this.pUpdateCullPlanes(t)};e.prototype.pUpdateProjectionFromFrustumCorners=function(t,e,i){var r=a.Matrix3DUtils.RAW_DATA_CONTAINER;var s;var n,o,l;var h,p;var u,c;var f;var d=this._pLight;s=d.sceneDirection;this._pOverallDepthCamera.transform.matrix3D=this._pLight.sceneTransform;n=Math.floor((t.x-s.x*this._pLightOffset)/this._pSnap)*this._pSnap;o=Math.floor((t.y-s.y*this._pLightOffset)/this._pSnap)*this._pSnap;l=Math.floor((t.z-s.z*this._pLightOffset)/this._pSnap)*this._pSnap;this._pOverallDepthCamera.x=n;this._pOverallDepthCamera.y=o;this._pOverallDepthCamera.z=l;this._pMatrix.copyFrom(this._pOverallDepthCamera.inverseSceneTransform);this._pMatrix.prepend(t.sceneTransform);this._pMatrix.transformVectors(e,this._pLocalFrustum);h=u=this._pLocalFrustum[0];p=c=this._pLocalFrustum[1];this._pMaxZ=this._pLocalFrustum[2];f=3;while(f<24){n=this._pLocalFrustum[f];o=this._pLocalFrustum[f+1];l=this._pLocalFrustum[f+2];if(n<h)h=n;if(n>u)u=n;if(o<p)p=o;if(o>c)c=o;if(l>this._pMaxZ)this._pMaxZ=l;f+=3}this._pMinZ=1;var _=u-h;var y=c-p;var v=1/(this._pMaxZ-this._pMinZ);if(h<0)h-=this._pSnap;if(p<0)p-=this._pSnap;h=Math.floor(h/this._pSnap)*this._pSnap;p=Math.floor(p/this._pSnap)*this._pSnap;var m=2*this._pSnap;_=Math.floor(_/m+2)*m;y=Math.floor(y/m+2)*m;u=h+_;c=p+y;_=1/_;y=1/y;r[0]=2*_;r[5]=2*y;r[10]=v;r[12]=-(u+h)*_;r[13]=-(c+p)*y;r[14]=-this._pMinZ*v;r[15]=1;r[1]=r[2]=r[3]=r[4]=r[6]=r[7]=r[8]=r[9]=r[11]=0;i.copyRawDataFrom(r)};return e}(h.ShadowMapperBase);i.DirectionalShadowMapper=u},{"../../display/Camera":"awayjs-display/lib/display/Camera","../../materials/shadowmappers/ShadowMapperBase":"awayjs-display/lib/materials/shadowmappers/ShadowMapperBase","../../textures/Single2DTexture":"awayjs-display/lib/textures/Single2DTexture","awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/image/Image2D":undefined,"awayjs-core/lib/projections/FreeMatrixProjection":undefined}],"awayjs-display/lib/materials/shadowmappers/NearDirectionalShadowMapper":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../../materials/shadowmappers/DirectionalShadowMapper");var n=function(t){r(e,t);function e(e){if(e===void 0){e=.5}t.call(this);this.coverageRatio=e}Object.defineProperty(e.prototype,"coverageRatio",{get:function(){return this._coverageRatio},set:function(t){if(t>1)t=1;else if(t<0)t=0;this._coverageRatio=t},enumerable:true,configurable:true});e.prototype.pUpdateDepthProjection=function(t){var e=t.projection.frustumCorners;for(var i=0;i<12;++i){var r=e[i];this._pLocalFrustum[i]=r;this._pLocalFrustum[i+12]=r+(e[i+12]-r)*this._coverageRatio}this.pUpdateProjectionFromFrustumCorners(t,this._pLocalFrustum,this._pMatrix);this._pOverallDepthProjection.matrix=this._pMatrix};return e}(s.DirectionalShadowMapper);i.NearDirectionalShadowMapper=n},{"../../materials/shadowmappers/DirectionalShadowMapper":"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper"}],"awayjs-display/lib/materials/shadowmappers/ShadowMapperBase":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/errors/AbstractMethodError");var n=t("awayjs-core/lib/library/AssetBase");var a=function(t){r(e,t);function e(){t.apply(this,arguments);this._pDepthMapSize=2048;this._autoUpdateShadows=true}Object.defineProperty(e.prototype,"autoUpdateShadows",{get:function(){return this._autoUpdateShadows},set:function(t){this._autoUpdateShadows=t},enumerable:true,configurable:true});e.prototype.updateShadows=function(){this._iShadowsInvalid=true};e.prototype.iSetDepthMap=function(t){if(this._depthMap&&!this._explicitDepthMap)this._depthMap.dispose();this._depthMap=t};Object.defineProperty(e.prototype,"light",{get:function(){return this._pLight},set:function(t){this._pLight=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"depthMap",{get:function(){if(!this._depthMap)this._depthMap=this.pCreateDepthTexture();return this._depthMap},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"depthMapSize",{get:function(){return this._pDepthMapSize},set:function(t){if(t==this._pDepthMapSize)return;this._pSetDepthMapSize(t)},enumerable:true,configurable:true});e.prototype.dispose=function(){if(this._depthMap&&!this._explicitDepthMap)this._depthMap.dispose();this._depthMap=null};e.prototype.pCreateDepthTexture=function(){throw new s.AbstractMethodError};e.prototype.iRenderDepthMap=function(t,e,i){this._iShadowsInvalid=false;this.pUpdateDepthProjection(t);if(!this._depthMap)this._depthMap=this.pCreateDepthTexture();this.pDrawDepthMap(e,this._depthMap,i)};e.prototype.pUpdateDepthProjection=function(t){throw new s.AbstractMethodError};e.prototype.pDrawDepthMap=function(t,e,i){throw new s.AbstractMethodError};e.prototype._pSetDepthMapSize=function(t){this._pDepthMapSize=t;if(this._explicitDepthMap){throw Error("Cannot set depth map size for the current renderer.")}else if(this._depthMap){this._depthMap.dispose();this._depthMap=null}};return e}(n.AssetBase);i.ShadowMapperBase=a},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/library/AssetBase":undefined}],"awayjs-display/lib/materials":[function(t,e,i){"use strict";var r=t("./materials/lightpickers/LightPickerBase");i.LightPickerBase=r.LightPickerBase;var s=t("./materials/lightpickers/StaticLightPicker");i.StaticLightPicker=s.StaticLightPicker;var n=t("./materials/shadowmappers/CascadeShadowMapper");i.CascadeShadowMapper=n.CascadeShadowMapper;var a=t("./materials/shadowmappers/CubeMapShadowMapper");i.CubeMapShadowMapper=a.CubeMapShadowMapper;var o=t("./materials/shadowmappers/DirectionalShadowMapper");i.DirectionalShadowMapper=o.DirectionalShadowMapper;var l=t("./materials/shadowmappers/NearDirectionalShadowMapper");i.NearDirectionalShadowMapper=l.NearDirectionalShadowMapper;var h=t("./materials/shadowmappers/ShadowMapperBase");i.ShadowMapperBase=h.ShadowMapperBase;var p=t("./materials/BasicMaterial");i.BasicMaterial=p.BasicMaterial;var u=t("./materials/LightSources");i.LightSources=u.LightSources;var c=t("./materials/MaterialBase");i.MaterialBase=c.MaterialBase},{"./materials/BasicMaterial":"awayjs-display/lib/materials/BasicMaterial","./materials/LightSources":"awayjs-display/lib/materials/LightSources","./materials/MaterialBase":"awayjs-display/lib/materials/MaterialBase","./materials/lightpickers/LightPickerBase":"awayjs-display/lib/materials/lightpickers/LightPickerBase","./materials/lightpickers/StaticLightPicker":"awayjs-display/lib/materials/lightpickers/StaticLightPicker","./materials/shadowmappers/CascadeShadowMapper":"awayjs-display/lib/materials/shadowmappers/CascadeShadowMapper","./materials/shadowmappers/CubeMapShadowMapper":"awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper","./materials/shadowmappers/DirectionalShadowMapper":"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper","./materials/shadowmappers/NearDirectionalShadowMapper":"awayjs-display/lib/materials/shadowmappers/NearDirectionalShadowMapper","./materials/shadowmappers/ShadowMapperBase":"awayjs-display/lib/materials/shadowmappers/ShadowMapperBase"}],"awayjs-display/lib/partition/BasicPartition":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../partition/NodeBase");var n=t("../partition/PartitionBase");var a=function(t){r(e,t);function e(){t.call(this);this._rootNode=new s.NodeBase}return e}(n.PartitionBase);i.BasicPartition=a},{"../partition/NodeBase":"awayjs-display/lib/partition/NodeBase","../partition/PartitionBase":"awayjs-display/lib/partition/PartitionBase"}],"awayjs-display/lib/partition/CameraNode":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../partition/EntityNode");var n=function(t){r(e,t);function e(){t.apply(this,arguments)}e.prototype.acceptTraverser=function(t){};return e}(s.EntityNode);i.CameraNode=n},{"../partition/EntityNode":"awayjs-display/lib/partition/EntityNode"}],"awayjs-display/lib/partition/DirectionalLightNode":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../partition/EntityNode");var n=function(t){r(e,t);function e(){t.apply(this,arguments)}e.prototype.acceptTraverser=function(t){if(t.enterNode(this))t.applyDirectionalLight(this._displayObject)};e.prototype.isCastingShadow=function(){return false};return e}(s.EntityNode);i.DirectionalLightNode=n},{"../partition/EntityNode":"awayjs-display/lib/partition/EntityNode"}],"awayjs-display/lib/partition/DisplayObjectNode":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/library/AbstractionBase");var n=t("../bounds/AxisAlignedBoundingBox");var a=t("../bounds/BoundingSphere");var o=t("../bounds/BoundsType");var l=t("../bounds/NullBounds");var h=t("../events/DisplayObjectEvent");var p=function(t){r(e,t);function e(e,i){var r=this;t.call(this,e,i);this.numEntities=0;this.isSceneGraphNode=false;this._boundsDirty=true;this._onInvalidatePartitionBoundsDelegate=function(t){return r._onInvalidatePartitionBounds(t)};this._displayObject=e;this._displayObject.addEventListener(h.DisplayObjectEvent.INVALIDATE_PARTITION_BOUNDS,this._onInvalidatePartitionBoundsDelegate);this._boundsType=this._displayObject.boundsType}Object.defineProperty(e.prototype,"debugVisible",{get:function(){return this._displayObject.debugVisible},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bounds",{get:function(){if(this._boundsDirty)this._updateBounds();return this._bounds},enumerable:true,configurable:true});e.prototype.isCastingShadow=function(){return this._displayObject.castsShadows};e.prototype.isMask=function(){return this._displayObject.maskMode};e.prototype.onClear=function(e){t.prototype.onClear.call(this,e);this._displayObject.removeEventListener(h.DisplayObjectEvent.INVALIDATE_PARTITION_BOUNDS,this._onInvalidatePartitionBoundsDelegate);this._displayObject=null;if(this._bounds)this._bounds.dispose();this._bounds=null};e.prototype.onInvalidate=function(e){t.prototype.onInvalidate.call(this,e);if(this._boundsType!=this._displayObject.boundsType){this._boundsType=this._displayObject.boundsType;this._boundsDirty=true}};e.prototype.isInFrustum=function(t,e){return true};e.prototype.isIntersectingRay=function(t,e){return true};e.prototype.isRenderable=function(){return true};e.prototype.acceptTraverser=function(t){};e.prototype._onInvalidatePartitionBounds=function(t){};e.prototype._updateBounds=function(){if(this._bounds)this._bounds.dispose();if(this._boundsType==o.BoundsType.AXIS_ALIGNED_BOX)this._bounds=new n.AxisAlignedBoundingBox(this._displayObject);else if(this._boundsType==o.BoundsType.SPHERE)this._bounds=new a.BoundingSphere(this._displayObject);else if(this._boundsType==o.BoundsType.NULL)this._bounds=new l.NullBounds;this._boundsDirty=false};return e}(s.AbstractionBase);i.DisplayObjectNode=p},{"../bounds/AxisAlignedBoundingBox":"awayjs-display/lib/bounds/AxisAlignedBoundingBox","../bounds/BoundingSphere":"awayjs-display/lib/bounds/BoundingSphere","../bounds/BoundsType":"awayjs-display/lib/bounds/BoundsType","../bounds/NullBounds":"awayjs-display/lib/bounds/NullBounds","../events/DisplayObjectEvent":"awayjs-display/lib/events/DisplayObjectEvent","awayjs-core/lib/library/AbstractionBase":undefined}],"awayjs-display/lib/partition/EntityNode":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/geom/Vector3D");var n=t("../partition/DisplayObjectNode");var a=function(t){r(e,t);function e(e,i){t.call(this,e,i);this.numEntities=1;this._maskPosition=new s.Vector3D;this._partition=i}e.prototype.onClear=function(e){t.prototype.onClear.call(this,e);this._partition=null};e.prototype.isInFrustum=function(t,e){if(!this._displayObject._iIsVisible())return false;return true};e.prototype.isIntersectingRay=function(t,e){if(!this._displayObject._iIsVisible()||!this.isIntersectingMasks(t,e,this._displayObject._iAssignedMasks()))return false;var i=this._displayObject._iPickingCollision;i.rayPosition=this._displayObject.inverseSceneTransform.transformVector(t);i.rayDirection=this._displayObject.inverseSceneTransform.deltaTransformVector(e);if(!i.normal)i.normal=new s.Vector3D;var r=this.bounds.rayIntersection(i.rayPosition,i.rayDirection,i.normal);if(r<0)return false;i.rayEntryDistance=r;i.globalRayPosition=t;i.globalRayDirection=e;i.rayOriginIsInsideBounds=r==0;return true};e.prototype.isRenderable=function(){return this._displayObject._iAssignedColorTransform()._isRenderable()};e.prototype.acceptTraverser=function(t){if(t.enterNode(this))t.applyEntity(this._displayObject)};e.prototype._onInvalidatePartitionBounds=function(t){this.bounds.invalidate();this._partition.iMarkForUpdate(this)};e.prototype.isIntersectingMasks=function(t,e,i){if(i!=null){this._maskPosition.x=t.x+e.x*1e3;this._maskPosition.y=t.y+e.y*1e3;var r=i.length;var s;var n;var a;for(var o=0;o<r;o++){s=i[o];n=s.length;a=false;for(var l=0;l<n;l++){if(s[l].hitTestPoint(this._maskPosition.x,this._maskPosition.y,true,true)){a=true;break}}if(!a)return false}}return true};return e}(n.DisplayObjectNode);i.EntityNode=a},{"../partition/DisplayObjectNode":"awayjs-display/lib/partition/DisplayObjectNode","awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-display/lib/partition/IContainerNode":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/partition/IDisplayObjectNode":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/partition/IEntityNodeClass":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/partition/INode":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/partition/LightProbeNode":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../partition/EntityNode");var n=function(t){r(e,t);function e(){t.apply(this,arguments)}e.prototype.acceptTraverser=function(t){if(t.enterNode(this))t.applyLightProbe(this._displayObject)};e.prototype.isCastingShadow=function(){return false};return e}(s.EntityNode);i.LightProbeNode=n},{"../partition/EntityNode":"awayjs-display/lib/partition/EntityNode"}],"awayjs-display/lib/partition/NodeBase":[function(t,e,i){"use strict";var r=t("../bounds/NullBounds");var s=function(){function t(){this._bounds=new r.NullBounds;this._pChildNodes=new Array;this._pNumChildNodes=0;this.numEntities=0}Object.defineProperty(t.prototype,"debugVisible",{get:function(){return false},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"bounds",{get:function(){return this._bounds},enumerable:true,configurable:true});t.prototype.isInFrustum=function(t,e){return true};t.prototype.isIntersectingRay=function(t,e){return true};t.prototype.isRenderable=function(){return true};t.prototype.isCastingShadow=function(){return true};t.prototype.isMask=function(){return false};t.prototype.dispose=function(){this.parent=null;this._pChildNodes=null};t.prototype.acceptTraverser=function(t){if(this.numEntities==0)return;if(t.enterNode(this)){for(var e=0;e<this._pNumChildNodes;e++)this._pChildNodes[e].acceptTraverser(t)}};t.prototype.iAddNode=function(t){t.parent=this;this.numEntities+=t.numEntities;this._pChildNodes[this._pNumChildNodes++]=t;var e=t.numEntities;t=this;do{t.numEntities+=e}while((t=t.parent)!=null)};t.prototype.iRemoveNode=function(t){var e=this._pChildNodes.indexOf(t);this._pChildNodes[e]=this._pChildNodes[--this._pNumChildNodes];this._pChildNodes.pop();var i=t.numEntities;t=this;do{t.numEntities-=i}while((t=t.parent)!=null)};return t}();i.NodeBase=s},{"../bounds/NullBounds":"awayjs-display/lib/bounds/NullBounds"}],"awayjs-display/lib/partition/PartitionBase":[function(t,e,i){"use strict";var r=function(){function t(){this._abstractionPool=new Object;this._updatesMade=false}t.prototype.getAbstraction=function(e){return this._abstractionPool[e.id]||(this._abstractionPool[e.id]=new t._abstractionClassPool[e.assetType](e,this))};t.prototype.clearAbstraction=function(t){this._abstractionPool[t.id]=null};t.prototype.traverse=function(t){if(this._updatesMade)this.updateEntities();if(this._rootNode){this._rootNode.acceptTraverser(t)}};t.prototype.iMarkForUpdate=function(t){var e=this._updateQueue;while(e){if(t==e)return;e=e._iUpdateQueueNext}t._iUpdateQueueNext=this._updateQueue;this._updateQueue=t;this._updatesMade=true};t.prototype.iRemoveEntity=function(t){var e;if(t.parent){t.parent.iRemoveNode(t);t.parent=null}if(t==this._updateQueue){this._updateQueue=t._iUpdateQueueNext}else{e=this._updateQueue;while(e&&e._iUpdateQueueNext!=t)e=e._iUpdateQueueNext;if(e)e._iUpdateQueueNext=t._iUpdateQueueNext}t._iUpdateQueueNext=null;if(!this._updateQueue)this._updatesMade=false};t.prototype.findParentForNode=function(t){return this._rootNode};t.prototype.updateEntities=function(){var t=this._updateQueue;while(t){t._displayObject._iInternalUpdate();t=t._iUpdateQueueNext}t=this._updateQueue;var e;var i;this._updateQueue=null;this._updatesMade=false;do{e=this.findParentForNode(t);if(t.parent!=e){if(t.parent)t.parent.iRemoveNode(t);e.iAddNode(t)}i=t._iUpdateQueueNext;t._iUpdateQueueNext=null}while((t=i)!=null)};t.prototype._iRegisterEntity=function(t){if(t.isEntity)this.iMarkForUpdate(this.getAbstraction(t))};t.prototype._iUnregisterEntity=function(t){if(t.isEntity)this.iRemoveEntity(this.getAbstraction(t))};t.registerAbstraction=function(e,i){t._abstractionClassPool[i.assetType]=e};t._abstractionClassPool=new Object;return t}();i.PartitionBase=r},{}],"awayjs-display/lib/partition/PointLightNode":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../partition/EntityNode");var n=function(t){r(e,t);function e(){t.apply(this,arguments)}e.prototype.acceptTraverser=function(t){if(t.enterNode(this))t.applyPointLight(this._displayObject)};e.prototype.isCastingShadow=function(){return false};return e}(s.EntityNode);i.PointLightNode=n},{"../partition/EntityNode":"awayjs-display/lib/partition/EntityNode"}],"awayjs-display/lib/partition/SceneGraphNode":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../partition/DisplayObjectNode");var n=function(t){r(e,t);function e(){t.apply(this,arguments);this.isSceneGraphNode=true;this._numNodes=0;this._pChildNodes=new Array;this._childDepths=new Array;this._numMasks=0;this._childMasks=new Array}e.prototype.acceptTraverser=function(t){if(this.numEntities==0)return;var e;for(e=0;e<this._numNodes;e++)this._pChildNodes[e].acceptTraverser(t);for(e=0;e<this._numMasks;e++)this._childMasks[e].acceptTraverser(t)};e.prototype.iAddNode=function(t){t.parent=this;if(t._displayObject.maskMode){this._childMasks.push(t);this._numMasks++}else{var e=t._displayObject._depthID;var i=this._childDepths.length;var r=i;while(r--)if(this._childDepths[r]<e)break;r++;if(r<i){this._pChildNodes.splice(r,0,t);this._childDepths.splice(r,0,e)}else{this._pChildNodes.push(t);this._childDepths.push(e)}this._numNodes++}var s=t.isSceneGraphNode?t.numEntities:1;t=this;do{t.numEntities+=s}while((t=t.parent)!=null)};e.prototype.iRemoveNode=function(t){if(t._displayObject.maskMode){this._childMasks.splice(this._childMasks.indexOf(t),1);this._numMasks--}else{var e=this._pChildNodes.indexOf(t);this._pChildNodes.splice(e,1);this._childDepths.splice(e,1);this._numNodes--}var i=t.numEntities;t=this;do{t.numEntities-=i}while((t=t.parent)!=null)};return e}(s.DisplayObjectNode);i.SceneGraphNode=n;Object.defineProperty(i,"__esModule",{value:true});i.default=n},{"../partition/DisplayObjectNode":"awayjs-display/lib/partition/DisplayObjectNode"}],"awayjs-display/lib/partition/SceneGraphPartition":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../partition/SceneGraphNode");var n=t("../partition/PartitionBase");var a=function(t){r(e,t);function e(){t.call(this);this._sceneGraphNodePool=new o}e.prototype.traverse=function(e){t.prototype.traverse.call(this,e)};e.prototype.findParentForNode=function(t){if(t.isSceneGraphNode&&(t._displayObject.partition==this||t._displayObject._iIsRoot)){this._rootNode=t;return null}if(!t.isSceneGraphNode&&t._displayObject.isContainer)return this._sceneGraphNodePool.getAbstraction(t._displayObject);return this._sceneGraphNodePool.getAbstraction(t._displayObject.parent)};e.prototype._iRegisterEntity=function(e){t.prototype._iRegisterEntity.call(this,e);if(e.isContainer)this.iMarkForUpdate(this._sceneGraphNodePool.getAbstraction(e))};e.prototype._iUnregisterEntity=function(e){t.prototype._iUnregisterEntity.call(this,e);if(e.isContainer)this.iRemoveEntity(this._sceneGraphNodePool.getAbstraction(e))};return e}(n.PartitionBase);i.SceneGraphPartition=a;var o=function(){function t(){this._abstractionPool=new Object}t.prototype.getAbstraction=function(t){return this._abstractionPool[t.id]||(this._abstractionPool[t.id]=new s.SceneGraphNode(t,this))};t.prototype.clearAbstraction=function(t){delete this._abstractionPool[t.id]};return t}();i.SceneGraphNodePool=o},{"../partition/PartitionBase":"awayjs-display/lib/partition/PartitionBase","../partition/SceneGraphNode":"awayjs-display/lib/partition/SceneGraphNode"}],"awayjs-display/lib/partition/SkyboxNode":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../partition/EntityNode");var n=function(t){r(e,t);function e(){t.apply(this,arguments)}e.prototype.isInFrustum=function(t,e){if(!this._displayObject._iIsVisible)return false;return true};e.prototype.isCastingShadow=function(){return false};return e}(s.EntityNode);i.SkyboxNode=n},{"../partition/EntityNode":"awayjs-display/lib/partition/EntityNode"}],"awayjs-display/lib/partition":[function(t,e,i){"use strict";var r=t("./partition/BasicPartition");i.BasicPartition=r.BasicPartition;var s=t("./partition/CameraNode");i.CameraNode=s.CameraNode;var n=t("./partition/DirectionalLightNode");i.DirectionalLightNode=n.DirectionalLightNode;var a=t("./partition/DisplayObjectNode");i.DisplayObjectNode=a.DisplayObjectNode;var o=t("./partition/EntityNode");i.EntityNode=o.EntityNode;var l=t("./partition/LightProbeNode");i.LightProbeNode=l.LightProbeNode;var h=t("./partition/NodeBase");i.NodeBase=h.NodeBase;var p=t("./partition/PartitionBase");i.PartitionBase=p.PartitionBase;var u=t("./partition/PointLightNode");i.PointLightNode=u.PointLightNode;var c=t("./partition/SceneGraphNode");i.SceneGraphNode=c.SceneGraphNode;var f=t("./partition/SceneGraphPartition");i.SceneGraphPartition=f.SceneGraphPartition;var d=t("./partition/SkyboxNode");i.SkyboxNode=d.SkyboxNode},{"./partition/BasicPartition":"awayjs-display/lib/partition/BasicPartition","./partition/CameraNode":"awayjs-display/lib/partition/CameraNode","./partition/DirectionalLightNode":"awayjs-display/lib/partition/DirectionalLightNode","./partition/DisplayObjectNode":"awayjs-display/lib/partition/DisplayObjectNode","./partition/EntityNode":"awayjs-display/lib/partition/EntityNode","./partition/LightProbeNode":"awayjs-display/lib/partition/LightProbeNode","./partition/NodeBase":"awayjs-display/lib/partition/NodeBase","./partition/PartitionBase":"awayjs-display/lib/partition/PartitionBase","./partition/PointLightNode":"awayjs-display/lib/partition/PointLightNode","./partition/SceneGraphNode":"awayjs-display/lib/partition/SceneGraphNode","./partition/SceneGraphPartition":"awayjs-display/lib/partition/SceneGraphPartition","./partition/SkyboxNode":"awayjs-display/lib/partition/SkyboxNode"}],"awayjs-display/lib/pick/IPicker":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/pick/IPickingCollider":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/pick/JSPickingCollider":[function(t,e,i){"use strict";var r=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-core/lib/geom/Point");var n=function(){function t(t){if(t===void 0){t=false}this._findClosestCollision=t}t.prototype.testBillboardCollision=function(t,e,i){i.renderable=null;return false};t.prototype.testTriangleCollision=function(t,e,i,n,a){if(a===void 0){a=0}var o=i.rayPosition;var l=i.rayDirection;var h;var p,u,c;var f,d,_;var y,v,m;var b,g,w;var P,x,j,E;var T,A,C;var D,O,S;var M,I,B;var N,L,R;var F,k,V;var U,G,H,W;var z,q,X,Y,Z;var J=-1;var K=e.bothSides;var Q=t.positions.get(n,a);var $=t.positions.dimensions;var tt=t.positions.stride;var et;if(t.indices){et=t.indices.get(t.numElements);n=et.length}for(var it=0;it<n;it+=3){if(et){p=et[it]*tt;u=et[it+1]*tt;c=et[it+2]*tt}else{p=it*tt;u=(it+1)*tt;c=(it+2)*tt}T=Q[p];D=Q[u];M=Q[c];N=D-T;F=M-T;A=Q[p+1];O=Q[u+1];I=Q[c+1];L=O-A;k=I-A;if($==3){C=Q[p+2];S=Q[u+2];B=Q[c+2];R=S-C;V=B-C;y=L*V-R*k;v=R*F-N*V;m=N*k-L*F;U=1/Math.sqrt(y*y+v*v+m*m);y*=U;v*=U;m*=U}else{y=0;v=0;m=1}G=y*l.x+v*+l.y+m*l.z;if(!K&&G<0||K&&G!=0){H=-(y*T+v*A+m*C);W=-(y*o.x+v*o.y+m*o.z+H);h=W/G;b=o.x+h*l.x;g=o.y+h*l.y;w=o.z+h*l.z;z=N*F+L*k+R*V;q=N*N+L*L+R*R;X=F*F+k*k+V*V;f=b-T;d=g-A;_=w-C;Y=f*N+d*L+_*R;Z=f*F+d*k+_*V;P=1/(q*X-z*z);j=P*(X*Y-z*Z);E=P*(-z*Y+q*Z);if(j<0)continue;if(E<0)continue;x=1-j-E;if(!(x<0)&&h>0&&h<i.rayEntryDistance){J=it/3;i.rayEntryDistance=h;i.position=new r.Vector3D(b,g,w);i.normal=new r.Vector3D(y,v,m);if(t.uvs){var rt=t.uvs.get(t.numVertices);var st=t.uvs.stride;var nt=et[it]*st;var at=new r.Vector3D(rt[nt],rt[nt+1]);nt=et[it+1]*st;var ot=new r.Vector3D(rt[nt],rt[nt+1]);nt=et[it+2]*st;var lt=new r.Vector3D(rt[nt],rt[nt+1]);i.uv=new s.Point(x*at.x+j*ot.x+E*lt.x,x*at.y+j*ot.y+E*lt.y)}i.elementIndex=J;if(!this._findClosestCollision)return true}}}if(J>=0)return true;return false};t.prototype.testLineCollision=function(t,e,i,r,s){if(s===void 0){s=0}return false};return t;
}();i.JSPickingCollider=n},{"awayjs-core/lib/geom/Point":undefined,"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-display/lib/pick/PickingCollision":[function(t,e,i){"use strict";var r=function(){function t(t){this.entity=t}return t}();i.PickingCollision=r},{}],"awayjs-display/lib/pick/RaycastPicker":[function(t,e,i){"use strict";var r=t("awayjs-core/lib/geom/Vector3D");var s=function(){function t(t){if(t===void 0){t=false}this._entities=new Array;this.onlyMouseEnabled=true;this._findClosestCollision=t}t.prototype.enterNode=function(t){return t.isIntersectingRay(this._rayPosition,this._rayDirection)&&!t.isMask()};t.prototype.getViewCollision=function(t,e,i){this._x=t;this._y=e;this._view=i;var r=i.unproject(t,e,0);var s=i.unproject(t,e,1).subtract(r);return this.getSceneCollision(r,s,i.scene)};t.prototype.getSceneCollision=function(t,e,i){this._rayPosition=t;this._rayDirection=e;i.traversePartitions(this);if(!this._entities.length)return null;var r=this.getPickingCollision();this._entities.length=0;return r};t.prototype.setIgnoreList=function(t){this._ignoredEntities=t};t.prototype.isIgnored=function(t){if(this.onlyMouseEnabled&&!t._iIsMouseEnabled())return true;if(this._ignoredEntities){var e=this._ignoredEntities.length;for(var i=0;i<e;i++)if(this._ignoredEntities[i]==t)return true}return false};t.prototype.sortOnNearT=function(t,e){return e._iPickingCollision.rayEntryDistance-t._iPickingCollision.rayEntryDistance};t.prototype.getPickingCollision=function(){this._entities=this._entities.sort(this.sortOnNearT);this._bestCollision=null;var t;var e=this._entities.length;for(var i=e-1;i>=0;i--){t=this._entities[i];this._testCollision=t._iPickingCollision;if(this._bestCollision==null||this._testCollision.rayEntryDistance<this._bestCollision.rayEntryDistance){this._testCollider=t.pickingCollider;if(this._testCollider){this._testCollision.rayEntryDistance=Number.MAX_VALUE;t._acceptTraverser(this);if(this._bestCollision&&!this._findClosestCollision)break}else if(!this._testCollision.rayOriginIsInsideBounds){this._bestCollision=this._testCollision;break}}}if(this._bestCollision)this.updatePosition(this._bestCollision);return this._bestCollision};t.prototype.updatePosition=function(t){var e=t.position||(t.position=new r.Vector3D);var i=t.rayDirection;var s=t.rayPosition;var n=t.rayEntryDistance;e.x=s.x+n*i.x;e.y=s.y+n*i.y;e.z=s.z+n*i.z};t.prototype.dispose=function(){};t.prototype.applyEntity=function(t){if(!this.isIgnored(t))this._entities.push(t)};t.prototype.applyRenderable=function(t){if(t._iTestCollision(this._testCollision,this._testCollider))this._bestCollision=this._testCollision};t.prototype.applyDirectionalLight=function(t){};t.prototype.applyLightProbe=function(t){};t.prototype.applyPointLight=function(t){};t.prototype.applySkybox=function(t){};return t}();i.RaycastPicker=s},{"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-display/lib/pick":[function(t,e,i){"use strict";var r=t("./pick/JSPickingCollider");i.JSPickingCollider=r.JSPickingCollider;var s=t("./pick/PickingCollision");i.PickingCollision=s.PickingCollision;var n=t("./pick/RaycastPicker");i.RaycastPicker=n.RaycastPicker},{"./pick/JSPickingCollider":"awayjs-display/lib/pick/JSPickingCollider","./pick/PickingCollision":"awayjs-display/lib/pick/PickingCollision","./pick/RaycastPicker":"awayjs-display/lib/pick/RaycastPicker"}],"awayjs-display/lib/prefabs/PrefabBase":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/library/AssetBase");var n=t("awayjs-core/lib/errors/AbstractMethodError");var a=function(t){r(e,t);function e(){t.call(this);this._pObjects=new Array}e.prototype.getNewObject=function(){var t=this._pCreateObject();this._pObjects.push(t);return t};e.prototype._pCreateObject=function(){throw new n.AbstractMethodError};e.prototype._iValidate=function(){};return e}(s.AssetBase);i.PrefabBase=a},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/library/AssetBase":undefined}],"awayjs-display/lib/prefabs/PrimitiveCapsulePrefab":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../graphics/ElementsType");var n=t("../prefabs/PrimitivePrefabBase");var a=function(t){r(e,t);function e(e,i,r,s,n,a,o){if(e===void 0){e=null}if(i===void 0){i="triangle"}if(r===void 0){r=50}if(s===void 0){s=100}if(n===void 0){n=16}if(a===void 0){a=15}if(o===void 0){o=true}t.call(this,e,i);this._numVertices=0;this._radius=r;this._height=s;this._segmentsW=n;this._segmentsH=a%2==0?a+1:a;this._yUp=o}Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsW",{get:function(){return this._segmentsW},set:function(t){this._segmentsW=t;this._pInvalidatePrimitive();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsH",{get:function(){return this._segmentsH},set:function(t){this._segmentsH=t%2==0?t+1:t;this._pInvalidatePrimitive();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"yUp",{get:function(){return this._yUp},set:function(t){this._yUp=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});e.prototype._pBuildGraphics=function(t,e){var i;var r;var n;var a;var o;var l;var h;var p=0;var u=0;var c;var f,d,_,y;var v=0;if(e==s.ElementsType.TRIANGLE){var m=t;this._numVertices=(this._segmentsH+1)*(this._segmentsW+1);v=(this._segmentsH-1)*this._segmentsW*6;if(this._numVertices==m.numVertices){m.invalidateIndices();m.invalidateVertices(m.positions);m.invalidateVertices(m.normals);m.invalidateVertices(m.tangents)}else{m.setIndices(new Uint16Array(v));m.setPositions(new Float32Array(this._numVertices*3));m.setNormals(new Float32Array(this._numVertices*3));m.setTangents(new Float32Array(this._numVertices*3));this._pInvalidateUVs()}i=m.indices.get(m.numElements);r=m.positions.get(this._numVertices);n=m.normals.get(this._numVertices);a=m.tangents.get(this._numVertices);o=m.concatenatedBuffer.stride/4;for(h=0;h<=this._segmentsH;++h){var b=Math.PI*h/this._segmentsH;var g=-this._radius*Math.cos(b);var w=this._radius*Math.sin(b);c=u;for(l=0;l<=this._segmentsW;++l){var P=2*Math.PI*l/this._segmentsW;var x=w*Math.cos(P);var j=h>this._segmentsH/2?this._height/2:-this._height/2;var E=w*Math.sin(P);var T=1/Math.sqrt(x*x+E*E+g*g);var A=Math.sqrt(E*E+x*x);if(this._yUp){_=0;y=A>.007?x/A:0;f=-g;d=E}else{_=A>.007?x/A:0;y=0;f=E;d=g}if(l==this._segmentsW){r[u]=r[c];r[u+1]=r[c+1];r[u+2]=r[c+2];n[u]=(n[c]+x*T)*.5;n[u+1]=(n[c+1]+f*T)*.5;n[u+2]=(n[c+2]+d*T)*.5;a[u]=(a[c]+(A>.007?-E/A:1))*.5;a[u+1]=(a[c+1]+_)*.5;a[u+2]=(a[c+2]+y)*.5}else{r[u]=x;r[u+1]=this._yUp?f-j:f;r[u+2]=this._yUp?d:d+j;n[u]=x*T;n[u+1]=f*T;n[u+2]=d*T;a[u]=A>.007?-E/A:1;a[u+1]=_;a[u+2]=y}if(l>0&&h>0){var C=(this._segmentsW+1)*h+l;var D=(this._segmentsW+1)*h+l-1;var O=(this._segmentsW+1)*(h-1)+l-1;var S=(this._segmentsW+1)*(h-1)+l;if(h==this._segmentsH){r[u]=r[c];r[u+1]=r[c+1];r[u+2]=r[c+2];i[p++]=C;i[p++]=O;i[p++]=S}else if(h==1){i[p++]=C;i[p++]=D;i[p++]=O}else{i[p++]=C;i[p++]=D;i[p++]=O;i[p++]=C;i[p++]=O;i[p++]=S}}u+=o}}}else if(e==s.ElementsType.LINE){}};e.prototype._pBuildUVs=function(t,e){var i,r;var n;var a;if(e==s.ElementsType.TRIANGLE){var o=t;if(o.uvs&&this._numVertices==o.numVertices){o.invalidateVertices(o.uvs)}else{o.setUVs(new Float32Array(this._numVertices*2))}n=o.uvs.get(this._numVertices);a=o.uvs.stride;var l=0;for(r=0;r<=this._segmentsH;++r){for(i=0;i<=this._segmentsW;++i){n[l]=i/this._segmentsW*this._scaleU;n[l+1]=r/this._segmentsH*this._scaleV;l+=a}}}else if(e==s.ElementsType.LINE){}};return e}(n.PrimitivePrefabBase);i.PrimitiveCapsulePrefab=a},{"../graphics/ElementsType":"awayjs-display/lib/graphics/ElementsType","../prefabs/PrimitivePrefabBase":"awayjs-display/lib/prefabs/PrimitivePrefabBase"}],"awayjs-display/lib/prefabs/PrimitiveConePrefab":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../prefabs/PrimitiveCylinderPrefab");var n=function(t){r(e,t);function e(e,i,r,s,n,a,o,l){if(e===void 0){e=null}if(i===void 0){i="triangle"}if(r===void 0){r=50}if(s===void 0){s=100}if(n===void 0){n=16}if(a===void 0){a=1}if(o===void 0){o=true}if(l===void 0){l=true}t.call(this,e,i,0,r,s,n,a,false,o,true,l)}Object.defineProperty(e.prototype,"radius",{get:function(){return this._pBottomRadius},set:function(t){this._pBottomRadius=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});return e}(s.PrimitiveCylinderPrefab);i.PrimitiveConePrefab=n},{"../prefabs/PrimitiveCylinderPrefab":"awayjs-display/lib/prefabs/PrimitiveCylinderPrefab"}],"awayjs-display/lib/prefabs/PrimitiveCubePrefab":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../graphics/ElementsType");var n=t("../prefabs/PrimitivePrefabBase");var a=function(t){r(e,t);function e(e,i,r,s,n,a,o,l,h){if(e===void 0){e=null}if(i===void 0){i="triangle"}if(r===void 0){r=100}if(s===void 0){s=100}if(n===void 0){n=100}if(a===void 0){a=1}if(o===void 0){o=1}if(l===void 0){l=1}if(h===void 0){h=true}t.call(this,e,i);this._width=r;this._height=s;this._depth=n;this._segmentsW=a;this._segmentsH=o;this._segmentsD=l;this._tile6=h}Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"depth",{get:function(){return this._depth},set:function(t){this._depth=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"tile6",{get:function(){return this._tile6},set:function(t){this._tile6=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsW",{get:function(){return this._segmentsW},set:function(t){this._segmentsW=t;this._pInvalidatePrimitive();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsH",{get:function(){return this._segmentsH},set:function(t){this._segmentsH=t;this._pInvalidatePrimitive();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsD",{get:function(){return this._segmentsD},set:function(t){this._segmentsD=t;this._pInvalidatePrimitive();this._pInvalidateUVs()},enumerable:true,configurable:true});e.prototype._pBuildGraphics=function(t,e){var i;var r;var n;var a;var o;var l,h,p,u;var c,f,d=0;var _,y;var v,m,b;var g,w,P;var x;v=this._width/2;m=this._height/2;b=this._depth/2;if(e==s.ElementsType.TRIANGLE){var j=t;var E=((this._segmentsW+1)*(this._segmentsH+1)+(this._segmentsW+1)*(this._segmentsD+1)+(this._segmentsH+1)*(this._segmentsD+1))*2;var T=(this._segmentsW*this._segmentsH+this._segmentsW*this._segmentsD+this._segmentsH*this._segmentsD)*12;if(E==j.numVertices&&j.indices!=null){j.invalidateIndices();j.invalidateVertices(j.positions);j.invalidateVertices(j.normals);j.invalidateVertices(j.tangents)}else{j.setIndices(new Uint16Array(T));j.setPositions(new Float32Array(E*3));j.setNormals(new Float32Array(E*3));j.setTangents(new Float32Array(E*3));this._pInvalidateUVs()}i=j.indices.get(j.numElements);r=j.positions.get(E);n=j.normals.get(E);a=j.tangents.get(E);o=j.concatenatedBuffer.stride/4;_=0;y=0;g=this._width/this._segmentsW;w=this._height/this._segmentsH;P=this._depth/this._segmentsD;for(c=0;c<=this._segmentsW;c++){x=-v+c*g;for(f=0;f<=this._segmentsH;f++){r[_]=x;r[_+1]=-m+f*w;r[_+2]=-b;n[_]=0;n[_+1]=0;n[_+2]=-1;a[_]=1;a[_+1]=0;a[_+2]=0;_+=o;r[_]=x;r[_+1]=-m+f*w;r[_+2]=b;n[_]=0;n[_+1]=0;n[_+2]=1;a[_]=-1;a[_+1]=0;a[_+2]=0;_+=o;if(c&&f){l=2*((c-1)*(this._segmentsH+1)+(f-1));h=2*(c*(this._segmentsH+1)+(f-1));p=l+2;u=h+2;i[y++]=l;i[y++]=p;i[y++]=u;i[y++]=l;i[y++]=u;i[y++]=h;i[y++]=h+1;i[y++]=u+1;i[y++]=p+1;i[y++]=h+1;i[y++]=p+1;i[y++]=l+1}}}d+=2*(this._segmentsW+1)*(this._segmentsH+1);for(c=0;c<=this._segmentsW;c++){x=-v+c*g;for(f=0;f<=this._segmentsD;f++){r[_]=x;r[_+1]=m;r[_+2]=-b+f*P;n[_]=0;n[_+1]=1;n[_+2]=0;a[_]=1;a[_+1]=0;a[_+2]=0;_+=o;r[_]=x;r[_+1]=-m;r[_+2]=-b+f*P;n[_]=0;n[_+1]=-1;n[_+2]=0;a[_]=1;a[_+1]=0;a[_+2]=0;_+=o;if(c&&f){l=d+2*((c-1)*(this._segmentsD+1)+(f-1));h=d+2*(c*(this._segmentsD+1)+(f-1));p=l+2;u=h+2;i[y++]=l;i[y++]=p;i[y++]=u;i[y++]=l;i[y++]=u;i[y++]=h;i[y++]=h+1;i[y++]=u+1;i[y++]=p+1;i[y++]=h+1;i[y++]=p+1;i[y++]=l+1}}}d+=2*(this._segmentsW+1)*(this._segmentsD+1);for(c=0;c<=this._segmentsD;c++){x=b-c*P;for(f=0;f<=this._segmentsH;f++){r[_]=-v;r[_+1]=-m+f*w;r[_+2]=x;n[_]=-1;n[_+1]=0;n[_+2]=0;a[_]=0;a[_+1]=0;a[_+2]=-1;_+=o;r[_]=v;r[_+1]=-m+f*w;r[_+2]=x;n[_]=1;n[_+1]=0;n[_+2]=0;a[_]=0;a[_+1]=0;a[_+2]=1;_+=o;if(c&&f){l=d+2*((c-1)*(this._segmentsH+1)+(f-1));h=d+2*(c*(this._segmentsH+1)+(f-1));p=l+2;u=h+2;i[y++]=l;i[y++]=p;i[y++]=u;i[y++]=l;i[y++]=u;i[y++]=h;i[y++]=h+1;i[y++]=u+1;i[y++]=p+1;i[y++]=h+1;i[y++]=p+1;i[y++]=l+1}}}}else if(e==s.ElementsType.LINE){var A=t;var C=this._segmentsH*4+this._segmentsW*4+this._segmentsD*4;var D;r=new Float32Array(C*6);D=new Float32Array(C);_=0;y=0;for(c=0;c<this._segmentsH;++c){r[_++]=-v;r[_++]=c*this._height/this._segmentsH-m;r[_++]=-b;r[_++]=v;r[_++]=c*this._height/this._segmentsH-m;r[_++]=-b;D[y++]=1;r[_++]=-v;r[_++]=m-c*this._height/this._segmentsH;r[_++]=b;r[_++]=v;r[_++]=m-c*this._height/this._segmentsH;r[_++]=b;D[y++]=1}for(c=0;c<this._segmentsW;++c){r[_++]=c*this._width/this._segmentsW-v;r[_++]=-m;r[_++]=-b;r[_++]=c*this._width/this._segmentsW-v;r[_++]=m;r[_++]=-b;D[y++]=1;r[_++]=v-c*this._width/this._segmentsW;r[_++]=-m;r[_++]=b;r[_++]=v-c*this._width/this._segmentsW;r[_++]=m;r[_++]=b;D[y++]=1}for(c=0;c<this._segmentsH;++c){r[_++]=-v;r[_++]=c*this._height/this._segmentsH-m;r[_++]=-b;r[_++]=-v;r[_++]=c*this._height/this._segmentsH-m;r[_++]=b;D[y++]=1;r[_++]=v;r[_++]=m-c*this._height/this._segmentsH;r[_++]=-b;r[_++]=v;r[_++]=m-c*this._height/this._segmentsH;r[_++]=b;D[y++]=1}for(c=0;c<this._segmentsD;++c){r[_++]=v;r[_++]=-m;r[_++]=c*this._depth/this._segmentsD-b;r[_++]=v;r[_++]=m;r[_++]=c*this._depth/this._segmentsD-b;D[y++]=1;r[_++]=-v;r[_++]=-m;r[_++]=b-c*this._depth/this._segmentsD;r[_++]=-v;r[_++]=m;r[_++]=b-c*this._depth/this._segmentsD;D[y++]=1}for(c=0;c<this._segmentsD;++c){r[_++]=-v;r[_++]=-m;r[_++]=b-c*this._depth/this._segmentsD;r[_++]=v;r[_++]=-m;r[_++]=b-c*this._depth/this._segmentsD;D[y++]=1;r[_++]=-v;r[_++]=m;r[_++]=c*this._depth/this._segmentsD-b;r[_++]=v;r[_++]=m;r[_++]=c*this._depth/this._segmentsD-b;D[y++]=1}for(c=0;c<this._segmentsW;++c){r[_++]=v-c*this._width/this._segmentsW;r[_++]=-m;r[_++]=-b;r[_++]=v-c*this._width/this._segmentsW;r[_++]=-m;r[_++]=b;D[y++]=1;r[_++]=c*this._width/this._segmentsW-v;r[_++]=m;r[_++]=-b;r[_++]=c*this._width/this._segmentsW-v;r[_++]=m;r[_++]=b;D[y++]=1}A.setPositions(r);A.setThickness(D)}};e.prototype._pBuildUVs=function(t,e){var i,r,n;var a;var o;var l,h;var p,u;var c,f;var d,_;var y,v;var m;if(e==s.ElementsType.TRIANGLE){m=((this._segmentsW+1)*(this._segmentsH+1)+(this._segmentsW+1)*(this._segmentsD+1)+(this._segmentsH+1)*(this._segmentsD+1))*2;var b=t;if(b.uvs&&m==b.numVertices){b.invalidateVertices(b.uvs)}else{b.setUVs(new Float32Array(m*2))}a=b.uvs.get(m);o=b.uvs.stride;if(this._tile6){l=p=1/3;h=u=1/2}else{l=h=1;p=u=0}n=0;c=1*p;f=1*u;d=2*p;_=0*u;y=l/this._segmentsW;v=h/this._segmentsH;for(i=0;i<=this._segmentsW;i++){for(r=0;r<=this._segmentsH;r++){a[n]=(c+i*y)*this._scaleU;a[n+1]=(f+(h-r*v))*this._scaleV;n+=o;a[n]=(d+(l-i*y))*this._scaleU;a[n+1]=(_+(h-r*v))*this._scaleV;n+=o}}c=1*p;f=0*u;d=0*p;_=0*u;y=l/this._segmentsW;v=h/this._segmentsD;for(i=0;i<=this._segmentsW;i++){for(r=0;r<=this._segmentsD;r++){a[n]=(c+i*y)*this._scaleU;a[n+1]=(f+(h-r*v))*this._scaleV;n+=o;a[n]=(d+i*y)*this._scaleU;a[n+1]=(_+r*v)*this._scaleV;n+=o}}c=0*p;f=1*u;d=2*p;_=1*u;y=l/this._segmentsD;v=h/this._segmentsH;for(i=0;i<=this._segmentsD;i++){for(r=0;r<=this._segmentsH;r++){a[n]=(c+i*y)*this._scaleU;a[n+1]=(f+(h-r*v))*this._scaleV;n+=o;a[n]=(d+(l-i*y))*this._scaleU;a[n+1]=(_+(h-r*v))*this._scaleV;n+=o}}}else if(e==s.ElementsType.LINE){}};return e}(n.PrimitivePrefabBase);i.PrimitiveCubePrefab=a},{"../graphics/ElementsType":"awayjs-display/lib/graphics/ElementsType","../prefabs/PrimitivePrefabBase":"awayjs-display/lib/prefabs/PrimitivePrefabBase"}],"awayjs-display/lib/prefabs/PrimitiveCylinderPrefab":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../graphics/ElementsType");var n=t("../prefabs/PrimitivePrefabBase");var a=function(t){r(e,t);function e(e,i,r,s,n,a,o,l,h,p,u){if(e===void 0){e=null}if(i===void 0){i="triangle"}if(r===void 0){r=50}if(s===void 0){s=50}if(n===void 0){n=100}if(a===void 0){a=16}if(o===void 0){o=1}if(l===void 0){l=true}if(h===void 0){h=true}if(p===void 0){p=true}if(u===void 0){u=true}t.call(this,e,i);this._numVertices=0;this._topRadius=r;this._pBottomRadius=s;this._height=n;this._pSegmentsW=a;this._pSegmentsH=o;this._topClosed=l;this._bottomClosed=h;this._surfaceClosed=p;this._yUp=u}Object.defineProperty(e.prototype,"topRadius",{get:function(){return this._topRadius},set:function(t){this._topRadius=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bottomRadius",{get:function(){return this._pBottomRadius},set:function(t){this._pBottomRadius=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsW",{get:function(){return this._pSegmentsW},set:function(t){this.setSegmentsW(t)},enumerable:true,configurable:true});e.prototype.setSegmentsW=function(t){this._pSegmentsW=t;this._pInvalidatePrimitive();this._pInvalidateUVs()};Object.defineProperty(e.prototype,"segmentsH",{get:function(){return this._pSegmentsH},set:function(t){this.setSegmentsH(t)},enumerable:true,configurable:true});e.prototype.setSegmentsH=function(t){this._pSegmentsH=t;this._pInvalidatePrimitive();this._pInvalidateUVs()};Object.defineProperty(e.prototype,"topClosed",{get:function(){return this._topClosed},set:function(t){this._topClosed=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bottomClosed",{get:function(){return this._bottomClosed},set:function(t){this._bottomClosed=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"yUp",{get:function(){return this._yUp},set:function(t){this._yUp=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});e.prototype._pBuildGraphics=function(t,e){var i;var r;var n;var a;var o;var l;var h;var p;var u;var c;var f;var d;var _;var y;var v;var m;var b;var g=0;var w;var P;var x=0;var j=0;var E=0;var T;var A;this._numVertices=0;var C=2*Math.PI/this._pSegmentsW;if(e==s.ElementsType.TRIANGLE){var D=t;if(this._surfaceClosed){this._numVertices+=(this._pSegmentsH+1)*(this._pSegmentsW+1);g+=this._pSegmentsH*this._pSegmentsW*6}if(this._topClosed){this._numVertices+=2*(this._pSegmentsW+1);g+=this._pSegmentsW*3}if(this._bottomClosed){this._numVertices+=2*(this._pSegmentsW+1);g+=this._pSegmentsW*3}if(this._numVertices==D.numVertices){D.invalidateIndices();D.invalidateVertices(D.positions);D.invalidateVertices(D.normals);D.invalidateVertices(D.tangents)}else{D.setIndices(new Uint16Array(g));D.setPositions(new Float32Array(this._numVertices*3));D.setNormals(new Float32Array(this._numVertices*3));D.setTangents(new Float32Array(this._numVertices*3));this._pInvalidateUVs()}i=D.indices.get(D.numElements);r=D.positions.get(this._numVertices);n=D.normals.get(this._numVertices);a=D.tangents.get(this._numVertices);o=D.concatenatedBuffer.stride/4;f=0;d=0;if(this._topClosed&&this._topRadius>0){c=-.5*this._height;if(this._yUp){T=1;A=0;w=-c;P=0}else{T=0;A=-1;w=0;P=c}r[f]=0;r[f+1]=w;r[f+2]=P;n[f]=0;n[f+1]=T;n[f+2]=A;a[f]=1;a[f+1]=0;a[f+2]=0;f+=o;j++;for(l=0;l<=this._pSegmentsW;++l){y=l*C;p=this._topRadius*Math.cos(y);u=this._topRadius*Math.sin(y);if(this._yUp){w=-c;P=u}else{w=u;P=c}if(l==this._pSegmentsW){r[f]=r[x+3];r[f+1]=r[x+4];r[f+2]=r[x+5]}else{r[f]=p;r[f+1]=w;r[f+2]=P}n[f]=0;n[f+1]=T;n[f+2]=A;a[f]=1;a[f+1]=0;a[f+2]=0;f+=o;if(l>0){i[d++]=j-1;i[d++]=E;i[d++]=j}j++}}if(this._bottomClosed&&this._pBottomRadius>0){c=.5*this._height;x=f;E=j;if(this._yUp){T=-1;A=0;w=-c;P=0}else{T=0;A=1;w=0;P=c}if(l>0){r[f]=0;r[f+1]=w;r[f+2]=P;n[f]=0;n[f+1]=T;n[f+2]=A;a[f]=1;a[f+1]=0;a[f+2]=0;f+=o}j++;for(l=0;l<=this._pSegmentsW;++l){y=l*C;p=this._pBottomRadius*Math.cos(y);u=this._pBottomRadius*Math.sin(y);if(this._yUp){w=-c;P=u}else{w=u;P=c}if(l==this._pSegmentsW){r[f]=r[x+3];r[f+1]=r[x+4];r[f+2]=r[x+5]}else{r[f]=p;r[f+1]=w;r[f+2]=P}n[f]=0;n[f+1]=T;n[f+2]=A;a[f]=1;a[f+1]=0;a[f+2]=0;f+=o;if(l>0){i[d++]=j-1;i[d++]=j;i[d++]=E}j++}}v=this._pBottomRadius-this._topRadius;m=v/this._height;b=m==0?1:this._height/v;if(this._surfaceClosed){var O;var S;var M;var I;var B,N,L,R;for(h=0;h<=this._pSegmentsH;++h){_=this._topRadius-h/this._pSegmentsH*(this._topRadius-this._pBottomRadius);c=-(this._height/2)+h/this._pSegmentsH*this._height;x=f;for(l=0;l<=this._pSegmentsW;++l){y=l*C;p=_*Math.cos(y);u=_*Math.sin(y);B=b*Math.cos(y);N=b*Math.sin(y);if(this._yUp){T=0;A=-B;w=-c;P=u;L=m;R=N}else{T=-B;A=0;w=u;P=c;L=N;R=m}if(l==this._pSegmentsW){r[f]=r[x];r[f+1]=r[x+1];r[f+2]=r[x+2];n[f]=B;n[f+1]=m;n[f+2]=N;a[f]=N;a[f+1]=T;a[f+2]=A}else{r[f]=p;r[f+1]=w;r[f+2]=P;n[f]=B;n[f+1]=L;n[f+2]=R;a[f]=-N;a[f+1]=T;a[f+2]=A}f+=o;if(l>0&&h>0){O=j;S=j-1;M=S-this._pSegmentsW-1;I=O-this._pSegmentsW-1;i[d++]=O;i[d++]=S;i[d++]=M;i[d++]=O;i[d++]=M;i[d++]=I}j++}}}}else if(e==s.ElementsType.LINE){var F=t;var k=this._pSegmentsH*this._pSegmentsW*2+this._pSegmentsW;r=new Float32Array(k*6);var V=new Float32Array(k);f=0;d=0;var U=50;for(h=0;h<=this._pSegmentsH;++h){_=this._topRadius-h/this._pSegmentsH*(this._topRadius-this._pBottomRadius);c=-(this._height/2)+h/this._pSegmentsH*this._height;for(l=0;l<=this._pSegmentsW;++l){y=l*C;p=_*Math.cos(y);u=_*Math.sin(y);if(this._yUp){w=-c;P=u}else{w=u;P=c}if(l>0){r[f++]=p;r[f++]=w;r[f++]=P;V[d++]=1;if(h>0){var G=h==1?3-(6*(this._pSegmentsW-l)+12*l):3-this._pSegmentsW*12;r[f]=r[f++ +G];r[f]=r[f++ +G];r[f]=r[f++ +G];r[f++]=p;r[f++]=w;r[f++]=P;V[d++]=1}}if(l<this._pSegmentsW){r[f++]=p;r[f++]=w;r[f++]=P}}}F.setPositions(r);F.setThickness(V)}};e.prototype._pBuildUVs=function(t,e){var i;var r;var n;var a;var o;var l;var h;if(e==s.ElementsType.TRIANGLE){var p=t;if(p.uvs&&this._numVertices==p.numVertices){p.invalidateVertices(p.uvs)}else{p.setUVs(new Float32Array(this._numVertices*2))}l=p.uvs.get(this._numVertices);h=p.uvs.stride;var u=2*Math.PI/this._pSegmentsW;var c=0;if(this._topClosed){l[c]=.5*this._scaleU;l[c+1]=.5*this._scaleV;c+=h;for(i=0;i<=this._pSegmentsW;++i){o=i*u;n=.5+.5*-Math.cos(o);a=.5+.5*Math.sin(o);l[c]=n*this._scaleU;l[c+1]=a*this._scaleV;c+=h}}if(this._bottomClosed){l[c]=.5*this._scaleU;l[c+1]=.5*this._scaleV;c+=h;for(i=0;i<=this._pSegmentsW;++i){o=i*u;n=.5+.5*Math.cos(o);a=.5+.5*Math.sin(o);l[c]=n*this._scaleU;l[c+1]=a*this._scaleV;c+=h}}if(this._surfaceClosed){for(r=0;r<=this._pSegmentsH;++r){for(i=0;i<=this._pSegmentsW;++i){l[c]=i/this._pSegmentsW*this._scaleU;l[c+1]=r/this._pSegmentsH*this._scaleV;c+=h}}}}else if(e==s.ElementsType.LINE){}};return e}(n.PrimitivePrefabBase);i.PrimitiveCylinderPrefab=a},{"../graphics/ElementsType":"awayjs-display/lib/graphics/ElementsType","../prefabs/PrimitivePrefabBase":"awayjs-display/lib/prefabs/PrimitivePrefabBase"}],"awayjs-display/lib/prefabs/PrimitivePlanePrefab":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../graphics/ElementsType");var n=t("../prefabs/PrimitivePrefabBase");var a=function(t){r(e,t);function e(e,i,r,s,n,a,o,l){if(e===void 0){e=null}if(i===void 0){i="triangle"}if(r===void 0){r=100}if(s===void 0){s=100}if(n===void 0){n=1}if(a===void 0){a=1}if(o===void 0){o=true}if(l===void 0){l=false}t.call(this,e,i);this._segmentsW=n;this._segmentsH=a;this._yUp=o;this._width=r;this._height=s;this._doubleSided=l}Object.defineProperty(e.prototype,"segmentsW",{get:function(){return this._segmentsW},set:function(t){this._segmentsW=t;this._pInvalidatePrimitive();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsH",{get:function(){return this._segmentsH},set:function(t){this._segmentsH=t;this._pInvalidatePrimitive();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"yUp",{get:function(){return this._yUp},set:function(t){this._yUp=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"doubleSided",{get:function(){return this._doubleSided},set:function(t){this._doubleSided=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});e.prototype._pBuildGraphics=function(t,e){var i;var r,n;var a;var o;var l;var h=this._segmentsW+1;var p,u;var c;var f;if(e==s.ElementsType.TRIANGLE){var d=t;var _=(this._segmentsH+1)*h;var y;var v;var m;if(this._doubleSided)_*=2;a=this._segmentsH*this._segmentsW*6;if(this._doubleSided)a*=2;if(d.indices!=null&&a==d.indices.length){d.invalidateIndices()}else{d.setIndices(new Uint16Array(a));this._pInvalidateUVs()}i=d.indices.get(d.numElements);if(_==d.numVertices){d.invalidateVertices(d.positions);d.invalidateVertices(d.normals);d.invalidateVertices(d.tangents)}else{d.setPositions(new Float32Array(_*3));d.setNormals(new Float32Array(_*3));d.setTangents(new Float32Array(_*3));this._pInvalidateUVs()}y=d.positions.get(_);v=d.normals.get(_);m=d.tangents.get(_);o=d.concatenatedBuffer.stride/4;u=0;p=0;for(f=0;f<=this._segmentsH;++f){for(c=0;c<=this._segmentsW;++c){r=(c/this._segmentsW-.5)*this._width;n=(f/this._segmentsH-.5)*this._height;y[p]=r;if(this._yUp){y[p+1]=0;y[p+2]=n}else{y[p+1]=n;y[p+2]=0}v[p]=0;if(this._yUp){v[p+1]=1;v[p+2]=0}else{v[p+1]=0;v[p+2]=-1}m[p]=1;m[p+1]=0;m[p+2]=0;p+=o;if(this._doubleSided){for(var b=p;b<p+3;++b){y[b]=y[b-3];v[b]=-v[b-3];m[b]=-m[b-3]}p+=o}if(c!=this._segmentsW&&f!=this._segmentsH){l=c+f*h;var g=this._doubleSided?2:1;i[u++]=l*g;i[u++]=(l+h)*g;i[u++]=(l+h+1)*g;i[u++]=l*g;i[u++]=(l+h+1)*g;i[u++]=(l+1)*g;if(this._doubleSided){i[u++]=(l+h+1)*g+1;i[u++]=(l+h)*g+1;i[u++]=l*g+1;i[u++]=(l+1)*g+1;i[u++]=(l+h+1)*g+1;i[u++]=l*g+1}}}}}else if(e==s.ElementsType.LINE){var w=t;var P=this._segmentsH+1+h;var y;var x;var j=this._width/2;var E=this._height/2;y=new Float32Array(P*6);x=new Float32Array(P);u=0;p=0;for(f=0;f<=this._segmentsH;++f){y[p++]=-j;y[p++]=0;y[p++]=f*this._height-E;y[p++]=j;y[p++]=0;y[p++]=f*this._height-E;x[u++]=1}for(c=0;c<=this._segmentsW;++c){y[p++]=c*this._width-j;y[p++]=0;y[p++]=-E;y[p++]=c*this._width-j;y[p++]=0;y[p++]=E;x[u++]=1}w.setPositions(y);w.setThickness(x)}};e.prototype._pBuildUVs=function(t,e){var i;var r;var n;if(e==s.ElementsType.TRIANGLE){n=(this._segmentsH+1)*(this._segmentsW+1);if(this._doubleSided)n*=2;var a=t;if(a.uvs&&n==a.numVertices){a.invalidateVertices(a.uvs)}else{a.setUVs(new Float32Array(n*2))}i=a.uvs.get(n);r=a.uvs.stride;var o=0;for(var l=0;l<=this._segmentsH;++l){for(var h=0;h<=this._segmentsW;++h){i[o]=h/this._segmentsW*this._scaleU;i[o+1]=(1-l/this._segmentsH)*this._scaleV;o+=r;if(this._doubleSided){i[o]=h/this._segmentsW*this._scaleU;i[o+1]=(1-l/this._segmentsH)*this._scaleV;o+=r}}}}else if(e==s.ElementsType.LINE){}};return e}(n.PrimitivePrefabBase);i.PrimitivePlanePrefab=a},{"../graphics/ElementsType":"awayjs-display/lib/graphics/ElementsType","../prefabs/PrimitivePrefabBase":"awayjs-display/lib/prefabs/PrimitivePrefabBase"}],"awayjs-display/lib/prefabs/PrimitivePolygonPrefab":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../prefabs/PrimitiveCylinderPrefab");var n=function(t){r(e,t);function e(e,i,r,s,n){if(e===void 0){e=null}if(i===void 0){i="triangle"}if(r===void 0){r=100}if(s===void 0){s=16}if(n===void 0){n=true}t.call(this,e,i,r,0,0,s,1,true,false,false,n)}Object.defineProperty(e.prototype,"radius",{get:function(){return this._pBottomRadius},set:function(t){this._pBottomRadius=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"sides",{get:function(){return this._pSegmentsW},set:function(t){this.setSegmentsW(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"subdivisions",{get:function(){return this._pSegmentsH},set:function(t){this.setSegmentsH(t)},enumerable:true,configurable:true});return e}(s.PrimitiveCylinderPrefab);i.PrimitivePolygonPrefab=n},{"../prefabs/PrimitiveCylinderPrefab":"awayjs-display/lib/prefabs/PrimitiveCylinderPrefab"}],"awayjs-display/lib/prefabs/PrimitivePrefabBase":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/attributes/AttributesBuffer");var n=t("awayjs-core/lib/errors/AbstractMethodError");var a=t("../graphics/ElementsType");var o=t("../graphics/TriangleElements");var l=t("../graphics/LineElements");var h=t("../display/Sprite");var p=t("../prefabs/PrefabBase");var u=function(t){r(e,t);function e(e,i){if(e===void 0){e=null}if(i===void 0){i="triangle"}t.call(this);this._primitiveDirty=true;this._uvDirty=true;this._scaleU=1;this._scaleV=1;this._material=e;this._elementsType=i;if(this._elementsType==a.ElementsType.TRIANGLE){var r=new o.TriangleElements(new s.AttributesBuffer);r.autoDeriveNormals=false;r.autoDeriveTangents=false;this._elements=r}else if(this._elementsType==a.ElementsType.LINE){this._elements=new l.LineElements(new s.AttributesBuffer)}}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"elementsType",{get:function(){return this._elementsType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"material",{get:function(){return this._material},set:function(t){if(t==this._material)return;this._material=t;var e=this._pObjects.length;for(var i=0;i<e;i++)this._pObjects[i].material=this._material},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scaleU",{get:function(){return this._scaleU;
},set:function(t){if(this._scaleU=t)return;this._scaleU=t;this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scaleV",{get:function(){return this._scaleV},set:function(t){if(this._scaleV=t)return;this._scaleV=t;this._pInvalidateUVs()},enumerable:true,configurable:true});e.prototype._pBuildGraphics=function(t,e){throw new n.AbstractMethodError};e.prototype._pBuildUVs=function(t,e){throw new n.AbstractMethodError};e.prototype._pInvalidatePrimitive=function(){this._primitiveDirty=true};e.prototype._pInvalidateUVs=function(){this._uvDirty=true};e.prototype.updateGraphics=function(){this._pBuildGraphics(this._elements,this._elementsType);this._primitiveDirty=false};e.prototype.updateUVs=function(){this._pBuildUVs(this._elements,this._elementsType);this._uvDirty=false};e.prototype._iValidate=function(){if(this._primitiveDirty)this.updateGraphics();if(this._uvDirty)this.updateUVs()};e.prototype._pCreateObject=function(){var t=new h.Sprite(this._material);t.graphics.addGraphic(this._elements);t._iSourcePrefab=this;return t};e.assetType="[asset PrimitivePrefab]";return e}(p.PrefabBase);i.PrimitivePrefabBase=u},{"../display/Sprite":"awayjs-display/lib/display/Sprite","../graphics/ElementsType":"awayjs-display/lib/graphics/ElementsType","../graphics/LineElements":"awayjs-display/lib/graphics/LineElements","../graphics/TriangleElements":"awayjs-display/lib/graphics/TriangleElements","../prefabs/PrefabBase":"awayjs-display/lib/prefabs/PrefabBase","awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/errors/AbstractMethodError":undefined}],"awayjs-display/lib/prefabs/PrimitiveSpherePrefab":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../graphics/ElementsType");var n=t("../prefabs/PrimitivePrefabBase");var a=function(t){r(e,t);function e(e,i,r,s,n,a){if(e===void 0){e=null}if(i===void 0){i="triangle"}if(r===void 0){r=50}if(s===void 0){s=16}if(n===void 0){n=12}if(a===void 0){a=true}t.call(this,e,i);this._radius=r;this._segmentsW=s;this._segmentsH=n;this._yUp=a}Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsW",{get:function(){return this._segmentsW},set:function(t){this._segmentsW=t;this._pInvalidatePrimitive();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsH",{get:function(){return this._segmentsH},set:function(t){this._segmentsH=t;this._pInvalidatePrimitive();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"yUp",{get:function(){return this._yUp},set:function(t){this._yUp=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});e.prototype._pBuildGraphics=function(t,e){var i;var r;var n;var a;var o;var l;var h;var p,u;var c;var f;var d;if(e==s.ElementsType.TRIANGLE){var _=t;d=(this._segmentsH+1)*(this._segmentsW+1);if(d==_.numVertices&&_.indices!=null){_.invalidateIndices();_.invalidateVertices(_.positions);_.invalidateVertices(_.normals);_.invalidateVertices(_.tangents)}else{_.setIndices(new Uint16Array((this._segmentsH-1)*this._segmentsW*6));_.setPositions(new Float32Array(d*3));_.setNormals(new Float32Array(d*3));_.setTangents(new Float32Array(d*3));this._pInvalidateUVs()}i=_.indices.get(_.numElements);r=_.positions.get(d);n=_.normals.get(d);a=_.tangents.get(d);o=_.concatenatedBuffer.stride/4;p=0;u=0;var y;var v;var m;for(h=0;h<=this._segmentsH;++h){y=p;var b=Math.PI*h/this._segmentsH;var g=-this._radius*Math.cos(b);var w=this._radius*Math.sin(b);for(l=0;l<=this._segmentsW;++l){var P=2*Math.PI*l/this._segmentsW;var x=w*Math.cos(P);var j=w*Math.sin(P);var E=1/Math.sqrt(x*x+j*j+g*g);var T=Math.sqrt(j*j+x*x);if(this._yUp){v=0;m=T>.007?x/T:0;c=-g;f=j}else{v=T>.007?x/T:0;m=0;c=j;f=g}if(l==this._segmentsW){r[p]=r[y];r[p+1]=r[y+1];r[p+2]=r[y+2];n[p]=n[y]+x*E*.5;n[p+1]=n[y+1]+c*E*.5;n[p+2]=n[y+2]+f*E*.5;a[p]=T>.007?-j/T:1;a[p+1]=v;a[p+2]=m}else{r[p]=x;r[p+1]=c;r[p+2]=f;n[p]=x*E;n[p+1]=c*E;n[p+2]=f*E;a[p]=T>.007?-j/T:1;a[p+1]=v;a[p+2]=m}if(l>0&&h>0){var A=(this._segmentsW+1)*h+l;var C=(this._segmentsW+1)*h+l-1;var D=(this._segmentsW+1)*(h-1)+l-1;var O=(this._segmentsW+1)*(h-1)+l;if(h==this._segmentsH){r[p]=r[y];r[p+1]=r[y+1];r[p+2]=r[y+2];i[u++]=A;i[u++]=D;i[u++]=O}else if(h==1){i[u++]=A;i[u++]=C;i[u++]=D}else{i[u++]=A;i[u++]=C;i[u++]=D;i[u++]=A;i[u++]=D;i[u++]=O}}p+=o}}}else if(e==s.ElementsType.LINE){var S=t;var M=this._segmentsH*this._segmentsW*2+this._segmentsW;var r=new Float32Array(M*6);var I=new Float32Array(M);p=0;u=0;for(h=0;h<=this._segmentsH;++h){var b=Math.PI*h/this._segmentsH;var g=-this._radius*Math.cos(b);var w=this._radius*Math.sin(b);for(l=0;l<=this._segmentsW;++l){var P=2*Math.PI*l/this._segmentsW;var x=w*Math.cos(P);var j=w*Math.sin(P);if(this._yUp){c=-g;f=j}else{c=j;f=g}if(l>0){r[p++]=x;r[p++]=c;r[p++]=f;I[u++]=1;if(h>0){var B=h==1?3-(6*(this._segmentsW-l)+12*l):3-this._segmentsW*12;r[p]=r[p++ +B];r[p]=r[p++ +B];r[p]=r[p++ +B];r[p++]=x;r[p++]=c;r[p++]=f;I[u++]=1}}if(l<this._segmentsW){r[p++]=x;r[p++]=c;r[p++]=f}}}S.setPositions(r);S.setThickness(I)}};e.prototype._pBuildUVs=function(t,e){var i,r;var n=(this._segmentsH+1)*(this._segmentsW+1);var a;var o;if(e==s.ElementsType.TRIANGLE){n=(this._segmentsH+1)*(this._segmentsW+1);var l=t;if(l.uvs&&n==l.numVertices){l.invalidateVertices(l.uvs)}else{l.setUVs(new Float32Array(n*2))}a=l.uvs.get(n);o=l.uvs.stride;var h=0;for(r=0;r<=this._segmentsH;++r){for(i=0;i<=this._segmentsW;++i){a[h]=i/this._segmentsW*this._scaleU;a[h+1]=r/this._segmentsH*this._scaleV;h+=o}}}else if(e==s.ElementsType.LINE){}};return e}(n.PrimitivePrefabBase);i.PrimitiveSpherePrefab=a},{"../graphics/ElementsType":"awayjs-display/lib/graphics/ElementsType","../prefabs/PrimitivePrefabBase":"awayjs-display/lib/prefabs/PrimitivePrefabBase"}],"awayjs-display/lib/prefabs/PrimitiveTorusPrefab":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../graphics/ElementsType");var n=t("../prefabs/PrimitivePrefabBase");var a=function(t){r(e,t);function e(e,i,r,s,n,a,o){if(e===void 0){e=null}if(i===void 0){i="triangle"}if(r===void 0){r=50}if(s===void 0){s=50}if(n===void 0){n=16}if(a===void 0){a=8}if(o===void 0){o=true}t.call(this,e,i);this._numVertices=0;this._radius=r;this._tubeRadius=s;this._segmentsR=n;this._segmentsT=a;this._yUp=o}Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"tubeRadius",{get:function(){return this._tubeRadius},set:function(t){this._tubeRadius=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsR",{get:function(){return this._segmentsR},set:function(t){this._segmentsR=t;this._pInvalidatePrimitive();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsT",{get:function(){return this._segmentsT},set:function(t){this._segmentsT=t;this._pInvalidatePrimitive();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"yUp",{get:function(){return this._yUp},set:function(t){this._yUp=t;this._pInvalidatePrimitive()},enumerable:true,configurable:true});e.prototype._pBuildGraphics=function(t,e){var i;var r;var n;var a;var o;var l,h;var p,u,c,f,d,_,y,v;var m;var b;var g=0;if(e==s.ElementsType.TRIANGLE){var w=t;this._numVertices=(this._segmentsT+1)*(this._segmentsR+1);g=this._segmentsT*this._segmentsR*6;if(this._numVertices==w.numVertices){w.invalidateIndices();w.invalidateVertices(w.positions);w.invalidateVertices(w.normals);w.invalidateVertices(w.tangents)}else{w.setIndices(new Uint16Array(g));w.setPositions(new Float32Array(this._numVertices*3));w.setNormals(new Float32Array(this._numVertices*3));w.setTangents(new Float32Array(this._numVertices*3));this._pInvalidateUVs()}i=w.indices.get(w.numElements);r=w.positions.get(this._numVertices);n=w.normals.get(this._numVertices);a=w.tangents.get(this._numVertices);o=w.concatenatedBuffer.stride/4;m=0;b=0;var P=2*Math.PI/this._segmentsR;var x=2*Math.PI/this._segmentsT;var j,E;var T,A,C,D;var O=0;var S=0;var M,I,B,N,L;for(h=0;h<=this._segmentsT;++h){O=m;for(l=0;l<=this._segmentsR;++l){y=l*P;v=h*x;L=Math.cos(v);f=L*Math.cos(y);d=L*Math.sin(y);_=Math.sin(v);p=this._radius*Math.cos(y)+this._tubeRadius*f;u=this._radius*Math.sin(y)+this._tubeRadius*d;c=h==this._segmentsT?0:this._tubeRadius*_;if(this._yUp){C=-_;D=d;T=0;A=L?f/L:p/this._radius;j=-c;E=u}else{C=d;D=_;T=L?f/L:p/this._radius;A=0;j=u;E=c}if(l==this._segmentsR){r[m]=p;r[m+1]=r[O+1];r[m+2]=r[O+2]}else{r[m]=p;r[m+1]=j;r[m+2]=E}n[m]=f;n[m+1]=C;n[m+2]=D;a[m]=-(L?d/L:u/this._radius);a[m+1]=T;a[m+2]=A;m+=o;if(l>0&&h>0){M=S;I=S-1;B=I-this._segmentsR-1;N=M-this._segmentsR-1;i[b++]=M;i[b++]=I;i[b++]=B;i[b++]=M;i[b++]=B;i[b++]=N}S++}}}else if(e==s.ElementsType.LINE){}};e.prototype._pBuildUVs=function(t,e){var i,r;var n;var a;if(e==s.ElementsType.TRIANGLE){var o=t;if(o.uvs&&this._numVertices==o.numVertices){o.invalidateVertices(o.uvs)}else{o.setUVs(new Float32Array(this._numVertices*2))}n=o.uvs.get(this._numVertices);a=o.uvs.stride;var l=0;for(r=0;r<=this._segmentsT;++r){for(i=0;i<=this._segmentsR;++i){n[l]=i/this._segmentsR*this._scaleU;n[l+1]=r/this._segmentsT*this._scaleV;l+=a}}}else if(e==s.ElementsType.LINE){}};return e}(n.PrimitivePrefabBase);i.PrimitiveTorusPrefab=a},{"../graphics/ElementsType":"awayjs-display/lib/graphics/ElementsType","../prefabs/PrimitivePrefabBase":"awayjs-display/lib/prefabs/PrimitivePrefabBase"}],"awayjs-display/lib/prefabs":[function(t,e,i){"use strict";var r=t("./prefabs/PrefabBase");i.PrefabBase=r.PrefabBase;var s=t("./prefabs/PrimitiveCapsulePrefab");i.PrimitiveCapsulePrefab=s.PrimitiveCapsulePrefab;var n=t("./prefabs/PrimitiveConePrefab");i.PrimitiveConePrefab=n.PrimitiveConePrefab;var a=t("./prefabs/PrimitiveCubePrefab");i.PrimitiveCubePrefab=a.PrimitiveCubePrefab;var o=t("./prefabs/PrimitiveCylinderPrefab");i.PrimitiveCylinderPrefab=o.PrimitiveCylinderPrefab;var l=t("./prefabs/PrimitivePlanePrefab");i.PrimitivePlanePrefab=l.PrimitivePlanePrefab;var h=t("./prefabs/PrimitivePolygonPrefab");i.PrimitivePolygonPrefab=h.PrimitivePolygonPrefab;var p=t("./prefabs/PrimitivePrefabBase");i.PrimitivePrefabBase=p.PrimitivePrefabBase;var u=t("./prefabs/PrimitiveSpherePrefab");i.PrimitiveSpherePrefab=u.PrimitiveSpherePrefab;var c=t("./prefabs/PrimitiveTorusPrefab");i.PrimitiveTorusPrefab=c.PrimitiveTorusPrefab},{"./prefabs/PrefabBase":"awayjs-display/lib/prefabs/PrefabBase","./prefabs/PrimitiveCapsulePrefab":"awayjs-display/lib/prefabs/PrimitiveCapsulePrefab","./prefabs/PrimitiveConePrefab":"awayjs-display/lib/prefabs/PrimitiveConePrefab","./prefabs/PrimitiveCubePrefab":"awayjs-display/lib/prefabs/PrimitiveCubePrefab","./prefabs/PrimitiveCylinderPrefab":"awayjs-display/lib/prefabs/PrimitiveCylinderPrefab","./prefabs/PrimitivePlanePrefab":"awayjs-display/lib/prefabs/PrimitivePlanePrefab","./prefabs/PrimitivePolygonPrefab":"awayjs-display/lib/prefabs/PrimitivePolygonPrefab","./prefabs/PrimitivePrefabBase":"awayjs-display/lib/prefabs/PrimitivePrefabBase","./prefabs/PrimitiveSpherePrefab":"awayjs-display/lib/prefabs/PrimitiveSpherePrefab","./prefabs/PrimitiveTorusPrefab":"awayjs-display/lib/prefabs/PrimitiveTorusPrefab"}],"awayjs-display/lib/text/AntiAliasType":[function(t,e,i){"use strict";var r=function(){function t(){}t.ADVANCED="advanced";t.NORMAL="normal";return t}();i.AntiAliasType=r},{}],"awayjs-display/lib/text/BitmapFontChar":[function(t,e,i){"use strict";var r=function(){function t(t,e,i,r,s,n,a,o,l,h){this.id=t;this.x=e;this.y=i;this.width=r;this.height=s;this.x_offset=n;this.y_offset=a;this.x_advance=o;this.page=l;this.channel=h}return t}();i.BitmapFontChar=r},{}],"awayjs-display/lib/text/BitmapFontTable":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/library/AssetBase");var n=t("../text/BitmapFontChar");var a=function(t){r(e,t);function e(){t.call(this);this._font_chars=[];this._bitmap_pages=[];this._font_chars_dic=new Object;this._ascent=0;this._descent=0;this._current_size=0;this._size_multiply=0;this._init_size=0}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.initFontSize=function(t){if(this._current_size==t)return;this._current_size=t;this._size_multiply=t/this._init_size};e.prototype.getCharDataCanvas=function(t){var e=this._font_chars_dic[t];if(e){return[e.x,e.y,e.width,e.height,e.x_offset*this._size_multiply,e.y_offset*this._size_multiply]}return[]};e.prototype.getCharData=function(t){var e=this._font_chars_dic[t];if(e){return[e.x/256,e.y/256,e.width/256,e.height/256,e.x_offset*this._size_multiply,e.y_offset*this._size_multiply]}return[]};e.prototype.getCharVertCnt=function(t){return 6*4};e.prototype.getCharWidth=function(t){var e=this._font_chars_dic[t];if(e)return this._size_multiply*e.x_advance;return 0};e.prototype.getLineHeight=function(){return this._current_size};e.prototype.dispose=function(){};e.prototype.add_page=function(t){this._bitmap_pages.push(t)};e.prototype.get_page=function(t){if(t===void 0){t=0}return this._bitmap_pages[t]};Object.defineProperty(e.prototype,"ascent",{get:function(){return this._ascent},set:function(t){this._ascent=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"descent",{get:function(){return this._descent},set:function(t){this._descent=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"offset_x",{get:function(){return this._offset_x},set:function(t){this._offset_x=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"offset_y",{get:function(){return this._offset_y},set:function(t){this._offset_y=t},enumerable:true,configurable:true});e.prototype.get_font_chars=function(){return this._font_chars};e.prototype.get_font_em_size=function(){return this._font_em_size};e.prototype.set_whitespace_width=function(t){this._whitespace_width=t};e.prototype.get_whitespace_width=function(){return this._whitespace_width};e.prototype.set_font_em_size=function(t){this._font_em_size=t};e.prototype.getChar=function(t){return this._font_chars_dic[t]};e.prototype.setChar=function(t,e,i,r,s,a,o,l,h,p){var u=new n.BitmapFontChar(t,e,i,r,s,a,o,l,h,p);this._font_chars.push(u);this._font_chars_dic[t]=u};e.assetType="[asset BitmapFontTable]";return e}(s.AssetBase);i.BitmapFontTable=a},{"../text/BitmapFontChar":"awayjs-display/lib/text/BitmapFontChar","awayjs-core/lib/library/AssetBase":undefined}],"awayjs-display/lib/text/Font":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/library/AssetBase");var n=t("../text/TesselatedFontTable");var a=t("../text/BitmapFontTable");var o=function(t){r(e,t);function e(){t.call(this);this._font_styles=[]}Object.defineProperty(e.prototype,"font_styles",{get:function(){return this._font_styles},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.dispose=function(){};e.prototype.get_font_table=function(t,e){if(e===void 0){e=n.TesselatedFontTable.assetType}var i=this._font_styles.length;for(var r=0;r<i;++r){if(this._font_styles[r].assetType==e&&this._font_styles[r].name==t){return this._font_styles[r]}}var s=null;if(e==n.TesselatedFontTable.assetType){s=new n.TesselatedFontTable}else if(e==a.BitmapFontTable.assetType){s=new a.BitmapFontTable}s.name=t;this._font_styles.push(s);return s};e.assetType="[asset Font]";return e}(s.AssetBase);i.Font=o},{"../text/BitmapFontTable":"awayjs-display/lib/text/BitmapFontTable","../text/TesselatedFontTable":"awayjs-display/lib/text/TesselatedFontTable","awayjs-core/lib/library/AssetBase":undefined}],"awayjs-display/lib/text/GridFitType":[function(t,e,i){"use strict";var r=function(){function t(){}t.NONE="none";t.PIXEL="pixel";t.SUBPIXEL="subpixel";return t}();i.GridFitType=r},{}],"awayjs-display/lib/text/IFontTable":[function(t,e,i){"use strict"},{}],"awayjs-display/lib/text/TesselatedFontChar":[function(t,e,i){"use strict";var r=function(){function t(t){this.kerningCharCodes=[];this.kerningValues=[];this.elements=t}return t}();i.TesselatedFontChar=r},{}],"awayjs-display/lib/text/TesselatedFontTable":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/library/AssetBase");var n=t("../text/TesselatedFontChar");var a=function(t){r(e,t);function e(){t.call(this);this._font_chars=[];this._font_chars_dic=new Object;this._ascent=0;this._descent=0;this._current_size=0;this._size_multiply=0;this._font_em_size=0}e.prototype.initFontSize=function(t){if(this._current_size==t)return;this._current_size=t;this._size_multiply=t/this._font_em_size};e.prototype.getCharVertCnt=function(t){var e=this._font_chars_dic[t];if(e){return e.elements.numVertices*3}return 0};e.prototype.getCharWidth=function(t){var e=this._font_chars_dic[t];if(e){return e.char_width*this._size_multiply}return 0};e.prototype.getLineHeight=function(){return 0};Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.dispose=function(){};Object.defineProperty(e.prototype,"ascent",{get:function(){return this._ascent},set:function(t){this._ascent=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"descent",{get:function(){return this._descent},set:function(t){this._descent=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"offset_x",{get:function(){return this._offset_x},set:function(t){this._offset_x=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"offset_y",{get:function(){return this._offset_y},set:function(t){this._offset_y=t},enumerable:true,configurable:true});e.prototype.get_font_chars=function(){return this._font_chars};e.prototype.get_font_em_size=function(){return this._font_em_size};e.prototype.set_whitespace_width=function(t){this._whitespace_width=t};e.prototype.get_whitespace_width=function(){return this._whitespace_width};e.prototype.set_font_em_size=function(t){this._font_em_size=t};e.prototype.getChar=function(t){return this._font_chars_dic[t]};e.prototype.setChar=function(t,e,i){var r=new n.TesselatedFontChar(e);r.char_width=i;e.name=t;this._font_chars.push(r);this._font_chars_dic[t]=r};e.assetType="[asset TesselatedFontTable]";return e}(s.AssetBase);i.TesselatedFontTable=a},{"../text/TesselatedFontChar":"awayjs-display/lib/text/TesselatedFontChar","awayjs-core/lib/library/AssetBase":undefined}],"awayjs-display/lib/text/TextFieldAutoSize":[function(t,e,i){"use strict";var r=function(){function t(){}t.CENTER="center";t.LEFT="left";t.NONE="none";t.RIGHT="right";return t}();i.TextFieldAutoSize=r},{}],"awayjs-display/lib/text/TextFieldType":[function(t,e,i){"use strict";var r=function(){function t(){}t.DYNAMIC="dynamic";t.INPUT="input";t.STATIC="input";return t}();i.TextFieldType=r},{}],"awayjs-display/lib/text/TextFormatAlign":[function(t,e,i){"use strict";var r=function(){function t(){this.CENTER="center";this.JUSTIFY="justify";this.LEFT="left";this.RIGHT="right"}return t}();i.TextFormatAlign=r},{}],"awayjs-display/lib/text/TextFormat":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/library/AssetBase");var n=function(t){r(e,t);function e(e,i,r,s,n,a,o,l,h,p,u,c,f){if(e===void 0){e="Times New Roman"}if(i===void 0){i=12}if(r===void 0){r=0}if(s===void 0){s=false}if(n===void 0){n=false}if(a===void 0){a=false}if(o===void 0){o=""}if(l===void 0){l=""}if(h===void 0){h="left"}if(p===void 0){p=0}if(u===void 0){u=0}if(c===void 0){c=0}if(f===void 0){f=0}t.call(this);this.tabStops=[];this.font_name=e;this.size=i;this.bold=s;this.italic=n;this.underline=a;this.url=o;this.link_target=l;this.align=h;this.leftMargin=p;this.rightMargin=u;this.indent=c;this.leading=f}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.assetType="[asset TextFormat]";return e}(s.AssetBase);i.TextFormat=n},{"awayjs-core/lib/library/AssetBase":undefined}],"awayjs-display/lib/text/TextInteractionMode":[function(t,e,i){"use strict";var r=function(){function t(){}t.NORMAL="normal";t.SELECTION="selection";return t}();i.TextInteractionMode=r},{}],"awayjs-display/lib/text/TextLineMetrics":[function(t,e,i){"use strict";var r=function(){function t(t,e,i,r,s,n){if(t===void 0){t=NaN}if(e===void 0){e=NaN}if(i===void 0){i=NaN}if(r===void 0){r=NaN}if(s===void 0){s=NaN}if(n===void 0){n=NaN}}return t}();i.TextLineMetrics=r},{}],"awayjs-display/lib/text":[function(t,e,i){"use strict";var r=t("./text/AntiAliasType");i.AntiAliasType=r.AntiAliasType;var s=t("./text/Font");i.Font=s.Font;var n=t("./text/GridFitType");i.GridFitType=n.GridFitType;var a=t("./text/TesselatedFontTable");i.TesselatedFontTable=a.TesselatedFontTable;var o=t("./text/BitmapFontTable");i.BitmapFontTable=o.BitmapFontTable;var l=t("./text/TesselatedFontChar");i.TesselatedFontChar=l.TesselatedFontChar;var h=t("./text/BitmapFontChar");i.BitmapFontChar=h.BitmapFontChar;var p=t("./text/TextFieldAutoSize");i.TextFieldAutoSize=p.TextFieldAutoSize;var u=t("./text/TextFieldType");i.TextFieldType=u.TextFieldType;var c=t("./text/TextFormat");i.TextFormat=c.TextFormat;var f=t("./text/TextFormatAlign");i.TextFormatAlign=f.TextFormatAlign;var d=t("./text/TextInteractionMode");i.TextInteractionMode=d.TextInteractionMode;var _=t("./text/TextLineMetrics");i.TextLineMetrics=_.TextLineMetrics},{"./text/AntiAliasType":"awayjs-display/lib/text/AntiAliasType","./text/BitmapFontChar":"awayjs-display/lib/text/BitmapFontChar","./text/BitmapFontTable":"awayjs-display/lib/text/BitmapFontTable","./text/Font":"awayjs-display/lib/text/Font","./text/GridFitType":"awayjs-display/lib/text/GridFitType","./text/TesselatedFontChar":"awayjs-display/lib/text/TesselatedFontChar","./text/TesselatedFontTable":"awayjs-display/lib/text/TesselatedFontTable","./text/TextFieldAutoSize":"awayjs-display/lib/text/TextFieldAutoSize","./text/TextFieldType":"awayjs-display/lib/text/TextFieldType","./text/TextFormat":"awayjs-display/lib/text/TextFormat","./text/TextFormatAlign":"awayjs-display/lib/text/TextFormatAlign","./text/TextInteractionMode":"awayjs-display/lib/text/TextInteractionMode","./text/TextLineMetrics":"awayjs-display/lib/text/TextLineMetrics"}],"awayjs-display/lib/textures/MappingMode":[function(t,e,i){"use strict";var r=function(){function t(){}t.NORMAL="normal";t.LINEAR_GRADIENT="linearGradient";t.RADIAL_GRADIENT="radialGradient";return t}();i.MappingMode=r},{}],"awayjs-display/lib/textures/Single2DTexture":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/errors/ErrorBase");var n=t("awayjs-core/lib/utils/ImageUtils");var a=t("../textures/MappingMode");var o=t("../textures/TextureBase");var l=function(t){r(e,t);function e(e){if(e===void 0){e=null}t.call(this);this.setNumImages(1);this.image2D=e;this._mappingMode=a.MappingMode.NORMAL}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mappingMode",{get:function(){return this._mappingMode},set:function(t){if(this._mappingMode==t)return;this._mappingMode=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"sampler2D",{get:function(){return this._samplers[0]},set:function(t){if(this._samplers[0]==t)return;this.setSamplerAt(t,0)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"image2D",{get:function(){return this._images[0]},set:function(t){if(this._images[0]==t)return;if(!n.ImageUtils.isImage2DValid(t))throw new s.ErrorBase("Invalid image2DData: Width and height must be power of 2 and cannot exceed 2048");this.setImageAt(t,0)},enumerable:true,configurable:true});e.assetType="[texture Single2DTexture]";return e}(o.TextureBase);i.Single2DTexture=l},{"../textures/MappingMode":"awayjs-display/lib/textures/MappingMode","../textures/TextureBase":"awayjs-display/lib/textures/TextureBase","awayjs-core/lib/errors/ErrorBase":undefined,"awayjs-core/lib/utils/ImageUtils":undefined}],"awayjs-display/lib/textures/SingleCubeTexture":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("../textures/TextureBase");var n=function(t){r(e,t);function e(e){if(e===void 0){e=null}t.call(this);this.setNumImages(1);this.imageCube=e}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"samplerCube",{get:function(){return this._samplers[0]},set:function(t){if(this._samplers[0]==t)return;this.setSamplerAt(t,0)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"imageCube",{get:function(){return this._images[0]},set:function(t){if(this._images[0]==t)return;this.setImageAt(t,0)},enumerable:true,configurable:true});e.assetType="[texture SingleCubeTexture]";return e}(s.TextureBase);i.SingleCubeTexture=n},{"../textures/TextureBase":"awayjs-display/lib/textures/TextureBase"}],"awayjs-display/lib/textures/TextureBase":[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)};var s=t("awayjs-core/lib/library/AssetBase");var n=function(t){r(e,t);function e(){t.call(this);this._numImages=0;this._images=new Array;this._samplers=new Array}e.prototype.getNumImages=function(){return this._numImages};e.prototype.setNumImages=function(t){if(this._numImages==t)return;this._numImages=t;this._images.length=t;this._samplers.length=t;this.invalidate()};e.prototype.getImageAt=function(t){return this._images[t]};e.prototype.setImageAt=function(t,e){this._images[e]=t;this.invalidate()};e.prototype.getSamplerAt=function(t){return this._samplers[t]};e.prototype.setSamplerAt=function(t,e){this._samplers[e]=t;this.invalidate()};return e}(s.AssetBase);i.TextureBase=n},{"awayjs-core/lib/library/AssetBase":undefined}],"awayjs-display/lib/textures":[function(t,e,i){"use strict";var r=t("./textures/MappingMode");i.MappingMode=r.MappingMode;var s=t("./textures/Single2DTexture");i.Single2DTexture=s.Single2DTexture;var n=t("./textures/SingleCubeTexture");i.SingleCubeTexture=n.SingleCubeTexture;var a=t("./textures/TextureBase");i.TextureBase=a.TextureBase},{"./textures/MappingMode":"awayjs-display/lib/textures/MappingMode","./textures/Single2DTexture":"awayjs-display/lib/textures/Single2DTexture","./textures/SingleCubeTexture":"awayjs-display/lib/textures/SingleCubeTexture","./textures/TextureBase":"awayjs-display/lib/textures/TextureBase"}],"awayjs-display/lib/utils/Cast":[function(t,e,i){"use strict";var r=t("awayjs-core/lib/image/Image2D");var s=t("awayjs-core/lib/utils/ByteArray");var n=t("../errors/CastError");var a=t("../textures/Single2DTexture");var o=function(){function t(){}t.string=function(t){if(typeof t=="function")t=new t;if(typeof t=="string")return t;return t};t.byteArray=function(t){if(typeof t=="function")t=new t;if(t instanceof s.ByteArray)return t;return t};t.isHex=function(t){var e=t.length;for(var i=0;i<e;++i){if(this._hexChars.indexOf(t.charAt(i))==-1)return false}return true};t.tryColor=function(t){if(typeof t=="number")return Math.floor(t);if(typeof t=="string"){if(t=="random")return Math.floor(Math.random()*16777216);if(this._colorNames==null){this._colorNames=new Object;this._colorNames["steelblue"]=4620980;this._colorNames["royalblue"]=267920;this._colorNames["cornflowerblue"]=6591981;this._colorNames["lightsteelblue"]=11584734;this._colorNames["mediumslateblue"]=8087790;this._colorNames["slateblue"]=6970061;this._colorNames["darkslateblue"]=4734347;this._colorNames["midnightblue"]=1644912;this._colorNames["navy"]=128;this._colorNames["darkblue"]=139;this._colorNames["mediumblue"]=205;this._colorNames["blue"]=255;this._colorNames["dodgerblue"]=2003199;this._colorNames["deepskyblue"]=49151;this._colorNames["lightskyblue"]=8900346;this._colorNames["skyblue"]=8900331;this._colorNames["lightblue"]=11393254;this._colorNames["powderblue"]=11591910;this._colorNames["azure"]=15794175;this._colorNames["lightcyan"]=14745599;this._colorNames["paleturquoise"]=11529966;this._colorNames["mediumturquoise"]=4772300;this._colorNames["lightseagreen"]=2142890;this._colorNames["darkcyan"]=35723;this._colorNames["teal"]=32896;this._colorNames["cadetblue"]=6266528;this._colorNames["darkturquoise"]=52945;this._colorNames["aqua"]=65535;this._colorNames["cyan"]=65535;this._colorNames["turquoise"]=4251856;this._colorNames["aquamarine"]=8388564;this._colorNames["mediumaquamarine"]=6737322;this._colorNames["darkseagreen"]=9419919;this._colorNames["mediumseagreen"]=3978097;this._colorNames["seagreen"]=3050327;this._colorNames["darkgreen"]=25600;this._colorNames["green"]=32768;this._colorNames["forestgreen"]=2263842;this._colorNames["limegreen"]=3329330;this._colorNames["lime"]=65280;this._colorNames["chartreuse"]=8388352;this._colorNames["lawngreen"]=8190976;this._colorNames["greenyellow"]=11403055;this._colorNames["yellowgreen"]=10145074;this._colorNames["palegreen"]=10025880;this._colorNames["lightgreen"]=9498256;this._colorNames["springgreen"]=65407;this._colorNames["mediumspringgreen"]=64154;this._colorNames["darkolivegreen"]=5597999;this._colorNames["olivedrab"]=7048739;this._colorNames["olive"]=8421376;this._colorNames["darkkhaki"]=12433259;this._colorNames["darkgoldenrod"]=12092939;this._colorNames["goldenrod"]=14329120;this._colorNames["gold"]=16766720;this._colorNames["yellow"]=16776960;this._colorNames["khaki"]=15787660;this._colorNames["palegoldenrod"]=15657130;this._colorNames["blanchedalmond"]=16772045;this._colorNames["moccasin"]=16770229;this._colorNames["wheat"]=16113331;this._colorNames["navajowhite"]=16768685;this._colorNames["burlywood"]=14596231;this._colorNames["tan"]=13808780;this._colorNames["rosybrown"]=12357519;this._colorNames["sienna"]=10506797;this._colorNames["saddlebrown"]=9127187;this._colorNames["chocolate"]=13789470;this._colorNames["peru"]=13468991;this._colorNames["sandybrown"]=16032864;this._colorNames["darkred"]=9109504;this._colorNames["maroon"]=8388608;this._colorNames["brown"]=10824234;this._colorNames["firebrick"]=11674146;this._colorNames["indianred"]=13458524;this._colorNames["lightcoral"]=15761536;this._colorNames["salmon"]=16416882;this._colorNames["darksalmon"]=15308410;this._colorNames["lightsalmon"]=16752762;this._colorNames["coral"]=16744272;this._colorNames["tomato"]=16737095;
this._colorNames["darkorange"]=16747520;this._colorNames["orange"]=16753920;this._colorNames["orangered"]=16729344;this._colorNames["crimson"]=14423100;this._colorNames["red"]=16711680;this._colorNames["deeppink"]=16716947;this._colorNames["fuchsia"]=16711935;this._colorNames["magenta"]=16711935;this._colorNames["hotpink"]=16738740;this._colorNames["lightpink"]=16758465;this._colorNames["pink"]=16761035;this._colorNames["palevioletred"]=14381203;this._colorNames["mediumvioletred"]=13047173;this._colorNames["purple"]=8388736;this._colorNames["darkmagenta"]=9109643;this._colorNames["mediumpurple"]=9662683;this._colorNames["blueviolet"]=9055202;this._colorNames["indigo"]=4915330;this._colorNames["darkviolet"]=9699539;this._colorNames["darkorchid"]=10040012;this._colorNames["mediumorchid"]=12211667;this._colorNames["orchid"]=14315734;this._colorNames["violet"]=15631086;this._colorNames["plum"]=14524637;this._colorNames["thistle"]=14204888;this._colorNames["lavender"]=15132410;this._colorNames["ghostwhite"]=16316671;this._colorNames["aliceblue"]=15792383;this._colorNames["mintcream"]=16121850;this._colorNames["honeydew"]=15794160;this._colorNames["lightgoldenrodyellow"]=16448210;this._colorNames["lemonchiffon"]=16775885;this._colorNames["cornsilk"]=16775388;this._colorNames["lightyellow"]=16777184;this._colorNames["ivory"]=16777200;this._colorNames["floralwhite"]=16775920;this._colorNames["linen"]=16445670;this._colorNames["oldlace"]=16643558;this._colorNames["antiquewhite"]=16444375;this._colorNames["bisque"]=16770244;this._colorNames["peachpuff"]=16767673;this._colorNames["papayawhip"]=16773077;this._colorNames["beige"]=16119260;this._colorNames["seashell"]=16774638;this._colorNames["lavenderblush"]=16773365;this._colorNames["mistyrose"]=16770273;this._colorNames["snow"]=16775930;this._colorNames["white"]=16777215;this._colorNames["whitesmoke"]=16119285;this._colorNames["gainsboro"]=14474460;this._colorNames["lightgrey"]=13882323;this._colorNames["silver"]=12632256;this._colorNames["darkgrey"]=11119017;this._colorNames["grey"]=8421504;this._colorNames["lightslategrey"]=7833753;this._colorNames["slategrey"]=7372944;this._colorNames["dimgrey"]=6908265;this._colorNames["darkslategrey"]=3100495;this._colorNames["black"]=0;this._colorNames["transparent"]=4278190080}if(this._colorNames[t]!=null)return this._colorNames[t];if(t.length==6&&this.isHex(t))return parseInt("0x"+t)}return null};t.color=function(t){var e=this.tryColor(t);if(e==null)throw new n.CastError("Can't cast to color: "+t);return e};t.tryClass=function(t){if(this._notClasses[t])return t;var e=this._classes[t];if(e!=null)return e;try{e=window[t];this._classes[t]=e;return e}catch(i){}this._notClasses[t]=true;return t};t.image2D=function(t){if(t==null)return null;if(typeof t=="string")t=this.tryClass(t);if(typeof t=="function"){try{t=new t}catch(e){t=new t(0,0)}}if(t instanceof r.Image2D)return t;if(t instanceof a.Single2DTexture)t=t.image2D;throw new n.CastError("Can't cast to BitmapImage2D: "+t)};t.bitmapTexture=function(e){if(e==null)return null;if(typeof e=="string")e=this.tryClass(e);if(typeof e=="function"){try{e=new e}catch(i){e=new e(0,0)}}if(e instanceof a.Single2DTexture)return e;try{var r=t.image2D(e);return new a.Single2DTexture(r)}catch(i){}throw new n.CastError("Can't cast to Single2DTexture: "+e)};t._hexChars="0123456789abcdefABCDEF";t._notClasses=new Object;t._classes=new Object;return t}();i.Cast=o},{"../errors/CastError":"awayjs-display/lib/errors/CastError","../textures/Single2DTexture":"awayjs-display/lib/textures/Single2DTexture","awayjs-core/lib/image/Image2D":undefined,"awayjs-core/lib/utils/ByteArray":undefined}],"awayjs-display/lib/utils/ElementsUtils":[function(t,e,i){"use strict";var r=t("awayjs-core/lib/attributes/AttributesBuffer");var s=t("awayjs-core/lib/attributes/Float3Attributes");var n=t("awayjs-core/lib/attributes/Float4Attributes");var a=t("awayjs-core/lib/attributes/Byte4Attributes");var o=t("awayjs-core/lib/geom/Vector3D");var l=t("awayjs-core/lib/geom/Box");var h=t("awayjs-core/lib/geom/Sphere");var p=t("../graphics/HitTestCache");var u=function(){function t(){}t.generateFaceNormals=function(t,e,i,r,s){if(s===void 0){s=0}var a=t.get(r,s);var o=e.get(e.count);if(i==null)i=new n.Float4Attributes(r+s);else if(i.count<r+s)i.count=r+s;var l=t.stride;var h=e.dimensions;var p=e.stride;var u=i.get(r,s);var c=r*l;var f=0;var d=0;var _;var y,v,m;var b,g,w;var P,x,j;var E,T,A;var C,D,O;var S,M,I;var B;if(h==3){for(f=0;f<c;f+=l){_=a[f]*p;y=o[_];b=o[_+1];P=o[_+2];_=a[f+1]*p;v=o[_];g=o[_+1];x=o[_+2];_=a[f+2]*p;m=o[_];w=o[_+1];j=o[_+2];E=m-y;T=w-b;A=j-P;C=v-y;D=g-b;O=x-P;S=A*D-T*O;M=E*O-A*C;I=T*C-E*D;B=Math.sqrt(S*S+M*M+I*I);u[d++]=S;u[d++]=M;u[d++]=I;u[d++]=B}}else if(h==2){for(f=0;f<c;f+=l){u[d++]=0;u[d++]=0;u[d++]=1;u[d++]=1}}return i};t.generateNormals=function(t,e,i,r){var n=t.get(t.count);var a=e.get(e.count);if(i==null)i=new s.Float3Attributes(r);var o=t.dimensions;var l=i.stride;var h=i.get(i.count);var p;var u=i.count*l;for(p=0;p<u;p+=l){h[p]=0;h[p+1]=0;h[p+2]=0}u=t.count*o;var c;var f=0;var d=1;var _=2;for(p=0;p<u;p+=o){c=n[p]*l;h[c]+=a[f];h[c+1]+=a[d];h[c+2]+=a[_];c=n[p+1]*l;h[c]+=a[f];h[c+1]+=a[d];h[c+2]+=a[_];c=n[p+2]*l;h[c]+=a[f];h[c+1]+=a[d];h[c+2]+=a[_];f+=4;d+=4;_+=4}u=i.count*l;var y;var v;var m;var b;for(p=0;p<u;p+=l){y=h[p];v=h[p+1];m=h[p+2];b=1/Math.sqrt(y*y+v*v+m*m);h[p]=y*b;h[p+1]=v*b;h[p+2]=m*b}return i};t.generateFaceTangents=function(t,e,i,r,s,a,o){if(a===void 0){a=0}if(o===void 0){o=false}var l=t.get(s,a);var h=e.get(e.count);var p=i.get(i.count);if(r==null)r=new n.Float4Attributes(s+a);else if(r.count<s+a)r.count=s+a;var u=t.dimensions;var c=e.dimensions;var f=e.stride;var d=i.stride;var _=r.get(s,a);var y=0;var v;var m;var b;var g;var w;var P;var x;var j;var E;var T,A,C;var D,O,S;var M,I,B;var N,L,R;var F=s*u;for(y=0;y<F;y+=u){v=l[y];m=l[y+1];b=l[y+2];g=p[v*d+1];x=p[m*d+1]-g;j=p[b*d+1]-g;g=v*f;w=m*f;P=b*f;T=h[g];D=h[w]-T;M=h[P]-T;N=j*D-x*M;A=h[g+1];O=h[w+1]-A;I=h[P+1]-A;L=j*O-x*I;if(c==3){C=h[g+2];S=h[w+2]-C;B=h[P+2]-C;R=j*S-x*B}else{R=0}E=1/Math.sqrt(N*N+L*L+R*R);_[y]=E*N;_[y+1]=E*L;_[y+2]=E*R}return r};t.generateTangents=function(t,e,i,r,n){var a=t.get(t.count);var o=e.get(e.count);var l=i.get(i.count);if(r==null)r=new s.Float3Attributes(n);var h=t.dimensions;var p=r.stride;var u=r.get(r.count);var c;var f=r.count*p;for(c=0;c<f;c+=p){u[c]=0;u[c+1]=0;u[c+2]=0}var d;var _;var y=0;var v=1;var m=2;var b=3;f=t.count*h;for(c=0;c<f;c+=h){d=l[b];_=a[c]*p;u[_++]+=o[y]*d;u[_++]+=o[v]*d;u[_]+=o[m]*d;_=a[c+1]*p;u[_++]+=o[y]*d;u[_++]+=o[v]*d;u[_]+=o[m]*d;_=a[c+2]*p;u[_++]+=o[y]*d;u[_++]+=o[v]*d;u[_]+=o[m]*d;y+=3;v+=3;m+=3;b+=4}var g;var w;var P;var x;for(c=0;c<f;c+=p){g=u[c];w=u[c+1];P=u[c+2];x=1/Math.sqrt(g*g+w*w+P*P);u[c]=g*x;u[c+1]=w*x;u[c+2]=P*x}return r};t.generateColors=function(t,e,i,r,s){if(s===void 0){s=0}if(e==null)e=new a.Byte4Attributes(i);if(e.count<r+s)e.count=r+s;var n=e.get(r,s);var o=e.stride;var l=e.count*o;for(var h=0;h<l;h+=o){n[h]=255;n[h+1]=255;n[h+2]=255;n[h+3]=255}return e};t.scale=function(t,e,i,r,s,n){if(n===void 0){n=0}if(r.count<s+n)r.count=s+n;var a=new Float32Array([t,e,i]);var o=r.get(s,n);var l=r.stride;var h=r.dimensions;var p;var u;var c=s*l;for(p=0;p<c;p+=l)for(u=0;u<h;u++)o[p+u]*=a[u];r.invalidate()};t.applyTransformation=function(t,e,i,r,s,n){if(n===void 0){n=0}var a=e.get(s,n);var l=e.stride;var h;var p;if(i){h=i.get(s,n);p=i.stride}var u;var c;if(r){u=r.get(s,n);c=r.stride}var f;var d;var _;var y=new o.Vector3D;var v;if(i||r){v=t.clone();v.invert();v.transpose()}var m=0;var b=0;var g=0;for(f=0;f<s;++f){d=m+1;_=m+2;y.x=a[m];y.y=a[d];y.z=a[_];y=t.transformVector(y);a[m]=y.x;a[d]=y.y;a[_]=y.z;m+=l;if(h){d=b+1;_=b+2;y.x=h[b];y.y=h[d];y.z=h[_];y=v.deltaTransformVector(y);y.normalize();h[b]=y.x;h[d]=y.y;h[_]=y.z;b+=p}if(u){d=g+1;_=g+2;y.x=u[g];y.y=u[d];y.z=u[_];y=v.deltaTransformVector(y);y.normalize();u[g]=y.x;u[d]=y.y;u[_]=y.z;g+=c}}e.invalidate();if(i)i.invalidate();if(r)r.invalidate()};t.getSubIndices=function(e,i,s,n){if(n===void 0){n=0}var a=e.attributesBuffer;var o=e.length;s.length=0;if(o<t.LIMIT_INDICES&&i<t.LIMIT_VERTS)return a;var l;var h=e.get(e.count,n);var p=new Array;var u=t._indexSwap;u.length=o;for(l=0;l<o;l++)u[l]=-1;var c;var f;var d=0;var _=n*e.dimensions;l=0;while(l<o+_&&l+1<t.LIMIT_INDICES&&d+1<t.LIMIT_VERTS){c=h[l];if(u[c]>=0){f=u[c]}else{f=d++;u[c]=f;s[f]=c}p[l++]=f}a=new r.AttributesBuffer(e.size*e.dimensions,p.length/e.dimensions);e=e.clone(a);e.set(p);return a};t.getSubVertices=function(t,e){if(!e.length)return t;var i=t.stride;var s=t.bufferView;var n=new Uint8Array(e.length*i);var a;var o;var l=0;var h=0;var p=e.length;for(l=0;l<p;l++){a=l*i;o=e[l]*i;for(h=0;h<i;h++)n[a+h]=s[o+h]}t=new r.AttributesBuffer(i,p);t.bufferView=n;return t};t.hitTestTriangleElements=function(t,e,i,r,s,n,a){if(a===void 0){a=0}var o=s.positions;var l=s.getCustomAtributes("curves");var h=o.stride;var u=l.stride;var c=o.get(n,a);var f=l?l.get(n,a):null;var d;var _;var y;var v;var m;var b;var g;var w;var P;var x=s.hitTestCache[a]||(s.hitTestCache[a]=new p.HitTestCache);var j=-1;if(j!=-1&&j<n){t:{d=j+2;_=j+1;y=j+0;v=c[d*h];m=c[d*h+1];b=c[_*h];g=c[_*h+1];w=c[y*h];P=c[y*h+1];var E=v-t;var T=m-e;var A=g-m;var C=-(b-v);var D=E*A+T*C;if(D>0)break t;E=b-t;T=g-e;A=P-g;C=-(w-b);D=E*A+T*C;if(D>0)break t;E=w-t;T=P-e;A=m-P;C=-(v-w);D=E*A+T*C;if(D>0)break t;if(f){var O=f[d*u+2];var S=f[_*u+2];var M=f[y*u+2];if(O||S||M){var I=b-v;var B=g-m;var N=w-v;var L=P-m;var R=t-v;var F=e-m;var k=I*L-N*B;var V=(R*L-N*F)/k;var U=(I*F-R*B)/k;var G=.5*V+U;var H=U;var W=G*G-H;var z=f[d*u];if(W>0&&z==-128){break t}else if(W<0&&z==127){break t}}}return true}}if(n>150){var q=x.cells;var X=q.length?x.divisions:x.divisions=Math.min(Math.ceil(Math.sqrt(n)),32);var Y=X/r.width;var Z=X/r.height;var J=r.x;var K=r.y;if(!q.length){q.length=X*X;for(var Q=0;Q<n;Q+=3){d=Q+2;_=Q+1;y=Q+0;v=c[d*h];m=c[d*h+1];b=c[_*h];g=c[_*h+1];w=c[y*h];P=c[y*h+1];var $=Math.floor((Math.min(v,b,w)-J)*Y);var tt=Math.floor((Math.min(m,g,P)-K)*Z);var et=Math.floor((Math.max(v,b,w)-J)*Y);var it=Math.floor((Math.max(m,g,P)-K)*Z);for(var rt=$;rt<=et;rt++){for(var st=tt;st<=it;st++){var j=rt+st*X;var nt=q[j]||(q[j]=new Array);nt.push(d,_,y)}}}}var at=Math.floor((t-J)*Y);var ot=Math.floor((e-K)*Z);if(at<0||at>X||ot<0||ot>X)return false;var nt=q[at+ot*X];if(nt==null)return false;var lt=nt.length;for(var Q=0;Q<lt;Q+=3){y=nt[Q+2];if(y==j)continue;_=nt[Q+1];d=nt[Q];v=c[d*h];m=c[d*h+1];b=c[_*h];g=c[_*h+1];w=c[y*h];P=c[y*h+1];var E=v-t;var T=m-e;var A=g-m;var C=-(b-v);var D=E*A+T*C;if(D>0)continue;E=b-t;T=g-e;A=P-g;C=-(w-b);D=E*A+T*C;if(D>0)continue;E=w-t;T=P-e;A=m-P;C=-(v-w);D=E*A+T*C;if(D>0)continue;if(f){var O=f[d*u+2];var S=f[_*u+2];var M=f[y*u+2];if(O||S||M){var I=b-v;var B=g-m;var N=w-v;var L=P-m;var R=t-v;var F=e-m;var k=I*L-N*B;var V=(R*L-N*F)/k;var U=(I*F-R*B)/k;var G=.5*V+U;var H=U;var W=G*G-H;var z=f[d*u];if(W>0&&z==-128)continue;else if(W<0&&z==127)continue}}x.lastCollisionIndex=y;return true}return false}for(var Q=0;Q<n;Q+=3){y=Q+0;if(y==j)continue;_=Q+1;d=Q+2;v=c[d*h];m=c[d*h+1];b=c[_*h];g=c[_*h+1];w=c[y*h];P=c[y*h+1];var E=v-t;var T=m-e;var A=g-m;var C=-(b-v);var D=E*A+T*C;if(D>0)continue;E=b-t;T=g-e;A=P-g;C=-(w-b);D=E*A+T*C;if(D>0)continue;E=w-t;T=P-e;A=m-P;C=-(v-w);D=E*A+T*C;if(D>0)continue;if(f){var O=f[d*u+2];var S=f[_*u+2];var M=f[y*u+2];if(O||S||M){var I=b-v;var B=g-m;var N=w-v;var L=P-m;var R=t-v;var F=e-m;var k=I*L-N*B;var V=(R*L-N*F)/k;var U=(I*F-R*B)/k;var G=.5*V+U;var H=U;var W=G*G-H;var z=f[d*u];if(W>0&&z==-128){continue}else if(W<0&&z==127){continue}}}x.lastCollisionIndex=y;return true}return false};t.getTriangleGraphicsBoxBounds=function(t,e,i,r){if(r===void 0){r=0}var s=t.get(i,r);var n=t.dimensions;var a=t.stride;var o;var h=0,p=0,u=0;var c=0,f=0,d=0;var _=i*a;for(var y=0;y<_;y+=a){if(y==0){c=h=s[y];f=p=s[y+1];d=u=n==3?s[y+2]:0}else{o=s[y];if(o<h)h=o;else if(o>c)c=o;o=s[y+1];if(o<p)p=o;else if(o>f)f=o;if(n==3){o=s[y+2];if(o<u)u=o;else if(o>d)d=o}}}if(e==null)e=new l.Box;e.x=h;e.y=p;e.z=u;e.right=c;e.bottom=f;e.back=d;return e};t.getTriangleGraphicsSphereBounds=function(t,e,i,r,s){if(s===void 0){s=0}var n=t.get(r,s);var a=t.dimensions;var o=t.stride;var l=0;var p;var u=r*o;var c;var f;var d;for(var _=0;_<u;_+=o){c=n[_]-e.x;f=n[_+1]-e.y;d=a==3?n[_+2]-e.z:-e.z;p=c*c+f*f+d*d;if(l<p)l=p}if(i==null)i=new h.Sphere;i.x=e.x;i.y=e.y;i.z=e.z;i.radius=Math.sqrt(l);return i};t.tempFloat32x4=new Float32Array(4);t.LIMIT_VERTS=65535;t.LIMIT_INDICES=16777215;t._indexSwap=new Array;return t}();i.ElementsUtils=u},{"../graphics/HitTestCache":"awayjs-display/lib/graphics/HitTestCache","awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/attributes/Byte4Attributes":undefined,"awayjs-core/lib/attributes/Float3Attributes":undefined,"awayjs-core/lib/attributes/Float4Attributes":undefined,"awayjs-core/lib/geom/Box":undefined,"awayjs-core/lib/geom/Sphere":undefined,"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-display/lib/utils":[function(t,e,i){"use strict";var r=t("./utils/Cast");i.Cast=r.Cast;var s=t("./utils/ElementsUtils");i.ElementsUtils=s.ElementsUtils},{"./utils/Cast":"awayjs-display/lib/utils/Cast","./utils/ElementsUtils":"awayjs-display/lib/utils/ElementsUtils"}]},{},[1]);
//# sourceMappingURL=awayjs-display.min.js.map
